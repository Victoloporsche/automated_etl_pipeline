[0m21:06:34.416975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103efc910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d5a140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d5a800>]}


============================== 21:06:34.419742 | 36d19dae-f054-48e8-9c91-889a32680047 ==============================
[0m21:06:34.419742 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:06:34.420165 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/victoruwaje/.dbt', 'log_path': 'logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:06:34.420510 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m21:06:34.445892 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.07687084, "process_in_blocks": "0", "process_kernel_time": 0.120876, "process_mem_max_rss": "98992128", "process_out_blocks": "0", "process_user_time": 0.701846}
[0m21:06:34.446457 [debug] [MainThread]: Command `dbt run` failed at 21:06:34.446381 after 0.08 seconds
[0m21:06:34.446766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103efc910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d597b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d59f90>]}
[0m21:06:34.447035 [debug] [MainThread]: Flushing usage events
[0m21:06:34.951375 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:40:47.359675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10732c9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108182260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108182920>]}


============================== 21:40:47.362564 | a8817197-7a7e-491b-8d41-5114b5c95216 ==============================
[0m21:40:47.362564 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:40:47.363013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:40:47.363367 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m21:40:47.364838 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.05069125, "process_in_blocks": "0", "process_kernel_time": 0.114675, "process_mem_max_rss": "98648064", "process_out_blocks": "0", "process_user_time": 0.645281}
[0m21:40:47.365104 [debug] [MainThread]: Command `dbt run` failed at 21:40:47.365055 after 0.05 seconds
[0m21:40:47.365308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10732c9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081818d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081820b0>]}
[0m21:40:47.365486 [debug] [MainThread]: Flushing usage events
[0m21:40:47.838952 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:41:31.997096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10561c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064721a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106472860>]}


============================== 21:41:32.000644 | 05bf197c-e56e-42ec-97ac-4ce0173bb042 ==============================
[0m21:41:32.000644 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:41:32.001106 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'fail_fast': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:41:32.001484 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m21:41:32.002986 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.049679585, "process_in_blocks": "0", "process_kernel_time": 0.112075, "process_mem_max_rss": "99057664", "process_out_blocks": "0", "process_user_time": 0.640338}
[0m21:41:32.003257 [debug] [MainThread]: Command `dbt run` failed at 21:41:32.003203 after 0.05 seconds
[0m21:41:32.003474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10561c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106471810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064719c0>]}
[0m21:41:32.003668 [debug] [MainThread]: Flushing usage events
[0m21:41:32.502045 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:43:29.732916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d009a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b51d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b516c0>]}


============================== 21:43:29.735938 | 78c3b6b5-2d3b-499d-9242-562af171c229 ==============================
[0m21:43:29.735938 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:43:29.736304 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:43:29.738353 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'intermate_bigquery'
[0m21:43:29.739751 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.049442414, "process_in_blocks": "0", "process_kernel_time": 0.110055, "process_mem_max_rss": "97648640", "process_out_blocks": "0", "process_user_time": 0.640824}
[0m21:43:29.740022 [debug] [MainThread]: Command `dbt run` failed at 21:43:29.739970 after 0.05 seconds
[0m21:43:29.740226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d009a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b51b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b50eb0>]}
[0m21:43:29.740434 [debug] [MainThread]: Flushing usage events
[0m21:43:30.267884 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:47:38.677283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104880970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106295e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106295750>]}


============================== 21:47:38.680398 | 74540cd7-a726-427c-b2ce-31388de73efd ==============================
[0m21:47:38.680398 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:47:38.680746 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:47:41.769303 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['sources']: [{'name': 'raw', 'description': 'Raw data loaded from Google Cloud Storage', 'tables': [{'name': 'clean_shopify_orders', 'description': 'Shopify orders data, cleaned and loaded into BigQuery'}, {'name': 'clean_facebook_ads', 'description': 'Facebook Ads insights, cleaned and loaded into BigQuery'}]}] is not of type 'object'

Error encountered in /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/dbt_project.yml
[0m21:47:41.771703 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.1355815, "process_in_blocks": "0", "process_kernel_time": 1.19617, "process_mem_max_rss": "183418880", "process_out_blocks": "0", "process_user_time": 2.026986}
[0m21:47:41.772023 [debug] [MainThread]: Command `dbt run` failed at 21:47:41.771969 after 3.14 seconds
[0m21:47:41.772241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104880970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142ba94b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142c0e440>]}
[0m21:47:41.772450 [debug] [MainThread]: Flushing usage events
[0m21:47:42.294262 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:52:25.209217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105be48e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a35e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a357b0>]}


============================== 21:52:25.212887 | a274184a-4bee-4e31-aa4c-905b39322c2f ==============================
[0m21:52:25.212887 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:52:25.213224 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/victoruwaje/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:52:26.093112 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('incremental_strategy', 'unique_key' were unexpected)

Error encountered in /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/dbt_project.yml
[0m21:52:26.100841 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.93451285, "process_in_blocks": "0", "process_kernel_time": 0.932617, "process_mem_max_rss": "195493888", "process_out_blocks": "0", "process_user_time": 2.020712}
[0m21:52:26.101196 [debug] [MainThread]: Command `dbt run` failed at 21:52:26.101141 after 0.93 seconds
[0m21:52:26.101406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105be48e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10698bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f0cbd00>]}
[0m21:52:26.101623 [debug] [MainThread]: Flushing usage events
[0m21:52:26.634161 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:59:57.217318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dac8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bfde70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bfd7b0>]}


============================== 21:59:57.220731 | 67398aca-e26f-4841-a3b3-33d17a8f749e ==============================
[0m21:59:57.220731 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:59:57.221112 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'profiles_dir': '/Users/victoruwaje/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:59:58.105614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67398aca-e26f-4841-a3b3-33d17a8f749e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212cb040>]}
[0m21:59:58.133762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67398aca-e26f-4841-a3b3-33d17a8f749e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086c5540>]}
[0m21:59:58.134155 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:59:58.243131 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m21:59:58.243646 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:59:58.243860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '67398aca-e26f-4841-a3b3-33d17a8f749e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b53ac0>]}
[0m21:59:58.830802 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.fact_tables
- models.intermatedbt.marts
- models.intermatedbt.staging
[0m21:59:58.837243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67398aca-e26f-4841-a3b3-33d17a8f749e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121a2dcf0>]}
[0m21:59:58.879887 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m21:59:58.881127 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m21:59:58.892298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67398aca-e26f-4841-a3b3-33d17a8f749e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121a2c9d0>]}
[0m21:59:58.892608 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m21:59:58.892790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67398aca-e26f-4841-a3b3-33d17a8f749e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121a2c250>]}
[0m21:59:58.893722 [info ] [MainThread]: 
[0m21:59:58.893917 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:59:58.894069 [info ] [MainThread]: 
[0m21:59:58.894333 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:59:58.896645 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m21:59:58.896879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:59:59.465682 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m21:59:59.467238 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:59:59.867293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67398aca-e26f-4841-a3b3-33d17a8f749e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bfe6e0>]}
[0m21:59:59.869656 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:59:59.875718 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m21:59:59.876636 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m21:59:59.877365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m21:59:59.877933 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m21:59:59.891577 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m21:59:59.893112 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m21:59:59.922639 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m21:59:59.923765 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    date_start::DATE AS ad_date,
    impressions,
    clicks,
    amount_spent AS ad_spend_usd,
    amount_spent * 0.85 AS ad_spend_eur -- Convert to EUR
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`
WHERE amount_spent IS NOT NULL;


[0m21:59:59.924129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:00:00.482546 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:76753777-6d71-4dcf-9c72-163d7af6d9f6&page=queryresults
[0m22:00:00.484463 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:76753777-6d71-4dcf-9c72-163d7af6d9f6&page=queryresults
[0m22:00:00.494056 [debug] [Thread-1 (]: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Syntax error: Expected end of input but got ":" at [10:15]
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m22:00:00.497509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67398aca-e26f-4841-a3b3-33d17a8f749e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b62830>]}
[0m22:00:00.498590 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model order_ad_data.stg_facebook_ads ............ [[31mERROR[0m in 0.62s]
[0m22:00:00.499405 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m22:00:00.499890 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m22:00:00.500564 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_facebook_ads' to be skipped because of status 'error'.  Reason: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Syntax error: Expected end of input but got ":" at [10:15]
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql.
[0m22:00:00.501164 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m22:00:00.502672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m22:00:00.503198 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m22:00:00.508125 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m22:00:00.509253 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m22:00:00.512563 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m22:00:00.513353 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    created_at::DATE AS order_date,
    total_price AS total_amount_usd,
    total_price * 0.85 AS total_amount_eur, -- Convert USD to EUR
    discount_code
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`
WHERE order_status = 'completed';


[0m22:00:00.513809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:00:00.846644 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:cbcbf654-3dda-4410-889d-e9be58f5b9f5&page=queryresults
[0m22:00:00.848059 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:cbcbf654-3dda-4410-889d-e9be58f5b9f5&page=queryresults
[0m22:00:00.851339 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Syntax error: Expected end of input but got ":" at [11:15]
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m22:00:00.852783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67398aca-e26f-4841-a3b3-33d17a8f749e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c8d720>]}
[0m22:00:00.853824 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 0.35s]
[0m22:00:00.854578 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m22:00:00.855170 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Syntax error: Expected end of input but got ":" at [11:15]
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m22:00:00.856371 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m22:00:00.857081 [info ] [Thread-1 (]: 3 of 6 SKIP relation order_ad_data.fact_new_customer_orders .................... [[33mSKIP[0m]
[0m22:00:00.857770 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m22:00:00.858690 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m22:00:00.859458 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m22:00:00.860052 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m22:00:00.860697 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m22:00:00.861262 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m22:00:00.861797 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m22:00:00.862260 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m22:00:00.862773 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m22:00:00.863278 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m22:00:00.864350 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:00:00.865082 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:00:00.865448 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m22:00:00.865930 [info ] [MainThread]: 
[0m22:00:00.866430 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 1.97 seconds (1.97s).
[0m22:00:00.867617 [debug] [MainThread]: Command end result
[0m22:00:00.901807 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m22:00:00.903824 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m22:00:00.910010 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m22:00:00.910524 [info ] [MainThread]: 
[0m22:00:00.910880 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m22:00:00.911153 [info ] [MainThread]: 
[0m22:00:00.911465 [error] [MainThread]:   Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Syntax error: Expected end of input but got ":" at [10:15]
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m22:00:00.911706 [info ] [MainThread]: 
[0m22:00:00.911988 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Syntax error: Expected end of input but got ":" at [11:15]
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m22:00:00.912319 [info ] [MainThread]: 
[0m22:00:00.912624 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=4 TOTAL=6
[0m22:00:00.915575 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.7409396, "process_in_blocks": "0", "process_kernel_time": 0.878382, "process_mem_max_rss": "216383488", "process_out_blocks": "0", "process_user_time": 3.170694}
[0m22:00:00.916308 [debug] [MainThread]: Command `dbt run` failed at 22:00:00.916197 after 3.74 seconds
[0m22:00:00.916640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dac8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212cb040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e618a0>]}
[0m22:00:00.916940 [debug] [MainThread]: Flushing usage events
[0m22:00:01.394794 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:01:33.910089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f848e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dd5e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dd57b0>]}


============================== 22:01:33.912869 | 8e972e09-f9ba-4782-823f-e49a6a8c6f36 ==============================
[0m22:01:33.912869 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:01:33.913213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:01:34.881517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e972e09-f9ba-4782-823f-e49a6a8c6f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128a3e2f0>]}
[0m22:01:34.910037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e972e09-f9ba-4782-823f-e49a6a8c6f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040258a0>]}
[0m22:01:34.910421 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:01:35.031643 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:01:35.109664 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:01:35.110040 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_shopify_orders.sql
[0m22:01:35.110260 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_facebook_ads.sql
[0m22:01:35.233654 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.marts
- models.intermatedbt.staging
- models.intermatedbt.fact_tables
[0m22:01:35.241090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e972e09-f9ba-4782-823f-e49a6a8c6f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1291d5240>]}
[0m22:01:35.282938 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m22:01:35.284230 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m22:01:35.295942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e972e09-f9ba-4782-823f-e49a6a8c6f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1291c0b80>]}
[0m22:01:35.296290 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m22:01:35.296486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e972e09-f9ba-4782-823f-e49a6a8c6f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1291c08e0>]}
[0m22:01:35.297421 [info ] [MainThread]: 
[0m22:01:35.297625 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:01:35.297781 [info ] [MainThread]: 
[0m22:01:35.298057 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:01:35.300489 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m22:01:35.300738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:01:35.800635 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m22:01:35.802225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:01:36.142053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e972e09-f9ba-4782-823f-e49a6a8c6f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128b06b90>]}
[0m22:01:36.143686 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:01:36.149219 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m22:01:36.150256 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m22:01:36.151205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m22:01:36.151800 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m22:01:36.165641 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m22:01:36.166786 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m22:01:36.195932 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m22:01:36.196719 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    amount_spent AS ad_spend_usd,
    amount_spent * 0.85 AS ad_spend_eur -- Convert to EUR
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`
WHERE amount_spent IS NOT NULL;


[0m22:01:36.197143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:01:36.694610 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:91f7da9b-80bc-47e5-9928-69f7d873c6de&page=queryresults
[0m22:01:36.695803 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:91f7da9b-80bc-47e5-9928-69f7d873c6de&page=queryresults
[0m22:01:36.705913 [debug] [Thread-1 (]: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_facebook_ads was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m22:01:36.709399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e972e09-f9ba-4782-823f-e49a6a8c6f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d3a830>]}
[0m22:01:36.710505 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model order_ad_data.stg_facebook_ads ............ [[31mERROR[0m in 0.56s]
[0m22:01:36.711449 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m22:01:36.712054 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m22:01:36.712781 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_facebook_ads' to be skipped because of status 'error'.  Reason: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_facebook_ads was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql.
[0m22:01:36.713438 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m22:01:36.716753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m22:01:36.717245 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m22:01:36.721695 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m22:01:36.722649 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m22:01:36.725988 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m22:01:36.726719 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(created_at AS DATE) AS order_date,  -- ✅ Corrected type casting
    total_price AS total_amount_usd,
    total_price * 0.85 AS total_amount_eur, -- Convert USD to EUR
    discount_code
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`
WHERE order_status = 'completed';


[0m22:01:36.727172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:01:37.156067 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:6422d1fb-025e-4bc1-add4-07c135601d96&page=queryresults
[0m22:01:37.157549 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:6422d1fb-025e-4bc1-add4-07c135601d96&page=queryresults
[0m22:01:37.160520 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_shopify_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m22:01:37.161854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e972e09-f9ba-4782-823f-e49a6a8c6f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129350340>]}
[0m22:01:37.163299 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 0.44s]
[0m22:01:37.164602 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m22:01:37.165698 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_shopify_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m22:01:37.166970 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m22:01:37.167595 [info ] [Thread-1 (]: 3 of 6 SKIP relation order_ad_data.fact_new_customer_orders .................... [[33mSKIP[0m]
[0m22:01:37.168255 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m22:01:37.169142 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m22:01:37.169794 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m22:01:37.170445 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m22:01:37.170997 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m22:01:37.171626 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m22:01:37.172246 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m22:01:37.172804 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m22:01:37.173433 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m22:01:37.174043 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m22:01:37.175335 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:01:37.176069 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:01:37.176463 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m22:01:37.176970 [info ] [MainThread]: 
[0m22:01:37.177387 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 1.88 seconds (1.88s).
[0m22:01:37.178467 [debug] [MainThread]: Command end result
[0m22:01:37.206536 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m22:01:37.208085 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m22:01:37.213806 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m22:01:37.214138 [info ] [MainThread]: 
[0m22:01:37.214459 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m22:01:37.214722 [info ] [MainThread]: 
[0m22:01:37.215027 [error] [MainThread]:   Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_facebook_ads was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m22:01:37.215300 [info ] [MainThread]: 
[0m22:01:37.215593 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_shopify_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m22:01:37.215846 [info ] [MainThread]: 
[0m22:01:37.216096 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=4 TOTAL=6
[0m22:01:37.218538 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.3486872, "process_in_blocks": "0", "process_kernel_time": 0.762411, "process_mem_max_rss": "210354176", "process_out_blocks": "0", "process_user_time": 2.35664}
[0m22:01:37.218910 [debug] [MainThread]: Command `dbt run` failed at 22:01:37.218845 after 3.35 seconds
[0m22:01:37.219221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f848e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040258a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129376020>]}
[0m22:01:37.219501 [debug] [MainThread]: Flushing usage events
[0m22:01:37.699675 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:02:21.268022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104980910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106595e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106595780>]}


============================== 22:02:21.270871 | 403ce16e-20b6-4da0-a7de-bc9c899ec05f ==============================
[0m22:02:21.270871 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:02:21.271199 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:02:22.199788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '403ce16e-20b6-4da0-a7de-bc9c899ec05f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137a08eb0>]}
[0m22:02:22.228147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '403ce16e-20b6-4da0-a7de-bc9c899ec05f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106022950>]}
[0m22:02:22.228547 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:02:22.336484 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:02:22.410666 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:02:22.411037 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_shopify_orders.sql
[0m22:02:22.411250 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_facebook_ads.sql
[0m22:02:22.503267 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.intermate_dbt.stg_shopify_orders' (models/staging/stg_shopify_orders.sql) depends on a source named 'order_ad_data.clean_shopify_orders' which was not found
[0m22:02:22.505481 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2781693, "process_in_blocks": "0", "process_kernel_time": 0.833641, "process_mem_max_rss": "208060416", "process_out_blocks": "0", "process_user_time": 2.480067}
[0m22:02:22.505752 [debug] [MainThread]: Command `dbt run` failed at 22:02:22.505702 after 1.28 seconds
[0m22:02:22.505974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104980910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137f50b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c08d930>]}
[0m22:02:22.506195 [debug] [MainThread]: Flushing usage events
[0m22:02:22.936526 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:03:01.930465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108060970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eb1e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eb1750>]}


============================== 22:03:01.933276 | 355cfaa9-326b-4b88-8a35-2a546e32a314 ==============================
[0m22:03:01.933276 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:03:01.933616 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:03:02.852651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '355cfaa9-326b-4b88-8a35-2a546e32a314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13600a7d0>]}
[0m22:03:02.881292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '355cfaa9-326b-4b88-8a35-2a546e32a314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e86fb0>]}
[0m22:03:02.881698 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:03:02.989399 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:03:03.065242 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:03:03.065500 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:03:03.068817 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.staging
- models.intermatedbt.marts
- models.intermatedbt.fact_tables
[0m22:03:03.086628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '355cfaa9-326b-4b88-8a35-2a546e32a314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1366654b0>]}
[0m22:03:03.130585 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m22:03:03.131946 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m22:03:03.142856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '355cfaa9-326b-4b88-8a35-2a546e32a314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13667a680>]}
[0m22:03:03.143154 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m22:03:03.143330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '355cfaa9-326b-4b88-8a35-2a546e32a314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136667220>]}
[0m22:03:03.144210 [info ] [MainThread]: 
[0m22:03:03.144399 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:03:03.144550 [info ] [MainThread]: 
[0m22:03:03.144810 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:03:03.147286 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m22:03:03.147522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:03.658087 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m22:03:03.659620 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:03:04.199047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '355cfaa9-326b-4b88-8a35-2a546e32a314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e84700>]}
[0m22:03:04.201817 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:03:04.207983 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m22:03:04.208985 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m22:03:04.209745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m22:03:04.210304 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m22:03:04.226150 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m22:03:04.227164 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m22:03:04.255500 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m22:03:04.256309 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    amount_spent AS ad_spend_usd,
    amount_spent * 0.85 AS ad_spend_eur -- Convert to EUR
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`
WHERE amount_spent IS NOT NULL;


[0m22:03:04.256677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:03:04.907711 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:3120aa8a-f5e5-4ef8-a67b-30cd11c897f0&page=queryresults
[0m22:03:04.909835 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:3120aa8a-f5e5-4ef8-a67b-30cd11c897f0&page=queryresults
[0m22:03:04.919977 [debug] [Thread-1 (]: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_facebook_ads was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m22:03:04.923207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '355cfaa9-326b-4b88-8a35-2a546e32a314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136612ef0>]}
[0m22:03:04.924271 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model order_ad_data.stg_facebook_ads ............ [[31mERROR[0m in 0.71s]
[0m22:03:04.925046 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m22:03:04.925515 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m22:03:04.926118 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_facebook_ads' to be skipped because of status 'error'.  Reason: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_facebook_ads was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql.
[0m22:03:04.926781 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m22:03:04.930280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m22:03:04.930826 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m22:03:04.935268 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m22:03:04.936326 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m22:03:04.939436 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m22:03:04.940200 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(created_at AS DATE) AS order_date,  -- ✅ Corrected type casting
    total_price AS total_amount_usd,
    total_price * 0.85 AS total_amount_eur, -- Convert USD to EUR
    discount_code
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`
WHERE order_status = 'completed';


[0m22:03:04.940664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:03:05.363747 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:9fbd2bcc-e17e-474e-ba29-6182dc13add8&page=queryresults
[0m22:03:05.366156 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:9fbd2bcc-e17e-474e-ba29-6182dc13add8&page=queryresults
[0m22:03:05.370977 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_shopify_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m22:03:05.371890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '355cfaa9-326b-4b88-8a35-2a546e32a314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1365eb490>]}
[0m22:03:05.372842 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 0.44s]
[0m22:03:05.373702 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m22:03:05.374406 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_shopify_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m22:03:05.375520 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m22:03:05.376236 [info ] [Thread-1 (]: 3 of 6 SKIP relation order_ad_data.fact_new_customer_orders .................... [[33mSKIP[0m]
[0m22:03:05.376851 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m22:03:05.377796 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m22:03:05.378434 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m22:03:05.379017 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m22:03:05.379535 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m22:03:05.380172 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m22:03:05.380822 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m22:03:05.381370 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m22:03:05.381999 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m22:03:05.382586 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m22:03:05.383639 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:03:05.384336 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:03:05.384693 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m22:03:05.385162 [info ] [MainThread]: 
[0m22:03:05.385548 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 2.24 seconds (2.24s).
[0m22:03:05.386615 [debug] [MainThread]: Command end result
[0m22:03:05.414595 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m22:03:05.416142 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m22:03:05.421913 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m22:03:05.422209 [info ] [MainThread]: 
[0m22:03:05.422483 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m22:03:05.422717 [info ] [MainThread]: 
[0m22:03:05.422988 [error] [MainThread]:   Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_facebook_ads was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m22:03:05.423211 [info ] [MainThread]: 
[0m22:03:05.423457 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_shopify_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m22:03:05.423665 [info ] [MainThread]: 
[0m22:03:05.423885 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=4 TOTAL=6
[0m22:03:05.426316 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.5392501, "process_in_blocks": "0", "process_kernel_time": 1.115262, "process_mem_max_rss": "210239488", "process_out_blocks": "0", "process_user_time": 2.416346}
[0m22:03:05.426683 [debug] [MainThread]: Command `dbt run` failed at 22:03:05.426621 after 3.54 seconds
[0m22:03:05.427075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108060970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13663b460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1367c1480>]}
[0m22:03:05.427382 [debug] [MainThread]: Flushing usage events
[0m22:03:05.901972 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:04:15.282807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104180940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106395e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106395750>]}


============================== 22:04:15.285868 | 7d1e21a0-8fb8-4660-bb15-7b684c67e2df ==============================
[0m22:04:15.285868 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:04:15.286248 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'profiles_dir': '/Users/victoruwaje/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:04:16.197982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d1e21a0-8fb8-4660-bb15-7b684c67e2df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b70a470>]}
[0m22:04:16.226289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d1e21a0-8fb8-4660-bb15-7b684c67e2df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105423760>]}
[0m22:04:16.226680 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:04:16.334292 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:04:16.409644 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:04:16.410028 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_shopify_orders.sql
[0m22:04:16.410250 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_facebook_ads.sql
[0m22:04:16.502905 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.intermate_dbt.stg_shopify_orders' (models/staging/stg_shopify_orders.sql) depends on a source named 'order-and-adds.clean_shopify_orders' which was not found
[0m22:04:16.504917 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.26291, "process_in_blocks": "0", "process_kernel_time": 0.881157, "process_mem_max_rss": "207880192", "process_out_blocks": "0", "process_user_time": 2.416861}
[0m22:04:16.505183 [debug] [MainThread]: Command `dbt run` failed at 22:04:16.505134 after 1.26 seconds
[0m22:04:16.505401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104180940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14bc50bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14bd8d960>]}
[0m22:04:16.505621 [debug] [MainThread]: Flushing usage events
[0m22:04:16.947555 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:04:44.243093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104334880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106395f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106395840>]}


============================== 22:04:44.246471 | d31c0772-39ec-48c5-8146-a8c4f4877991 ==============================
[0m22:04:44.246471 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:04:44.246830 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:04:45.340439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd31c0772-39ec-48c5-8146-a8c4f4877991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a73c490>]}
[0m22:04:45.371654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd31c0772-39ec-48c5-8146-a8c4f4877991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043bb4c0>]}
[0m22:04:45.372149 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:04:45.491587 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:04:45.563857 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:04:45.564251 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_shopify_orders.sql
[0m22:04:45.564466 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_facebook_ads.sql
[0m22:04:45.657627 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.intermate_dbt.stg_shopify_orders' (models/staging/stg_shopify_orders.sql) depends on a source named 'order-and-adds.raw/clean_shopify_orders' which was not found
[0m22:04:45.659883 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4544504, "process_in_blocks": "0", "process_kernel_time": 0.695435, "process_mem_max_rss": "198344704", "process_out_blocks": "0", "process_user_time": 2.197634}
[0m22:04:45.660137 [debug] [MainThread]: Command `dbt run` failed at 22:04:45.660086 after 1.45 seconds
[0m22:04:45.660355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104334880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ad50a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ae8c0a0>]}
[0m22:04:45.660561 [debug] [MainThread]: Flushing usage events
[0m22:04:46.145985 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:05:48.673728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e80940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cd1e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cd1750>]}


============================== 22:05:48.677028 | 77365505-88f0-41fa-ad3f-46afdeea29ad ==============================
[0m22:05:48.677028 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:05:48.677387 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:49.563435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77365505-88f0-41fa-ad3f-46afdeea29ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13df0a1a0>]}
[0m22:05:49.591352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77365505-88f0-41fa-ad3f-46afdeea29ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b06fb0>]}
[0m22:05:49.591722 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:05:49.700599 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:05:49.774855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m22:05:49.775421 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/sources.yml
[0m22:05:49.775610 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_shopify_orders.sql
[0m22:05:49.775775 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_facebook_ads.sql
[0m22:05:49.924838 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.intermate_dbt.stg_shopify_orders' (models/staging/stg_shopify_orders.sql) depends on a source named 'order-and-adds.raw/clean_shopify_orders' which was not found
[0m22:05:49.927887 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2958162, "process_in_blocks": "0", "process_kernel_time": 1.177368, "process_mem_max_rss": "210567168", "process_out_blocks": "0", "process_user_time": 2.228692}
[0m22:05:49.928142 [debug] [MainThread]: Command `dbt run` failed at 22:05:49.928091 after 1.30 seconds
[0m22:05:49.928356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e80940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fe4fd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148013a00>]}
[0m22:05:49.928559 [debug] [MainThread]: Flushing usage events
[0m22:05:50.433783 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:06:12.065076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fb08e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e01e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e017b0>]}


============================== 22:06:12.068031 | 7d270029-66a1-4f7c-aef7-37b74fe5e3f9 ==============================
[0m22:06:12.068031 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:06:12.068383 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:12.933356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d270029-66a1-4f7c-aef7-37b74fe5e3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124309d50>]}
[0m22:06:12.961201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d270029-66a1-4f7c-aef7-37b74fe5e3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f8bb0>]}
[0m22:06:12.961593 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:06:13.072392 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:06:13.144184 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m22:06:13.144741 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/sources.yml
[0m22:06:13.144932 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_shopify_orders.sql
[0m22:06:13.145095 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_facebook_ads.sql
[0m22:06:13.296671 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.intermate_dbt.stg_shopify_orders' (models/staging/stg_shopify_orders.sql) depends on a source named 'raw.raw/clean_shopify_orders' which was not found
[0m22:06:13.299750 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2725067, "process_in_blocks": "0", "process_kernel_time": 1.012357, "process_mem_max_rss": "211992576", "process_out_blocks": "0", "process_user_time": 2.320814}
[0m22:06:13.300025 [debug] [MainThread]: Command `dbt run` failed at 22:06:13.299972 after 1.27 seconds
[0m22:06:13.300246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fb08e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fd9c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124992aa0>]}
[0m22:06:13.300450 [debug] [MainThread]: Flushing usage events
[0m22:06:13.803148 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:06:29.017917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058b88e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106709ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067097e0>]}


============================== 22:06:29.020992 | 9ace16b8-5319-4e8e-a342-2b45d202f3e1 ==============================
[0m22:06:29.020992 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:06:29.021335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/victoruwaje/.dbt', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:29.890135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ace16b8-5319-4e8e-a342-2b45d202f3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12723e2f0>]}
[0m22:06:29.918136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ace16b8-5319-4e8e-a342-2b45d202f3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059598a0>]}
[0m22:06:29.918518 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:06:30.034969 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:06:30.117807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:06:30.121537 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/sources.yml
[0m22:06:30.302076 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.staging
- models.intermatedbt.fact_tables
- models.intermatedbt.marts
[0m22:06:30.308896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ace16b8-5319-4e8e-a342-2b45d202f3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127c96ef0>]}
[0m22:06:30.350853 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m22:06:30.352325 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m22:06:30.363231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ace16b8-5319-4e8e-a342-2b45d202f3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127fded10>]}
[0m22:06:30.363531 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m22:06:30.363713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ace16b8-5319-4e8e-a342-2b45d202f3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127fdca60>]}
[0m22:06:30.364635 [info ] [MainThread]: 
[0m22:06:30.364832 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:06:30.364986 [info ] [MainThread]: 
[0m22:06:30.365253 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:06:30.367565 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m22:06:30.367794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:30.943148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m22:06:30.944573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:31.352710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ace16b8-5319-4e8e-a342-2b45d202f3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046a26e0>]}
[0m22:06:31.354454 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:31.359282 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m22:06:31.360271 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m22:06:31.361014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m22:06:31.361580 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m22:06:31.374554 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m22:06:31.376012 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m22:06:31.405626 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m22:06:31.406492 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    amount_spent AS ad_spend_usd,
    amount_spent * 0.85 AS ad_spend_eur -- Convert to EUR
FROM `atomic-sled-453015-g3`.`order-and-adds`.`clean_facebook_ads`
WHERE amount_spent IS NOT NULL;


[0m22:06:31.406879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:32.175136 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:ce4a38df-a1b8-4217-8495-239667f7ce8f&page=queryresults
[0m22:06:32.177335 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:ce4a38df-a1b8-4217-8495-239667f7ce8f&page=queryresults
[0m22:06:32.187969 [debug] [Thread-1 (]: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Not found: Dataset atomic-sled-453015-g3:order-and-adds was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m22:06:32.191432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ace16b8-5319-4e8e-a342-2b45d202f3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10566e830>]}
[0m22:06:32.192310 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model order_ad_data.stg_facebook_ads ............ [[31mERROR[0m in 0.83s]
[0m22:06:32.193149 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m22:06:32.193830 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m22:06:32.194523 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_facebook_ads' to be skipped because of status 'error'.  Reason: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Not found: Dataset atomic-sled-453015-g3:order-and-adds was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql.
[0m22:06:32.195197 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m22:06:32.196619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m22:06:32.197090 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m22:06:32.201778 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m22:06:32.202795 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m22:06:32.205945 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m22:06:32.206894 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(created_at AS DATE) AS order_date,  -- ✅ Corrected type casting
    total_price AS total_amount_usd,
    total_price * 0.85 AS total_amount_eur, -- Convert USD to EUR
    discount_code
FROM `atomic-sled-453015-g3`.`order-and-adds`.`clean_shopify_orders`
WHERE order_status = 'completed';


[0m22:06:32.207363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:32.784551 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:1bb3e290-7bfe-4607-ab6c-c1eaa666ba95&page=queryresults
[0m22:06:32.786345 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:1bb3e290-7bfe-4607-ab6c-c1eaa666ba95&page=queryresults
[0m22:06:32.790089 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Not found: Dataset atomic-sled-453015-g3:order-and-adds was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m22:06:32.791584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ace16b8-5319-4e8e-a342-2b45d202f3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133228850>]}
[0m22:06:32.792962 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 0.59s]
[0m22:06:32.794097 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m22:06:32.794856 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Not found: Dataset atomic-sled-453015-g3:order-and-adds was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m22:06:32.795981 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m22:06:32.796740 [info ] [Thread-1 (]: 3 of 6 SKIP relation order_ad_data.fact_new_customer_orders .................... [[33mSKIP[0m]
[0m22:06:32.797502 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m22:06:32.798440 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m22:06:32.799138 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m22:06:32.799806 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m22:06:32.800576 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m22:06:32.801254 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m22:06:32.801882 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m22:06:32.802441 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m22:06:32.803355 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m22:06:32.804055 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m22:06:32.805182 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:32.805918 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:32.806291 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m22:06:32.806780 [info ] [MainThread]: 
[0m22:06:32.807192 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 2.44 seconds (2.44s).
[0m22:06:32.808275 [debug] [MainThread]: Command end result
[0m22:06:32.836399 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m22:06:32.838042 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m22:06:32.843328 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m22:06:32.843612 [info ] [MainThread]: 
[0m22:06:32.843888 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m22:06:32.844113 [info ] [MainThread]: 
[0m22:06:32.844457 [error] [MainThread]:   Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Not found: Dataset atomic-sled-453015-g3:order-and-adds was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m22:06:32.844704 [info ] [MainThread]: 
[0m22:06:32.844970 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Not found: Dataset atomic-sled-453015-g3:order-and-adds was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m22:06:32.845193 [info ] [MainThread]: 
[0m22:06:32.845426 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=4 TOTAL=6
[0m22:06:32.848168 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.8696225, "process_in_blocks": "0", "process_kernel_time": 0.978861, "process_mem_max_rss": "211435520", "process_out_blocks": "0", "process_user_time": 2.748506}
[0m22:06:32.848673 [debug] [MainThread]: Command `dbt run` failed at 22:06:32.848600 after 3.87 seconds
[0m22:06:32.848993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058b88e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059598a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13314a9e0>]}
[0m22:06:32.849292 [debug] [MainThread]: Flushing usage events
[0m22:06:33.272721 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:10:01.313347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106380970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b95e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b95750>]}


============================== 22:10:01.316478 | 4b393da7-3040-44d0-9134-8dc95bd30f2d ==============================
[0m22:10:01.316478 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:10:01.316844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:10:02.269120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b393da7-3040-44d0-9134-8dc95bd30f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fc0b190>]}
[0m22:10:02.297546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b393da7-3040-44d0-9134-8dc95bd30f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b6afb0>]}
[0m22:10:02.297944 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:10:02.407402 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:10:02.482442 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m22:10:02.483008 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/sources.yml
[0m22:10:02.483212 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_shopify_orders.sql
[0m22:10:02.483380 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_facebook_ads.sql
[0m22:10:02.660745 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.marts
- models.intermatedbt.fact_tables
- models.intermatedbt.staging
[0m22:10:02.667155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b393da7-3040-44d0-9134-8dc95bd30f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1462afca0>]}
[0m22:10:02.708645 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m22:10:02.709891 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m22:10:02.720844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b393da7-3040-44d0-9134-8dc95bd30f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1464bfd30>]}
[0m22:10:02.721161 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m22:10:02.721344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b393da7-3040-44d0-9134-8dc95bd30f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1464bdc00>]}
[0m22:10:02.722245 [info ] [MainThread]: 
[0m22:10:02.722453 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:10:02.722613 [info ] [MainThread]: 
[0m22:10:02.722916 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:10:02.725673 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m22:10:02.725980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:10:03.327099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m22:10:03.328590 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:10:03.734438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b393da7-3040-44d0-9134-8dc95bd30f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b68700>]}
[0m22:10:03.736115 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:10:03.740840 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m22:10:03.741742 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m22:10:03.742454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m22:10:03.743020 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m22:10:03.756598 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m22:10:03.757783 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m22:10:03.786629 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m22:10:03.787444 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    amount_spent AS ad_spend_usd,
    amount_spent * 0.85 AS ad_spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE amount_spent IS NOT NULL;


[0m22:10:03.787825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:04.346352 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:6eb09ef2-20b2-4c1c-952e-1da6d57f2606&page=queryresults
[0m22:10:04.348130 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:6eb09ef2-20b2-4c1c-952e-1da6d57f2606&page=queryresults
[0m22:10:04.357769 [debug] [Thread-1 (]: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_facebook_ads was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m22:10:04.361299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b393da7-3040-44d0-9134-8dc95bd30f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f4b040>]}
[0m22:10:04.362394 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model order_ad_data.stg_facebook_ads ............ [[31mERROR[0m in 0.62s]
[0m22:10:04.363295 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m22:10:04.363844 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m22:10:04.364469 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_facebook_ads' to be skipped because of status 'error'.  Reason: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_facebook_ads was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql.
[0m22:10:04.365116 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m22:10:04.366601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m22:10:04.367165 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m22:10:04.371918 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m22:10:04.373280 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m22:10:04.376698 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m22:10:04.377823 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(created_at AS DATE) AS order_date,
    total_price AS total_amount_usd,
    total_price * 0.85 AS total_amount_eur,
    discount_code
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE order_status = 'completed';


[0m22:10:04.378337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:04.859127 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:6d1305d6-2dec-410b-9b53-bc8e7d7c724b&page=queryresults
[0m22:10:04.860977 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:6d1305d6-2dec-410b-9b53-bc8e7d7c724b&page=queryresults
[0m22:10:04.864250 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_shopify_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m22:10:04.865719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b393da7-3040-44d0-9134-8dc95bd30f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146824af0>]}
[0m22:10:04.867134 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 0.50s]
[0m22:10:04.868000 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m22:10:04.868698 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_shopify_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m22:10:04.869768 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m22:10:04.870482 [info ] [Thread-1 (]: 3 of 6 SKIP relation order_ad_data.fact_new_customer_orders .................... [[33mSKIP[0m]
[0m22:10:04.871181 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m22:10:04.872085 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m22:10:04.872716 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m22:10:04.873318 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m22:10:04.873861 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m22:10:04.874532 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m22:10:04.875139 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m22:10:04.875668 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m22:10:04.876296 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m22:10:04.876887 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m22:10:04.877983 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:04.878682 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:04.879035 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m22:10:04.879511 [info ] [MainThread]: 
[0m22:10:04.879902 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 2.16 seconds (2.16s).
[0m22:10:04.880985 [debug] [MainThread]: Command end result
[0m22:10:04.909398 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m22:10:04.910923 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m22:10:04.916297 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m22:10:04.916594 [info ] [MainThread]: 
[0m22:10:04.916902 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m22:10:04.917157 [info ] [MainThread]: 
[0m22:10:04.917465 [error] [MainThread]:   Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_facebook_ads was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m22:10:04.917721 [info ] [MainThread]: 
[0m22:10:04.918011 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_shopify_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m22:10:04.918230 [info ] [MainThread]: 
[0m22:10:04.918465 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=4 TOTAL=6
[0m22:10:04.920942 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.6482844, "process_in_blocks": "0", "process_kernel_time": 1.052235, "process_mem_max_rss": "212893696", "process_out_blocks": "0", "process_user_time": 2.728911}
[0m22:10:04.921277 [debug] [MainThread]: Command `dbt run` failed at 22:10:04.921221 after 3.65 seconds
[0m22:10:04.921563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106380970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f9240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146732140>]}
[0m22:10:04.921830 [debug] [MainThread]: Flushing usage events
[0m22:10:05.410818 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:12:20.452749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107980940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c95e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c95750>]}


============================== 22:12:20.456009 | 573c8ec0-ffcc-43b9-ad5c-ac996cc3200f ==============================
[0m22:12:20.456009 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:12:20.456388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:12:21.386388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '573c8ec0-ffcc-43b9-ad5c-ac996cc3200f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146e0a980>]}
[0m22:12:21.414450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '573c8ec0-ffcc-43b9-ad5c-ac996cc3200f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e23760>]}
[0m22:12:21.414875 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:12:21.527074 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:12:21.610878 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:12:21.611265 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_shopify_orders.sql
[0m22:12:21.611479 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_facebook_ads.sql
[0m22:12:21.705034 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.intermate_dbt.stg_shopify_orders' (models/staging/stg_shopify_orders.sql) depends on a source named 'orders-and-ads/raw.clean_shopify_orders' which was not found
[0m22:12:21.708216 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2954204, "process_in_blocks": "0", "process_kernel_time": 1.05805, "process_mem_max_rss": "203948032", "process_out_blocks": "0", "process_user_time": 2.372222}
[0m22:12:21.708547 [debug] [MainThread]: Command `dbt run` failed at 22:12:21.708488 after 1.30 seconds
[0m22:12:21.708797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107980940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147450c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147591a50>]}
[0m22:12:21.709021 [debug] [MainThread]: Flushing usage events
[0m22:12:22.200677 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:19:17.350065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10606c8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ebdea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ebd7e0>]}


============================== 22:19:17.353425 | 981cab58-ca46-457d-8b23-bd709fdf2e76 ==============================
[0m22:19:17.353425 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:19:17.353778 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:19:18.237915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '981cab58-ca46-457d-8b23-bd709fdf2e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129e3f010>]}
[0m22:19:18.266150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '981cab58-ca46-457d-8b23-bd709fdf2e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106984f10>]}
[0m22:19:18.266538 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:19:18.375210 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:19:18.453258 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m22:19:18.453848 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/sources.yml
[0m22:19:18.454040 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_facebook_ads.sql
[0m22:19:18.454206 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_shopify_orders.sql
[0m22:19:18.602396 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.intermate_dbt.stg_shopify_orders' (models/staging/stg_shopify_orders.sql) depends on a source named 'orders_and_ads.clean_shopify_orders' which was not found
[0m22:19:18.605175 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2979367, "process_in_blocks": "0", "process_kernel_time": 0.911741, "process_mem_max_rss": "210534400", "process_out_blocks": "0", "process_user_time": 2.464}
[0m22:19:18.605439 [debug] [MainThread]: Command `dbt run` failed at 22:19:18.605387 after 1.30 seconds
[0m22:19:18.605663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10606c8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a5ea8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a607730>]}
[0m22:19:18.605864 [debug] [MainThread]: Flushing usage events
[0m22:19:19.091832 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:24:59.299925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105850910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a1e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a1780>]}


============================== 22:24:59.303936 | 6c270891-d3c8-472a-8685-fccb6e31da99 ==============================
[0m22:24:59.303936 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:24:59.304328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/victoruwaje/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:25:00.218416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c270891-d3c8-472a-8685-fccb6e31da99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a20aa70>]}
[0m22:25:00.247004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c270891-d3c8-472a-8685-fccb6e31da99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061d7340>]}
[0m22:25:00.247458 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:25:00.361771 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:25:00.449451 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m22:25:00.450094 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/sources.yml
[0m22:25:00.450293 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_shopify_orders.sql
[0m22:25:00.450461 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_facebook_ads.sql
[0m22:25:00.599175 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.intermate_dbt.stg_shopify_orders' (models/staging/stg_shopify_orders.sql) depends on a source named 'orders_and_ads.clean_shopify_orders' which was not found
[0m22:25:00.602165 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3426857, "process_in_blocks": "0", "process_kernel_time": 1.102231, "process_mem_max_rss": "209813504", "process_out_blocks": "0", "process_user_time": 2.371461}
[0m22:25:00.602413 [debug] [MainThread]: Command `dbt run` failed at 22:25:00.602365 after 1.34 seconds
[0m22:25:00.602624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105850910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b04fd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a46f790>]}
[0m22:25:00.602829 [debug] [MainThread]: Flushing usage events
[0m22:25:01.067740 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:28:46.799901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110080940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e95e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e95750>]}


============================== 22:28:46.805360 | c97450f5-4a03-4540-9eca-17395f09afd0 ==============================
[0m22:28:46.805360 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:28:46.805922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:28:47.713903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c97450f5-4a03-4540-9eca-17395f09afd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147109900>]}
[0m22:28:47.742535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c97450f5-4a03-4540-9eca-17395f09afd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110923760>]}
[0m22:28:47.742928 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:28:47.857648 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:28:47.933059 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m22:28:47.933662 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/sources.yml
[0m22:28:47.933863 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_shopify_orders.sql
[0m22:28:47.934041 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_facebook_ads.sql
[0m22:28:48.086084 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.intermate_dbt.stg_facebook_ads' (models/staging/stg_facebook_ads.sql) depends on a source named 'orders_and_ads.clean_facebook_ads' which was not found
[0m22:28:48.088099 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4472457, "process_in_blocks": "0", "process_kernel_time": 1.093466, "process_mem_max_rss": "206290944", "process_out_blocks": "0", "process_user_time": 2.423085}
[0m22:28:48.088381 [debug] [MainThread]: Command `dbt run` failed at 22:28:48.088323 after 1.45 seconds
[0m22:28:48.088619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110080940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14774fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147911450>]}
[0m22:28:48.088827 [debug] [MainThread]: Flushing usage events
[0m22:28:48.583619 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:29:45.114170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d80910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122695e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122695780>]}


============================== 22:29:45.119083 | fc7c7222-8c03-4463-964e-7ef39a8e5217 ==============================
[0m22:29:45.119083 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:29:45.119460 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:29:46.057943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc7c7222-8c03-4463-964e-7ef39a8e5217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079fd990>]}
[0m22:29:46.087321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc7c7222-8c03-4463-964e-7ef39a8e5217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1479a9150>]}
[0m22:29:46.087763 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:29:46.200176 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:29:46.275855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m22:29:46.276521 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/sources.yml
[0m22:29:46.276751 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_facebook_ads.sql
[0m22:29:46.276943 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_shopify_orders.sql
[0m22:29:46.430059 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.intermate_dbt.stg_shopify_orders' (models/staging/stg_shopify_orders.sql) depends on a source named 'orders_and_ads.clean_shopify_orders' which was not found
[0m22:29:46.432343 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3604366, "process_in_blocks": "0", "process_kernel_time": 0.849421, "process_mem_max_rss": "209944576", "process_out_blocks": "0", "process_user_time": 2.500418}
[0m22:29:46.432644 [debug] [MainThread]: Command `dbt run` failed at 22:29:46.432590 after 1.36 seconds
[0m22:29:46.432866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d80910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15373f430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15373de70>]}
[0m22:29:46.433067 [debug] [MainThread]: Flushing usage events
[0m22:29:46.876147 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:30:18.052613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ffc910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e4dea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e4d7e0>]}


============================== 22:30:18.056708 | 662cfea1-1c28-4afe-b51c-4ec04ae108f6 ==============================
[0m22:30:18.056708 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:30:18.057046 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:30:18.939446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '662cfea1-1c28-4afe-b51c-4ec04ae108f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e40ba30>]}
[0m22:30:18.969079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '662cfea1-1c28-4afe-b51c-4ec04ae108f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c829b0>]}
[0m22:30:18.969532 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:30:19.081185 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:30:19.157583 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m22:30:19.158163 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/sources.yml
[0m22:30:19.158363 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_shopify_orders.sql
[0m22:30:19.158541 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_facebook_ads.sql
[0m22:30:19.310208 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.intermate_dbt.stg_facebook_ads' (models/staging/stg_facebook_ads.sql) depends on a source named 'orders-and-ads.clean_facebook_ads' which was not found
[0m22:30:19.314163 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3035275, "process_in_blocks": "0", "process_kernel_time": 1.354082, "process_mem_max_rss": "211402752", "process_out_blocks": "0", "process_user_time": 2.129396}
[0m22:30:19.314469 [debug] [MainThread]: Command `dbt run` failed at 22:30:19.314411 after 1.30 seconds
[0m22:30:19.314732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ffc910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e94fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eb10a60>]}
[0m22:30:19.314976 [debug] [MainThread]: Flushing usage events
[0m22:30:19.785870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:34:38.118235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103478910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042c9e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042c9780>]}


============================== 22:34:38.122363 | 32a5e194-5828-4ac9-a718-f73ff0a8d8b1 ==============================
[0m22:34:38.122363 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:34:38.122761 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:34:39.031640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32a5e194-5828-4ac9-a718-f73ff0a8d8b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034ef970>]}
[0m22:34:39.060526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32a5e194-5828-4ac9-a718-f73ff0a8d8b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dff340>]}
[0m22:34:39.060959 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:34:39.173398 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:34:39.251299 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m22:34:39.251893 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/sources.yml
[0m22:34:39.252090 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_shopify_orders.sql
[0m22:34:39.252273 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_facebook_ads.sql
[0m22:34:39.403052 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.intermate_dbt.stg_facebook_ads' (models/staging/stg_facebook_ads.sql) depends on a source named 'orders-and-ads.clean_facebook_ads' which was not found
[0m22:34:39.405236 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3350303, "process_in_blocks": "0", "process_kernel_time": 1.100725, "process_mem_max_rss": "206798848", "process_out_blocks": "0", "process_user_time": 2.312019}
[0m22:34:39.405516 [debug] [MainThread]: Command `dbt run` failed at 22:34:39.405466 after 1.34 seconds
[0m22:34:39.405741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103478910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12145df90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12145e020>]}
[0m22:34:39.405945 [debug] [MainThread]: Flushing usage events
[0m22:34:39.884087 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:39:06.295480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b88b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107005ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070057e0>]}


============================== 22:39:06.299658 | 743410fa-922e-48d7-9010-503099b45a1e ==============================
[0m22:39:06.299658 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:39:06.300024 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:39:07.262817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '743410fa-922e-48d7-9010-503099b45a1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13823f3d0>]}
[0m22:39:07.291030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '743410fa-922e-48d7-9010-503099b45a1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1380f2ec0>]}
[0m22:39:07.291449 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:39:07.398589 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:39:07.473408 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m22:39:07.473977 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/sources.yml
[0m22:39:07.474172 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_shopify_orders.sql
[0m22:39:07.474339 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_facebook_ads.sql
[0m22:39:07.652386 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.marts
- models.intermatedbt.staging
- models.intermatedbt.fact_tables
[0m22:39:07.659189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '743410fa-922e-48d7-9010-503099b45a1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139dc0820>]}
[0m22:39:07.700466 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m22:39:07.701886 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m22:39:07.714573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '743410fa-922e-48d7-9010-503099b45a1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139dc8af0>]}
[0m22:39:07.715232 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m22:39:07.715421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '743410fa-922e-48d7-9010-503099b45a1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139dca200>]}
[0m22:39:07.716394 [info ] [MainThread]: 
[0m22:39:07.716594 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:39:07.716748 [info ] [MainThread]: 
[0m22:39:07.717022 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:39:07.719378 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m22:39:07.719611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:39:08.457924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m22:39:08.459524 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:39:08.789724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '743410fa-922e-48d7-9010-503099b45a1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105216d70>]}
[0m22:39:08.790876 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:39:08.795641 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m22:39:08.796684 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m22:39:08.797460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m22:39:08.798036 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m22:39:08.811630 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m22:39:08.812886 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m22:39:08.842801 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m22:39:08.843874 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    amount_spent AS ad_spend_usd,
    amount_spent * 0.85 AS ad_spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`raw.clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE amount_spent IS NOT NULL;


[0m22:39:08.844262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:39:09.286913 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:a9b3703b-e267-4b51-a1fb-9881ccffaf0e&page=queryresults
[0m22:39:09.288710 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:a9b3703b-e267-4b51-a1fb-9881ccffaf0e&page=queryresults
[0m22:39:09.298973 [debug] [Thread-1 (]: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m22:39:09.302468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '743410fa-922e-48d7-9010-503099b45a1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f6ae90>]}
[0m22:39:09.303538 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model order_ad_data.stg_facebook_ads ............ [[31mERROR[0m in 0.50s]
[0m22:39:09.304309 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m22:39:09.304828 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m22:39:09.305452 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_facebook_ads' to be skipped because of status 'error'.  Reason: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql.
[0m22:39:09.306124 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m22:39:09.307760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m22:39:09.308227 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m22:39:09.312710 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m22:39:09.313706 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m22:39:09.316975 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m22:39:09.317915 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(created_at AS DATE) AS order_date,
    total_price AS total_amount_usd,
    total_price * 0.85 AS total_amount_eur,
    discount_code
FROM `atomic-sled-453015-g3`.`order_ad_data`.`raw.clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE order_status = 'completed';


[0m22:39:09.318372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:39:09.598770 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:b09176fb-3581-4705-b9d3-e64aeb039959&page=queryresults
[0m22:39:09.600229 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:b09176fb-3581-4705-b9d3-e64aeb039959&page=queryresults
[0m22:39:09.603145 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m22:39:09.604469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '743410fa-922e-48d7-9010-503099b45a1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ea28df0>]}
[0m22:39:09.605893 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 0.30s]
[0m22:39:09.606838 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m22:39:09.607567 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m22:39:09.608485 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m22:39:09.609204 [info ] [Thread-1 (]: 3 of 6 SKIP relation order_ad_data.fact_new_customer_orders .................... [[33mSKIP[0m]
[0m22:39:09.609982 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m22:39:09.610942 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m22:39:09.611581 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m22:39:09.612179 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m22:39:09.612700 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m22:39:09.613330 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m22:39:09.613977 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m22:39:09.614531 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m22:39:09.615150 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m22:39:09.615760 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m22:39:09.616869 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:39:09.617559 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:39:09.617910 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m22:39:09.618380 [info ] [MainThread]: 
[0m22:39:09.618766 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 1.90 seconds (1.90s).
[0m22:39:09.619851 [debug] [MainThread]: Command end result
[0m22:39:09.648350 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m22:39:09.650057 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m22:39:09.655385 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m22:39:09.655675 [info ] [MainThread]: 
[0m22:39:09.655995 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m22:39:09.656249 [info ] [MainThread]: 
[0m22:39:09.656563 [error] [MainThread]:   Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m22:39:09.656826 [info ] [MainThread]: 
[0m22:39:09.657106 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m22:39:09.657347 [info ] [MainThread]: 
[0m22:39:09.657589 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=4 TOTAL=6
[0m22:39:09.659887 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.4067445, "process_in_blocks": "0", "process_kernel_time": 0.87774, "process_mem_max_rss": "210337792", "process_out_blocks": "0", "process_user_time": 2.5623}
[0m22:39:09.660244 [debug] [MainThread]: Command `dbt run` failed at 22:39:09.660183 after 3.41 seconds
[0m22:39:09.660538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b88b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13823f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fbeb490>]}
[0m22:39:09.660817 [debug] [MainThread]: Flushing usage events
[0m22:39:10.136295 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:42:03.323257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b08880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10495e110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10495e7d0>]}


============================== 22:42:03.326644 | 4b1e0374-a9a5-4b33-a735-dbfc523dfeda ==============================
[0m22:42:03.326644 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:42:03.326990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:42:04.258574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b1e0374-a9a5-4b33-a735-dbfc523dfeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12823e2f0>]}
[0m22:42:04.287310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b1e0374-a9a5-4b33-a735-dbfc523dfeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1282b9b10>]}
[0m22:42:04.287731 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:42:04.398889 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:42:04.474816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:42:04.475211 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/sources.yml
[0m22:42:04.522159 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.marts
- models.intermatedbt.staging
- models.intermatedbt.fact_tables
[0m22:42:04.529903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b1e0374-a9a5-4b33-a735-dbfc523dfeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1285615d0>]}
[0m22:42:04.572915 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m22:42:04.574075 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m22:42:04.585212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b1e0374-a9a5-4b33-a735-dbfc523dfeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128e91de0>]}
[0m22:42:04.585586 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m22:42:04.585784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b1e0374-a9a5-4b33-a735-dbfc523dfeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128e93d90>]}
[0m22:42:04.586827 [info ] [MainThread]: 
[0m22:42:04.587041 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:42:04.587197 [info ] [MainThread]: 
[0m22:42:04.587474 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:42:04.589906 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m22:42:04.590140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:42:05.140010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m22:42:05.141226 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:42:05.507073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b1e0374-a9a5-4b33-a735-dbfc523dfeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104928640>]}
[0m22:42:05.508974 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:42:05.514616 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m22:42:05.515825 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m22:42:05.516595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m22:42:05.517176 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m22:42:05.530767 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m22:42:05.532347 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m22:42:05.562640 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m22:42:05.563659 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    amount_spent AS ad_spend_usd,
    amount_spent * 0.85 AS ad_spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`raw.clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE amount_spent IS NOT NULL;


[0m22:42:05.564074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:06.018687 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:b27fc892-3609-4497-a589-3f2264a2753f&page=queryresults
[0m22:42:06.020429 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:b27fc892-3609-4497-a589-3f2264a2753f&page=queryresults
[0m22:42:06.029728 [debug] [Thread-1 (]: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m22:42:06.033017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b1e0374-a9a5-4b33-a735-dbfc523dfeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038b80d0>]}
[0m22:42:06.034082 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model order_ad_data.stg_facebook_ads ............ [[31mERROR[0m in 0.51s]
[0m22:42:06.034956 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m22:42:06.035431 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m22:42:06.036048 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_facebook_ads' to be skipped because of status 'error'.  Reason: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql.
[0m22:42:06.036735 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m22:42:06.038538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m22:42:06.039039 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m22:42:06.043314 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m22:42:06.044412 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m22:42:06.047849 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m22:42:06.048729 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(created_at AS DATE) AS order_date,
    total_price AS total_amount_usd,
    total_price * 0.85 AS total_amount_eur,
    discount_code
FROM `atomic-sled-453015-g3`.`order_ad_data`.`raw.clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE order_status = 'completed';


[0m22:42:06.049202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:06.528382 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:1c147ea6-127c-40ff-afc7-cad08e1e640e&page=queryresults
[0m22:42:06.529476 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:1c147ea6-127c-40ff-afc7-cad08e1e640e&page=queryresults
[0m22:42:06.533415 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m22:42:06.534839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b1e0374-a9a5-4b33-a735-dbfc523dfeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cd3b070>]}
[0m22:42:06.536261 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 0.50s]
[0m22:42:06.537556 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m22:42:06.538343 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m22:42:06.539438 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m22:42:06.540156 [info ] [Thread-1 (]: 3 of 6 SKIP relation order_ad_data.fact_new_customer_orders .................... [[33mSKIP[0m]
[0m22:42:06.540849 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m22:42:06.541742 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m22:42:06.542458 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m22:42:06.543070 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m22:42:06.543615 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m22:42:06.544283 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m22:42:06.544966 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m22:42:06.545558 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m22:42:06.546246 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m22:42:06.546880 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m22:42:06.548220 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:42:06.549026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:42:06.549424 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m22:42:06.549948 [info ] [MainThread]: 
[0m22:42:06.550604 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 1.96 seconds (1.96s).
[0m22:42:06.551806 [debug] [MainThread]: Command end result
[0m22:42:06.580083 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m22:42:06.581670 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m22:42:06.587132 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m22:42:06.587429 [info ] [MainThread]: 
[0m22:42:06.587757 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m22:42:06.588013 [info ] [MainThread]: 
[0m22:42:06.588336 [error] [MainThread]:   Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m22:42:06.588600 [info ] [MainThread]: 
[0m22:42:06.588861 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m22:42:06.589085 [info ] [MainThread]: 
[0m22:42:06.589306 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=4 TOTAL=6
[0m22:42:06.591728 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.3094418, "process_in_blocks": "0", "process_kernel_time": 1.118815, "process_mem_max_rss": "205832192", "process_out_blocks": "0", "process_user_time": 2.408611}
[0m22:42:06.592294 [debug] [MainThread]: Command `dbt run` failed at 22:42:06.592190 after 3.31 seconds
[0m22:42:06.592621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b08880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035ec550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12836fe80>]}
[0m22:42:06.592953 [debug] [MainThread]: Flushing usage events
[0m22:42:07.070094 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:43:46.211980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd88e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e95e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e957b0>]}


============================== 22:43:46.217898 | 055017a6-cd1c-48ee-9378-86a39c6a9cc3 ==============================
[0m22:43:46.217898 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:43:46.218447 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:43:47.156484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '055017a6-cd1c-48ee-9378-86a39c6a9cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14500b610>]}
[0m22:43:47.185267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '055017a6-cd1c-48ee-9378-86a39c6a9cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ccba30>]}
[0m22:43:47.185693 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:43:47.297946 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:43:47.373856 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:43:47.374262 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/sources.yml
[0m22:43:47.420518 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.staging
- models.intermatedbt.marts
- models.intermatedbt.fact_tables
[0m22:43:47.428239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '055017a6-cd1c-48ee-9378-86a39c6a9cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145461870>]}
[0m22:43:47.471159 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m22:43:47.472543 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m22:43:47.483420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '055017a6-cd1c-48ee-9378-86a39c6a9cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145693100>]}
[0m22:43:47.483720 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m22:43:47.483908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '055017a6-cd1c-48ee-9378-86a39c6a9cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145692b30>]}
[0m22:43:47.484850 [info ] [MainThread]: 
[0m22:43:47.485057 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:43:47.485211 [info ] [MainThread]: 
[0m22:43:47.485485 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:43:47.488069 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m22:43:47.488329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:47.972234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m22:43:47.973414 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:43:48.326947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '055017a6-cd1c-48ee-9378-86a39c6a9cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e68640>]}
[0m22:43:48.327897 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:43:48.332245 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m22:43:48.333305 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m22:43:48.333980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m22:43:48.334431 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m22:43:48.346784 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m22:43:48.347886 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m22:43:48.376561 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m22:43:48.377640 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    amount_spent AS ad_spend_usd,
    amount_spent * 0.85 AS ad_spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`raw.clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE amount_spent IS NOT NULL;


[0m22:43:48.378003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:48.885037 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:10080f7b-b922-4f56-9cc2-50bc4eb99633&page=queryresults
[0m22:43:48.886241 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:10080f7b-b922-4f56-9cc2-50bc4eb99633&page=queryresults
[0m22:43:48.895343 [debug] [Thread-1 (]: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m22:43:48.898525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '055017a6-cd1c-48ee-9378-86a39c6a9cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a8e830>]}
[0m22:43:48.899888 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model order_ad_data.stg_facebook_ads ............ [[31mERROR[0m in 0.56s]
[0m22:43:48.900700 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m22:43:48.901200 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m22:43:48.901801 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_facebook_ads' to be skipped because of status 'error'.  Reason: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql.
[0m22:43:48.902738 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m22:43:48.904502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m22:43:48.904965 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m22:43:48.909137 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m22:43:48.910374 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m22:43:48.913435 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m22:43:48.914290 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(created_at AS DATE) AS order_date,
    total_price AS total_amount_usd,
    total_price * 0.85 AS total_amount_eur,
    discount_code
FROM `atomic-sled-453015-g3`.`order_ad_data`.`raw.clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE order_status = 'completed';


[0m22:43:48.914746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:49.466202 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:0b17fa9d-ec6e-49ca-b32d-daf6b1158752&page=queryresults
[0m22:43:49.468178 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:0b17fa9d-ec6e-49ca-b32d-daf6b1158752&page=queryresults
[0m22:43:49.471247 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m22:43:49.472504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '055017a6-cd1c-48ee-9378-86a39c6a9cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1458e7070>]}
[0m22:43:49.473876 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 0.57s]
[0m22:43:49.474821 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m22:43:49.475579 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m22:43:49.476942 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m22:43:49.477694 [info ] [Thread-1 (]: 3 of 6 SKIP relation order_ad_data.fact_new_customer_orders .................... [[33mSKIP[0m]
[0m22:43:49.478437 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m22:43:49.479397 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m22:43:49.480042 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m22:43:49.480668 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m22:43:49.481242 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m22:43:49.481843 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m22:43:49.482421 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m22:43:49.482962 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m22:43:49.483560 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m22:43:49.484029 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m22:43:49.485306 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:43:49.486044 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:43:49.486403 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m22:43:49.487047 [info ] [MainThread]: 
[0m22:43:49.488036 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 2.00 seconds (2.00s).
[0m22:43:49.489303 [debug] [MainThread]: Command end result
[0m22:43:49.516498 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m22:43:49.518299 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m22:43:49.524302 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m22:43:49.524663 [info ] [MainThread]: 
[0m22:43:49.524990 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m22:43:49.525249 [info ] [MainThread]: 
[0m22:43:49.525534 [error] [MainThread]:   Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m22:43:49.525770 [info ] [MainThread]: 
[0m22:43:49.526455 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m22:43:49.526755 [info ] [MainThread]: 
[0m22:43:49.527038 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=4 TOTAL=6
[0m22:43:49.529755 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.3675454, "process_in_blocks": "0", "process_kernel_time": 1.357635, "process_mem_max_rss": "208355328", "process_out_blocks": "0", "process_user_time": 2.249743}
[0m22:43:49.530194 [debug] [MainThread]: Command `dbt run` failed at 22:43:49.530127 after 3.37 seconds
[0m22:43:49.530507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd88e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ccba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1458f7010>]}
[0m22:43:49.530810 [debug] [MainThread]: Flushing usage events
[0m22:43:50.026554 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:46:21.391657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104098970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ee9e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ee9750>]}


============================== 22:46:21.395999 | bb6a99c6-f666-49b4-aa59-5feef8cb6aec ==============================
[0m22:46:21.395999 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:46:21.396387 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'profiles_dir': '/Users/victoruwaje/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:46:22.294664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb6a99c6-f666-49b4-aa59-5feef8cb6aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c30a9b0>]}
[0m22:46:22.322918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb6a99c6-f666-49b4-aa59-5feef8cb6aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ebefb0>]}
[0m22:46:22.323300 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:46:22.434740 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:46:22.509527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:46:22.509804 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:46:22.513182 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.staging
- models.intermatedbt.marts
- models.intermatedbt.fact_tables
[0m22:46:22.530888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb6a99c6-f666-49b4-aa59-5feef8cb6aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f965570>]}
[0m22:46:22.574518 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m22:46:22.575841 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m22:46:22.587125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb6a99c6-f666-49b4-aa59-5feef8cb6aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f9227a0>]}
[0m22:46:22.587436 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m22:46:22.587620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb6a99c6-f666-49b4-aa59-5feef8cb6aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f9223e0>]}
[0m22:46:22.588497 [info ] [MainThread]: 
[0m22:46:22.588689 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:46:22.588839 [info ] [MainThread]: 
[0m22:46:22.589106 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:46:22.591498 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m22:46:22.591729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:23.163859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m22:46:23.165119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:46:23.561446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb6a99c6-f666-49b4-aa59-5feef8cb6aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eb2650>]}
[0m22:46:23.563191 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:46:23.567933 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m22:46:23.568822 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m22:46:23.569728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m22:46:23.570324 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m22:46:23.586167 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m22:46:23.587486 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m22:46:23.615866 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m22:46:23.616769 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    amount_spent AS ad_spend_usd,
    amount_spent * 0.85 AS ad_spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`raw.clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE amount_spent IS NOT NULL;


[0m22:46:23.617125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:46:24.070327 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:340a1951-f34d-4f6b-a5ab-a2e56cab03f3&page=queryresults
[0m22:46:24.071919 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:340a1951-f34d-4f6b-a5ab-a2e56cab03f3&page=queryresults
[0m22:46:24.082267 [debug] [Thread-1 (]: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m22:46:24.085447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb6a99c6-f666-49b4-aa59-5feef8cb6aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103edb040>]}
[0m22:46:24.086776 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model order_ad_data.stg_facebook_ads ............ [[31mERROR[0m in 0.51s]
[0m22:46:24.087738 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m22:46:24.088302 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m22:46:24.088934 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_facebook_ads' to be skipped because of status 'error'.  Reason: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql.
[0m22:46:24.089627 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m22:46:24.091142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m22:46:24.091663 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m22:46:24.096440 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m22:46:24.097442 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m22:46:24.100604 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m22:46:24.101514 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(created_at AS DATE) AS order_date,
    total_price AS total_amount_usd,
    total_price * 0.85 AS total_amount_eur,
    discount_code
FROM `atomic-sled-453015-g3`.`order_ad_data`.`raw.clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE order_status = 'completed';


[0m22:46:24.101966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:46:24.478634 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:96868571-1f78-464c-8708-16d7ccab09eb&page=queryresults
[0m22:46:24.479762 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:96868571-1f78-464c-8708-16d7ccab09eb&page=queryresults
[0m22:46:24.482392 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m22:46:24.483485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb6a99c6-f666-49b4-aa59-5feef8cb6aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f9a2ec0>]}
[0m22:46:24.484807 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 0.39s]
[0m22:46:24.486212 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m22:46:24.487420 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m22:46:24.488649 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m22:46:24.489407 [info ] [Thread-1 (]: 3 of 6 SKIP relation order_ad_data.fact_new_customer_orders .................... [[33mSKIP[0m]
[0m22:46:24.490134 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m22:46:24.491041 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m22:46:24.491719 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m22:46:24.492312 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m22:46:24.492850 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m22:46:24.493479 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m22:46:24.494129 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m22:46:24.494688 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m22:46:24.495325 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m22:46:24.495935 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m22:46:24.497236 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:46:24.498058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:46:24.498428 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m22:46:24.498915 [info ] [MainThread]: 
[0m22:46:24.499311 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 1.91 seconds (1.91s).
[0m22:46:24.500414 [debug] [MainThread]: Command end result
[0m22:46:24.529340 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m22:46:24.530867 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m22:46:24.536536 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m22:46:24.536832 [info ] [MainThread]: 
[0m22:46:24.537145 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m22:46:24.537404 [info ] [MainThread]: 
[0m22:46:24.537719 [error] [MainThread]:   Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m22:46:24.537977 [info ] [MainThread]: 
[0m22:46:24.538260 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m22:46:24.538507 [info ] [MainThread]: 
[0m22:46:24.538768 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=4 TOTAL=6
[0m22:46:24.541224 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.191074, "process_in_blocks": "0", "process_kernel_time": 1.068922, "process_mem_max_rss": "210190336", "process_out_blocks": "0", "process_user_time": 2.433724}
[0m22:46:24.541590 [debug] [MainThread]: Command `dbt run` failed at 22:46:24.541525 after 3.19 seconds
[0m22:46:24.541885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104098970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c30a9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f93be20>]}
[0m22:46:24.542165 [debug] [MainThread]: Flushing usage events
[0m22:46:25.027645 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:54:36.468058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b848b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d5ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d57e0>]}


============================== 22:54:36.472260 | aa145577-bf0b-44dc-8cb3-8431e84cae18 ==============================
[0m22:54:36.472260 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:54:36.472619 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:54:37.348709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa145577-bf0b-44dc-8cb3-8431e84cae18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13410bc40>]}
[0m22:54:37.377085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa145577-bf0b-44dc-8cb3-8431e84cae18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c399c0>]}
[0m22:54:37.377492 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:54:37.485556 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:54:37.562885 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:54:37.563399 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:54:37.566754 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.staging
- models.intermatedbt.fact_tables
- models.intermatedbt.marts
[0m22:54:37.584164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa145577-bf0b-44dc-8cb3-8431e84cae18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1348654e0>]}
[0m22:54:37.628819 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m22:54:37.630072 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m22:54:37.641077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa145577-bf0b-44dc-8cb3-8431e84cae18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134805e10>]}
[0m22:54:37.641387 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m22:54:37.641566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa145577-bf0b-44dc-8cb3-8431e84cae18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134806b90>]}
[0m22:54:37.642422 [info ] [MainThread]: 
[0m22:54:37.642617 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:54:37.642769 [info ] [MainThread]: 
[0m22:54:37.643051 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:54:37.645719 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m22:54:37.645992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:54:38.249252 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m22:54:38.250502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:54:38.691090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa145577-bf0b-44dc-8cb3-8431e84cae18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069a8670>]}
[0m22:54:38.692273 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:54:38.698391 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m22:54:38.699391 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m22:54:38.700352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m22:54:38.700927 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m22:54:38.717050 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m22:54:38.718275 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m22:54:38.748146 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m22:54:38.748925 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    amount_spent AS ad_spend_usd,
    amount_spent * 0.85 AS ad_spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`raw.clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE amount_spent IS NOT NULL;


[0m22:54:38.749288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:54:39.097865 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:c476a1a6-da8f-472e-93a2-d4437d829fcf&page=queryresults
[0m22:54:39.099706 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:c476a1a6-da8f-472e-93a2-d4437d829fcf&page=queryresults
[0m22:54:39.109891 [debug] [Thread-1 (]: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m22:54:39.112997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa145577-bf0b-44dc-8cb3-8431e84cae18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105637490>]}
[0m22:54:39.114080 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model order_ad_data.stg_facebook_ads ............ [[31mERROR[0m in 0.41s]
[0m22:54:39.114988 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m22:54:39.115549 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m22:54:39.116166 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_facebook_ads' to be skipped because of status 'error'.  Reason: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql.
[0m22:54:39.116848 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m22:54:39.118366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m22:54:39.118872 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m22:54:39.123516 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m22:54:39.124425 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m22:54:39.127582 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m22:54:39.128668 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(created_at AS DATE) AS order_date,
    total_price AS total_amount_usd,
    total_price * 0.85 AS total_amount_eur,
    discount_code
FROM `atomic-sled-453015-g3`.`order_ad_data`.`raw.clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE order_status = 'completed';


[0m22:54:39.129186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:54:39.486047 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:6a7f18a8-51e0-4c72-ab88-29c12414d23a&page=queryresults
[0m22:54:39.487919 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:6a7f18a8-51e0-4c72-ab88-29c12414d23a&page=queryresults
[0m22:54:39.491521 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m22:54:39.492667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa145577-bf0b-44dc-8cb3-8431e84cae18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134a8eec0>]}
[0m22:54:39.493831 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 0.37s]
[0m22:54:39.494699 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m22:54:39.495430 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m22:54:39.496645 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m22:54:39.497473 [info ] [Thread-1 (]: 3 of 6 SKIP relation order_ad_data.fact_new_customer_orders .................... [[33mSKIP[0m]
[0m22:54:39.498141 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m22:54:39.500191 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m22:54:39.500851 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m22:54:39.501469 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m22:54:39.502029 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m22:54:39.502650 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m22:54:39.503273 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m22:54:39.503778 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m22:54:39.504279 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m22:54:39.504778 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m22:54:39.505853 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:54:39.506581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:54:39.506937 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m22:54:39.507419 [info ] [MainThread]: 
[0m22:54:39.507818 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 1.86 seconds (1.86s).
[0m22:54:39.508925 [debug] [MainThread]: Command end result
[0m22:54:39.537085 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m22:54:39.538623 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m22:54:39.544316 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m22:54:39.544682 [info ] [MainThread]: 
[0m22:54:39.544990 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m22:54:39.545227 [info ] [MainThread]: 
[0m22:54:39.545513 [error] [MainThread]:   Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m22:54:39.545742 [info ] [MainThread]: 
[0m22:54:39.546003 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m22:54:39.546227 [info ] [MainThread]: 
[0m22:54:39.546461 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=4 TOTAL=6
[0m22:54:39.548780 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.1217713, "process_in_blocks": "0", "process_kernel_time": 0.951262, "process_mem_max_rss": "208338944", "process_out_blocks": "0", "process_user_time": 2.542117}
[0m22:54:39.549127 [debug] [MainThread]: Command `dbt run` failed at 22:54:39.549068 after 3.12 seconds
[0m22:54:39.549427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b848b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13410bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1348382e0>]}
[0m22:54:39.549712 [debug] [MainThread]: Flushing usage events
[0m22:54:40.030025 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:59:16.630887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be0910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a31e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a31780>]}


============================== 22:59:16.635253 | 228dfd9c-df21-4449-a63e-4754c0c15ae4 ==============================
[0m22:59:16.635253 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:59:16.635604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:59:17.523524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '228dfd9c-df21-4449-a63e-4754c0c15ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a208eb0>]}
[0m22:59:17.551590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '228dfd9c-df21-4449-a63e-4754c0c15ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084be950>]}
[0m22:59:17.551995 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:59:17.665213 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:59:17.741139 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:59:17.741703 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/sources.yml
[0m22:59:17.919329 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.fact_tables
- models.intermatedbt.staging
- models.intermatedbt.marts
[0m22:59:17.926225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '228dfd9c-df21-4449-a63e-4754c0c15ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d996860>]}
[0m22:59:17.968200 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m22:59:17.969534 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m22:59:17.980284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '228dfd9c-df21-4449-a63e-4754c0c15ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12db0ac50>]}
[0m22:59:17.980588 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m22:59:17.980774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '228dfd9c-df21-4449-a63e-4754c0c15ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c8550>]}
[0m22:59:17.981688 [info ] [MainThread]: 
[0m22:59:17.981886 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:59:17.982048 [info ] [MainThread]: 
[0m22:59:17.982315 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:59:17.984658 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m22:59:17.984887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:59:18.476791 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m22:59:18.478494 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:59:18.920930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '228dfd9c-df21-4449-a63e-4754c0c15ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a04670>]}
[0m22:59:18.922063 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:59:18.926184 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m22:59:18.927086 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m22:59:18.927847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m22:59:18.928454 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m22:59:18.941323 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m22:59:18.942442 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m22:59:18.970932 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m22:59:18.971804 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    amount_spent AS ad_spend_usd,
    amount_spent * 0.85 AS ad_spend_eur
FROM `atomic-sled-453015-g`.`order_ad_data`.`raw.clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE amount_spent IS NOT NULL;


[0m22:59:18.972228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:59:19.332216 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:25835f2f-d2da-41f3-bd5d-3b0ad036e3c2&page=queryresults
[0m22:59:19.333707 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:25835f2f-d2da-41f3-bd5d-3b0ad036e3c2&page=queryresults
[0m22:59:19.342876 [debug] [Thread-1 (]: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m22:59:19.346458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '228dfd9c-df21-4449-a63e-4754c0c15ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c77820>]}
[0m22:59:19.347570 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model order_ad_data.stg_facebook_ads ............ [[31mERROR[0m in 0.42s]
[0m22:59:19.348426 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m22:59:19.348919 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m22:59:19.349506 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_facebook_ads' to be skipped because of status 'error'.  Reason: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql.
[0m22:59:19.350164 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m22:59:19.351628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m22:59:19.352119 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m22:59:19.356603 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m22:59:19.357528 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m22:59:19.360967 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m22:59:19.361911 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(created_at AS DATE) AS order_date,
    total_price AS total_amount_usd,
    total_price * 0.85 AS total_amount_eur,
    discount_code
FROM `atomic-sled-453015-g`.`order_ad_data`.`raw.clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE order_status = 'completed';


[0m22:59:19.362493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:59:19.710551 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:369b98cd-33bb-448a-8d28-d1df565b1e1a&page=queryresults
[0m22:59:19.712157 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:369b98cd-33bb-448a-8d28-d1df565b1e1a&page=queryresults
[0m22:59:19.715483 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m22:59:19.716764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '228dfd9c-df21-4449-a63e-4754c0c15ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12de2ccd0>]}
[0m22:59:19.718214 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 0.36s]
[0m22:59:19.719115 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m22:59:19.719849 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m22:59:19.720910 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m22:59:19.721604 [info ] [Thread-1 (]: 3 of 6 SKIP relation order_ad_data.fact_new_customer_orders .................... [[33mSKIP[0m]
[0m22:59:19.722295 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m22:59:19.723179 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m22:59:19.723807 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m22:59:19.724401 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m22:59:19.724941 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m22:59:19.725558 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m22:59:19.726163 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m22:59:19.726709 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m22:59:19.727309 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m22:59:19.727899 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m22:59:19.728996 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:59:19.729712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:59:19.730066 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m22:59:19.730537 [info ] [MainThread]: 
[0m22:59:19.730934 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 1.75 seconds (1.75s).
[0m22:59:19.732008 [debug] [MainThread]: Command end result
[0m22:59:19.759964 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m22:59:19.761465 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m22:59:19.766906 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m22:59:19.767191 [info ] [MainThread]: 
[0m22:59:19.767500 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m22:59:19.767757 [info ] [MainThread]: 
[0m22:59:19.768065 [error] [MainThread]:   Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m22:59:19.768319 [info ] [MainThread]: 
[0m22:59:19.768604 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m22:59:19.768846 [info ] [MainThread]: 
[0m22:59:19.769094 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=4 TOTAL=6
[0m22:59:19.771506 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.1862843, "process_in_blocks": "0", "process_kernel_time": 1.127704, "process_mem_max_rss": "212467712", "process_out_blocks": "0", "process_user_time": 2.574661}
[0m22:59:19.771866 [debug] [MainThread]: Command `dbt run` failed at 22:59:19.771804 after 3.19 seconds
[0m22:59:19.772164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be0910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084be950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12dd34c70>]}
[0m22:59:19.772446 [debug] [MainThread]: Flushing usage events
[0m22:59:20.261276 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:59:50.644036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034008e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104251e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042517b0>]}


============================== 22:59:50.647288 | 93e18072-c3db-4ad2-b36b-c92d355149ac ==============================
[0m22:59:50.647288 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:59:50.647641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:59:51.516518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93e18072-c3db-4ad2-b36b-c92d355149ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142e422f0>]}
[0m22:59:51.544687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93e18072-c3db-4ad2-b36b-c92d355149ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034a18a0>]}
[0m22:59:51.545105 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m22:59:51.665495 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:59:51.737121 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:59:51.737686 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/sources.yml
[0m22:59:51.911696 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.fact_tables
- models.intermatedbt.staging
- models.intermatedbt.marts
[0m22:59:51.918184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93e18072-c3db-4ad2-b36b-c92d355149ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1436c06d0>]}
[0m22:59:51.960040 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m22:59:51.961269 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m22:59:51.973305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93e18072-c3db-4ad2-b36b-c92d355149ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1436df880>]}
[0m22:59:51.973627 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m22:59:51.973819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93e18072-c3db-4ad2-b36b-c92d355149ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1436df3a0>]}
[0m22:59:51.974843 [info ] [MainThread]: 
[0m22:59:51.975047 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:59:51.975208 [info ] [MainThread]: 
[0m22:59:51.975487 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:59:51.977959 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m22:59:51.978202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:59:52.493406 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m22:59:52.494431 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:59:52.800587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93e18072-c3db-4ad2-b36b-c92d355149ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104224640>]}
[0m22:59:52.801806 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:59:52.806714 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m22:59:52.807772 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m22:59:52.808631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m22:59:52.810815 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m22:59:52.825806 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m22:59:52.827184 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m22:59:52.858011 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m22:59:52.858799 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    amount_spent AS ad_spend_usd,
    amount_spent * 0.85 AS ad_spend_eur
FROM `atomic-sled-453015-g3`.`orders-and-ads`.`raw.clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE amount_spent IS NOT NULL;


[0m22:59:52.859194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:59:53.227683 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:211b4943-4075-4075-aeda-25441b535771&page=queryresults
[0m22:59:53.228223 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:211b4943-4075-4075-aeda-25441b535771&page=queryresults
[0m22:59:53.233944 [debug] [Thread-1 (]: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.orders-and-ads'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m22:59:53.235917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93e18072-c3db-4ad2-b36b-c92d355149ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031b6830>]}
[0m22:59:53.236490 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model order_ad_data.stg_facebook_ads ............ [[31mERROR[0m in 0.43s]
[0m22:59:53.236935 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m22:59:53.237227 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m22:59:53.237589 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_facebook_ads' to be skipped because of status 'error'.  Reason: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.orders-and-ads'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql.
[0m22:59:53.237992 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m22:59:53.238949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m22:59:53.239244 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m22:59:53.241857 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m22:59:53.242473 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m22:59:53.244515 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m22:59:53.245080 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(created_at AS DATE) AS order_date,
    total_price AS total_amount_usd,
    total_price * 0.85 AS total_amount_eur,
    discount_code
FROM `atomic-sled-453015-g3`.`orders-and-ads`.`raw.clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE order_status = 'completed';


[0m22:59:53.245381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:59:53.581454 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:5dfdadc9-430b-4b54-b328-de92e070ec6f&page=queryresults
[0m22:59:53.583091 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:5dfdadc9-430b-4b54-b328-de92e070ec6f&page=queryresults
[0m22:59:53.586270 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.orders-and-ads'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m22:59:53.587518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93e18072-c3db-4ad2-b36b-c92d355149ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143a28d90>]}
[0m22:59:53.588854 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 0.35s]
[0m22:59:53.590022 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m22:59:53.591200 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.orders-and-ads'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m22:59:53.592248 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m22:59:53.593100 [info ] [Thread-1 (]: 3 of 6 SKIP relation order_ad_data.fact_new_customer_orders .................... [[33mSKIP[0m]
[0m22:59:53.593781 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m22:59:53.594656 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m22:59:53.595361 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m22:59:53.596073 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m22:59:53.596665 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m22:59:53.597318 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m22:59:53.597944 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m22:59:53.598524 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m22:59:53.599126 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m22:59:53.599694 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m22:59:53.600841 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:59:53.601596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:59:53.601974 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m22:59:53.602476 [info ] [MainThread]: 
[0m22:59:53.602883 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 1.63 seconds (1.63s).
[0m22:59:53.604044 [debug] [MainThread]: Command end result
[0m22:59:53.632368 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m22:59:53.633956 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m22:59:53.639299 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m22:59:53.639592 [info ] [MainThread]: 
[0m22:59:53.639909 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m22:59:53.640167 [info ] [MainThread]: 
[0m22:59:53.640512 [error] [MainThread]:   Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.orders-and-ads'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m22:59:53.640775 [info ] [MainThread]: 
[0m22:59:53.641051 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.orders-and-ads'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m22:59:53.641294 [info ] [MainThread]: 
[0m22:59:53.641545 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=4 TOTAL=6
[0m22:59:53.644497 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.0439224, "process_in_blocks": "0", "process_kernel_time": 1.212963, "process_mem_max_rss": "212500480", "process_out_blocks": "0", "process_user_time": 2.389469}
[0m22:59:53.645118 [debug] [MainThread]: Command `dbt run` failed at 22:59:53.645043 after 3.04 seconds
[0m22:59:53.645440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034008e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1438305b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1434df010>]}
[0m22:59:53.646037 [debug] [MainThread]: Flushing usage events
[0m22:59:54.069011 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:00:30.014505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072bc940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10810de10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10810d750>]}


============================== 23:00:30.019391 | b8dbe2e5-613a-46b3-8542-69f86fe0d898 ==============================
[0m23:00:30.019391 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:00:30.019726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:00:30.959222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8dbe2e5-613a-46b3-8542-69f86fe0d898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062319c0>]}
[0m23:00:30.987280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8dbe2e5-613a-46b3-8542-69f86fe0d898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c04a00>]}
[0m23:00:30.987655 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m23:00:31.098741 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:00:31.187741 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:00:31.188355 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/sources.yml
[0m23:00:31.365468 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.staging
- models.intermatedbt.marts
- models.intermatedbt.fact_tables
[0m23:00:31.371895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8dbe2e5-613a-46b3-8542-69f86fe0d898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1250536d0>]}
[0m23:00:31.415186 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m23:00:31.416701 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m23:00:31.428069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8dbe2e5-613a-46b3-8542-69f86fe0d898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125006230>]}
[0m23:00:31.428401 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m23:00:31.428583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8dbe2e5-613a-46b3-8542-69f86fe0d898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125005990>]}
[0m23:00:31.429495 [info ] [MainThread]: 
[0m23:00:31.429693 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:00:31.429847 [info ] [MainThread]: 
[0m23:00:31.430120 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:00:31.432488 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m23:00:31.432723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:31.919930 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m23:00:31.921434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:00:32.225983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8dbe2e5-613a-46b3-8542-69f86fe0d898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e06a0>]}
[0m23:00:32.227681 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:00:32.233849 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m23:00:32.234851 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m23:00:32.235660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m23:00:32.236243 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m23:00:32.249368 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m23:00:32.250753 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m23:00:32.279278 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m23:00:32.280766 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    amount_spent AS ad_spend_usd,
    amount_spent * 0.85 AS ad_spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`raw.clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE amount_spent IS NOT NULL;


[0m23:00:32.281165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:00:32.792727 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:98733e33-0269-42fd-a61d-5b46a8bf22a3&page=queryresults
[0m23:00:32.794673 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:98733e33-0269-42fd-a61d-5b46a8bf22a3&page=queryresults
[0m23:00:32.804908 [debug] [Thread-1 (]: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m23:00:32.808433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8dbe2e5-613a-46b3-8542-69f86fe0d898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070ff040>]}
[0m23:00:32.809637 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model order_ad_data.stg_facebook_ads ............ [[31mERROR[0m in 0.57s]
[0m23:00:32.810570 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m23:00:32.811081 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m23:00:32.811696 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_facebook_ads' to be skipped because of status 'error'.  Reason: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql.
[0m23:00:32.812398 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m23:00:32.813973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m23:00:32.814486 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m23:00:32.819067 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m23:00:32.820289 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m23:00:32.823643 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m23:00:32.824525 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(created_at AS DATE) AS order_date,
    total_price AS total_amount_usd,
    total_price * 0.85 AS total_amount_eur,
    discount_code
FROM `atomic-sled-453015-g3`.`order_ad_data`.`raw.clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE order_status = 'completed';


[0m23:00:32.825011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:00:33.156283 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:12bba0d5-c9b3-4f69-aebb-49ec8f0670c8&page=queryresults
[0m23:00:33.158311 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:12bba0d5-c9b3-4f69-aebb-49ec8f0670c8&page=queryresults
[0m23:00:33.161419 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m23:00:33.162725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8dbe2e5-613a-46b3-8542-69f86fe0d898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125428d90>]}
[0m23:00:33.163825 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 0.35s]
[0m23:00:33.164712 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m23:00:33.165446 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m23:00:33.166531 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m23:00:33.167250 [info ] [Thread-1 (]: 3 of 6 SKIP relation order_ad_data.fact_new_customer_orders .................... [[33mSKIP[0m]
[0m23:00:33.167989 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m23:00:33.168895 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m23:00:33.169566 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m23:00:33.170184 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m23:00:33.170737 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m23:00:33.171370 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m23:00:33.171984 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m23:00:33.172529 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m23:00:33.173278 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m23:00:33.173763 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m23:00:33.174921 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:00:33.175802 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:00:33.176180 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m23:00:33.176680 [info ] [MainThread]: 
[0m23:00:33.177089 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 1.75 seconds (1.75s).
[0m23:00:33.178240 [debug] [MainThread]: Command end result
[0m23:00:33.206156 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m23:00:33.207757 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m23:00:33.213361 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m23:00:33.213680 [info ] [MainThread]: 
[0m23:00:33.214007 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:00:33.214247 [info ] [MainThread]: 
[0m23:00:33.214533 [error] [MainThread]:   Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m23:00:33.214757 [info ] [MainThread]: 
[0m23:00:33.215010 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m23:00:33.215226 [info ] [MainThread]: 
[0m23:00:33.215449 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=4 TOTAL=6
[0m23:00:33.218035 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.2440827, "process_in_blocks": "0", "process_kernel_time": 0.974466, "process_mem_max_rss": "216956928", "process_out_blocks": "0", "process_user_time": 2.711896}
[0m23:00:33.218432 [debug] [MainThread]: Command `dbt run` failed at 23:00:33.218363 after 3.24 seconds
[0m23:00:33.218770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072bc940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1250dd180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125336d70>]}
[0m23:00:33.219083 [debug] [MainThread]: Flushing usage events
[0m23:00:33.645158 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:01:19.871874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104194910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe5e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe5780>]}


============================== 23:01:19.877500 | 79f40b54-4d17-45db-b564-f0c721201ebd ==============================
[0m23:01:19.877500 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:01:19.877908 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'profiles_dir': '/Users/victoruwaje/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:01:20.861848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79f40b54-4d17-45db-b564-f0c721201ebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030e5990>]}
[0m23:01:20.890230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79f40b54-4d17-45db-b564-f0c721201ebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1439a9150>]}
[0m23:01:20.890635 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m23:01:21.000228 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:01:21.076045 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:01:21.076310 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:01:21.079653 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.fact_tables
- models.intermatedbt.staging
- models.intermatedbt.marts
[0m23:01:21.096765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79f40b54-4d17-45db-b564-f0c721201ebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144067fa0>]}
[0m23:01:21.157889 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m23:01:21.159177 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m23:01:21.170248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79f40b54-4d17-45db-b564-f0c721201ebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144023190>]}
[0m23:01:21.170570 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m23:01:21.170753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79f40b54-4d17-45db-b564-f0c721201ebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144067100>]}
[0m23:01:21.171631 [info ] [MainThread]: 
[0m23:01:21.171831 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:01:21.171981 [info ] [MainThread]: 
[0m23:01:21.172247 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:01:21.174650 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m23:01:21.174877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:01:21.732999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m23:01:21.734238 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:01:22.210883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79f40b54-4d17-45db-b564-f0c721201ebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c73fa0>]}
[0m23:01:22.212335 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:01:22.217593 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m23:01:22.218550 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m23:01:22.219500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m23:01:22.220074 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m23:01:22.235547 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m23:01:22.236830 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m23:01:22.266585 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m23:01:22.267615 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    amount_spent AS ad_spend_usd,
    amount_spent * 0.85 AS ad_spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`raw.clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE amount_spent IS NOT NULL;


[0m23:01:22.268030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:01:22.806035 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:eac2bd27-8d2b-4df9-a87e-ae79da594acc&page=queryresults
[0m23:01:22.807200 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:eac2bd27-8d2b-4df9-a87e-ae79da594acc&page=queryresults
[0m23:01:22.816928 [debug] [Thread-1 (]: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m23:01:22.820058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79f40b54-4d17-45db-b564-f0c721201ebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143a812a0>]}
[0m23:01:22.821216 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model order_ad_data.stg_facebook_ads ............ [[31mERROR[0m in 0.60s]
[0m23:01:22.822157 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m23:01:22.822764 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m23:01:22.823516 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_facebook_ads' to be skipped because of status 'error'.  Reason: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql.
[0m23:01:22.824327 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m23:01:22.825928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m23:01:22.826414 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m23:01:22.830991 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m23:01:22.832392 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m23:01:22.836057 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m23:01:22.837203 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(created_at AS DATE) AS order_date,
    total_price AS total_amount_usd,
    total_price * 0.85 AS total_amount_eur,
    discount_code
FROM `atomic-sled-453015-g3`.`order_ad_data`.`raw.clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE order_status = 'completed';


[0m23:01:22.837692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:01:23.123104 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:630e6f8e-6a80-44ed-859e-d31b929d429c&page=queryresults
[0m23:01:23.124398 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:630e6f8e-6a80-44ed-859e-d31b929d429c&page=queryresults
[0m23:01:23.130497 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m23:01:23.131934 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79f40b54-4d17-45db-b564-f0c721201ebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14428f250>]}
[0m23:01:23.133222 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 0.31s]
[0m23:01:23.134664 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m23:01:23.135587 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m23:01:23.136781 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m23:01:23.137408 [info ] [Thread-1 (]: 3 of 6 SKIP relation order_ad_data.fact_new_customer_orders .................... [[33mSKIP[0m]
[0m23:01:23.138119 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m23:01:23.139017 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m23:01:23.139684 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m23:01:23.140287 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m23:01:23.140830 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m23:01:23.141444 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m23:01:23.142078 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m23:01:23.142615 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m23:01:23.143214 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m23:01:23.143810 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m23:01:23.145094 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:01:23.146135 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:01:23.146554 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m23:01:23.147071 [info ] [MainThread]: 
[0m23:01:23.147490 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 1.97 seconds (1.97s).
[0m23:01:23.148617 [debug] [MainThread]: Command end result
[0m23:01:23.179229 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m23:01:23.180885 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m23:01:23.186266 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m23:01:23.186552 [info ] [MainThread]: 
[0m23:01:23.186862 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:01:23.187116 [info ] [MainThread]: 
[0m23:01:23.187425 [error] [MainThread]:   Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m23:01:23.187677 [info ] [MainThread]: 
[0m23:01:23.187956 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m23:01:23.188201 [info ] [MainThread]: 
[0m23:01:23.188447 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=4 TOTAL=6
[0m23:01:23.190887 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.3616219, "process_in_blocks": "0", "process_kernel_time": 1.119645, "process_mem_max_rss": "204144640", "process_out_blocks": "0", "process_user_time": 2.367995}
[0m23:01:23.191268 [debug] [MainThread]: Command `dbt run` failed at 23:01:23.191200 after 3.36 seconds
[0m23:01:23.191567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104194910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030e5990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144038970>]}
[0m23:01:23.191848 [debug] [MainThread]: Flushing usage events
[0m23:01:23.663091 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:12:16.827499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084808b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d95ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d957e0>]}


============================== 23:12:16.834059 | 83211b6e-f4ac-4f69-89b5-8437fdc16ebc ==============================
[0m23:12:16.834059 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:12:16.834426 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:12:17.744663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83211b6e-f4ac-4f69-89b5-8437fdc16ebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f243010>]}
[0m23:12:17.773943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83211b6e-f4ac-4f69-89b5-8437fdc16ebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f5cf10>]}
[0m23:12:17.774377 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m23:12:17.885508 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:12:17.962755 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:12:17.963149 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_facebook_ads.sql
[0m23:12:18.087342 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.staging
- models.intermatedbt.marts
- models.intermatedbt.fact_tables
[0m23:12:18.095148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83211b6e-f4ac-4f69-89b5-8437fdc16ebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f8dd1b0>]}
[0m23:12:18.142215 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m23:12:18.143518 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m23:12:18.157947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83211b6e-f4ac-4f69-89b5-8437fdc16ebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f8cdc90>]}
[0m23:12:18.159061 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m23:12:18.159254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83211b6e-f4ac-4f69-89b5-8437fdc16ebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f8cdf60>]}
[0m23:12:18.160374 [info ] [MainThread]: 
[0m23:12:18.160653 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:12:18.160837 [info ] [MainThread]: 
[0m23:12:18.161166 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:12:18.163699 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m23:12:18.163968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:19.117776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m23:12:19.119433 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:12:19.471131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83211b6e-f4ac-4f69-89b5-8437fdc16ebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f2beb00>]}
[0m23:12:19.472520 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:12:19.477324 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m23:12:19.478325 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m23:12:19.479072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m23:12:19.479649 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m23:12:19.493105 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m23:12:19.494310 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m23:12:19.523477 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m23:12:19.524544 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

WITH raw_facebook_ads AS (
    -- Referencing the raw Facebook Ads data from GCS via source
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`raw.clean_facebook_ads`  -- ✅ Matches `sources.yml` for clean_facebook_ads
)

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,  -- Convert date_start to DATE type
    impressions,
    clicks,
    amount_spent AS ad_spend_usd,  -- Rename amount_spent to ad_spend_usd
    amount_spent * 0.85 AS ad_spend_eur  -- Convert USD to EUR (0.85 is the conversion rate)
FROM raw_facebook_ads  -- Reference the raw data in the CTE
WHERE amount_spent IS NOT NULL  -- Filter out rows with null values for amount_spent;


[0m23:12:19.524951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:12:19.918429 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:8e073b02-b08b-4190-a12f-9c5dc2d70551&page=queryresults
[0m23:12:19.920264 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:8e073b02-b08b-4190-a12f-9c5dc2d70551&page=queryresults
[0m23:12:19.929996 [debug] [Thread-1 (]: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m23:12:19.933314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83211b6e-f4ac-4f69-89b5-8437fdc16ebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f6e7460>]}
[0m23:12:19.934421 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model order_ad_data.stg_facebook_ads ............ [[31mERROR[0m in 0.45s]
[0m23:12:19.935241 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m23:12:19.935727 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m23:12:19.936325 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_facebook_ads' to be skipped because of status 'error'.  Reason: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql.
[0m23:12:19.936949 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m23:12:19.940416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m23:12:19.940969 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m23:12:19.945239 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m23:12:19.946356 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m23:12:19.949377 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m23:12:19.950588 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(created_at AS DATE) AS order_date,
    total_price AS total_amount_usd,
    total_price * 0.85 AS total_amount_eur,
    discount_code
FROM `atomic-sled-453015-g3`.`order_ad_data`.`raw.clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE order_status = 'completed';


[0m23:12:19.951149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:12:20.343745 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:7d1643a3-b862-48b9-b5e7-ede987b3c035&page=queryresults
[0m23:12:20.345724 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:7d1643a3-b862-48b9-b5e7-ede987b3c035&page=queryresults
[0m23:12:20.348880 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m23:12:20.350262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83211b6e-f4ac-4f69-89b5-8437fdc16ebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f8cc160>]}
[0m23:12:20.351554 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 0.41s]
[0m23:12:20.352750 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m23:12:20.353480 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m23:12:20.354486 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m23:12:20.355376 [info ] [Thread-1 (]: 3 of 6 SKIP relation order_ad_data.fact_new_customer_orders .................... [[33mSKIP[0m]
[0m23:12:20.356071 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m23:12:20.357040 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m23:12:20.357762 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m23:12:20.358637 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m23:12:20.359337 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m23:12:20.359985 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m23:12:20.360590 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m23:12:20.361119 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m23:12:20.361650 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m23:12:20.362198 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m23:12:20.363351 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:12:20.364070 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:12:20.364434 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m23:12:20.364920 [info ] [MainThread]: 
[0m23:12:20.365328 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 2.20 seconds (2.20s).
[0m23:12:20.366429 [debug] [MainThread]: Command end result
[0m23:12:20.394092 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m23:12:20.395621 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m23:12:20.401268 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m23:12:20.401565 [info ] [MainThread]: 
[0m23:12:20.401870 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:12:20.402122 [info ] [MainThread]: 
[0m23:12:20.402424 [error] [MainThread]:   Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m23:12:20.402660 [info ] [MainThread]: 
[0m23:12:20.402915 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m23:12:20.403134 [info ] [MainThread]: 
[0m23:12:20.403357 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=4 TOTAL=6
[0m23:12:20.405713 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.6236434, "process_in_blocks": "0", "process_kernel_time": 1.018771, "process_mem_max_rss": "209321984", "process_out_blocks": "0", "process_user_time": 2.452504}
[0m23:12:20.406047 [debug] [MainThread]: Command `dbt run` failed at 23:12:20.405989 after 3.62 seconds
[0m23:12:20.406328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084808b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f243010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108516dd0>]}
[0m23:12:20.406601 [debug] [MainThread]: Flushing usage events
[0m23:12:22.326490 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:14:45.162750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107230910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c99ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c997e0>]}


============================== 23:14:45.168874 | 29ad6a6a-668f-4f77-b09d-40ad16c24544 ==============================
[0m23:14:45.168874 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:14:45.169233 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_facebook_ads stg_shopify_orders', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:14:46.071135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29ad6a6a-668f-4f77-b09d-40ad16c24544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106181990>]}
[0m23:14:46.100359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29ad6a6a-668f-4f77-b09d-40ad16c24544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1459b50c0>]}
[0m23:14:46.100812 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m23:14:46.213041 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:14:46.289691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:14:46.290083 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_facebook_ads.sql
[0m23:14:46.413279 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.marts
- models.intermatedbt.fact_tables
- models.intermatedbt.staging
[0m23:14:46.420681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29ad6a6a-668f-4f77-b09d-40ad16c24544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1460e50f0>]}
[0m23:14:46.464433 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m23:14:46.465652 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m23:14:46.476384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29ad6a6a-668f-4f77-b09d-40ad16c24544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1460d1a20>]}
[0m23:14:46.476685 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m23:14:46.476867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29ad6a6a-668f-4f77-b09d-40ad16c24544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1460e7910>]}
[0m23:14:46.477646 [info ] [MainThread]: 
[0m23:14:46.477850 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:14:46.478010 [info ] [MainThread]: 
[0m23:14:46.478287 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:14:46.480511 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m23:14:46.480738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:14:47.029185 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m23:14:47.029912 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:14:47.496282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29ad6a6a-668f-4f77-b09d-40ad16c24544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe26b0>]}
[0m23:14:47.498063 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:14:47.503286 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m23:14:47.504319 [info ] [Thread-1 (]: 1 of 2 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m23:14:47.505121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m23:14:47.505692 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m23:14:47.519326 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m23:14:47.520697 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m23:14:47.549737 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m23:14:47.550640 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    amount_spent AS ad_spend_usd,
    amount_spent * 0.85 AS ad_spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`raw.clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE amount_spent IS NOT NULL;


[0m23:14:47.551046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:48.005395 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:4069e7f9-0c2c-4209-b34d-9fb83ad942be&page=queryresults
[0m23:14:48.007046 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:4069e7f9-0c2c-4209-b34d-9fb83ad942be&page=queryresults
[0m23:14:48.016800 [debug] [Thread-1 (]: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m23:14:48.020421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29ad6a6a-668f-4f77-b09d-40ad16c24544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c7820>]}
[0m23:14:48.021525 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model order_ad_data.stg_facebook_ads ............ [[31mERROR[0m in 0.51s]
[0m23:14:48.022634 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m23:14:48.023257 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m23:14:48.023943 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_facebook_ads' to be skipped because of status 'error'.  Reason: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql.
[0m23:14:48.024586 [info ] [Thread-1 (]: 2 of 2 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m23:14:48.027929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m23:14:48.028459 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m23:14:48.032858 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m23:14:48.033856 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m23:14:48.037264 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m23:14:48.038350 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(created_at AS DATE) AS order_date,
    total_price AS total_amount_usd,
    total_price * 0.85 AS total_amount_eur,
    discount_code
FROM `atomic-sled-453015-g3`.`order_ad_data`.`raw.clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE order_status = 'completed';


[0m23:14:48.038873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:48.621042 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:a555b0d2-500e-45bd-84a4-6fc220168688&page=queryresults
[0m23:14:48.623043 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:a555b0d2-500e-45bd-84a4-6fc220168688&page=queryresults
[0m23:14:48.626477 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m23:14:48.627806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29ad6a6a-668f-4f77-b09d-40ad16c24544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14654f190>]}
[0m23:14:48.629284 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 0.60s]
[0m23:14:48.630227 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m23:14:48.631010 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m23:14:48.632667 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:14:48.633741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:14:48.634412 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m23:14:48.635053 [info ] [MainThread]: 
[0m23:14:48.635596 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.16 seconds (2.16s).
[0m23:14:48.636809 [debug] [MainThread]: Command end result
[0m23:14:48.667773 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m23:14:48.669586 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m23:14:48.675280 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m23:14:48.675590 [info ] [MainThread]: 
[0m23:14:48.675915 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:14:48.676186 [info ] [MainThread]: 
[0m23:14:48.676501 [error] [MainThread]:   Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m23:14:48.676765 [info ] [MainThread]: 
[0m23:14:48.677057 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m23:14:48.677307 [info ] [MainThread]: 
[0m23:14:48.677562 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m23:14:48.680392 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.5592086, "process_in_blocks": "0", "process_kernel_time": 1.021793, "process_mem_max_rss": "214073344", "process_out_blocks": "0", "process_user_time": 2.632619}
[0m23:14:48.680956 [debug] [MainThread]: Command `dbt run` failed at 23:14:48.680877 after 3.56 seconds
[0m23:14:48.681273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107230910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1459b50c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e8a00>]}
[0m23:14:48.681583 [debug] [MainThread]: Flushing usage events
[0m23:14:49.152583 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:15:41.456227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112980970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114199e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114199750>]}


============================== 23:15:41.462581 | 60e0443d-7c40-4b5b-8dfb-420595500189 ==============================
[0m23:15:41.462581 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:15:41.462949 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_facebook_ads stg_shopify_orders', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:15:42.352246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60e0443d-7c40-4b5b-8dfb-420595500189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14670a9b0>]}
[0m23:15:42.381468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60e0443d-7c40-4b5b-8dfb-420595500189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11416efb0>]}
[0m23:15:42.381883 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m23:15:42.494950 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:15:42.570109 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:15:42.570507 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/sources.yml
[0m23:15:42.617315 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.fact_tables
- models.intermatedbt.marts
- models.intermatedbt.staging
[0m23:15:42.624827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60e0443d-7c40-4b5b-8dfb-420595500189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146eadc00>]}
[0m23:15:42.668683 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m23:15:42.670042 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m23:15:42.681214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60e0443d-7c40-4b5b-8dfb-420595500189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146e91d50>]}
[0m23:15:42.681521 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m23:15:42.681701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60e0443d-7c40-4b5b-8dfb-420595500189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146e921a0>]}
[0m23:15:42.682512 [info ] [MainThread]: 
[0m23:15:42.682711 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:15:42.682864 [info ] [MainThread]: 
[0m23:15:42.683135 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:15:42.685359 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m23:15:42.685587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:15:43.202980 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m23:15:43.204393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:15:43.543357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60e0443d-7c40-4b5b-8dfb-420595500189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1467092a0>]}
[0m23:15:43.544948 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:15:43.549873 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m23:15:43.550959 [info ] [Thread-1 (]: 1 of 2 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m23:15:43.551704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m23:15:43.552269 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m23:15:43.565274 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m23:15:43.566303 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m23:15:43.596598 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m23:15:43.597423 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    amount_spent AS ad_spend_usd,
    amount_spent * 0.85 AS ad_spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`raw.clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE amount_spent IS NOT NULL;


[0m23:15:43.597863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:15:44.030228 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:af46c956-bd9d-495f-b78d-e05832204983&page=queryresults
[0m23:15:44.032112 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:af46c956-bd9d-495f-b78d-e05832204983&page=queryresults
[0m23:15:44.041656 [debug] [Thread-1 (]: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m23:15:44.044859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60e0443d-7c40-4b5b-8dfb-420595500189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11261b040>]}
[0m23:15:44.045888 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model order_ad_data.stg_facebook_ads ............ [[31mERROR[0m in 0.49s]
[0m23:15:44.046780 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m23:15:44.047269 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m23:15:44.047944 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_facebook_ads' to be skipped because of status 'error'.  Reason: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql.
[0m23:15:44.048606 [info ] [Thread-1 (]: 2 of 2 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m23:15:44.050391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m23:15:44.050847 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m23:15:44.055206 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m23:15:44.056278 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m23:15:44.059650 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m23:15:44.060480 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(created_at AS DATE) AS order_date,
    total_price AS total_amount_usd,
    total_price * 0.85 AS total_amount_eur,
    discount_code
FROM `atomic-sled-453015-g3`.`order_ad_data`.`raw.clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE order_status = 'completed';


[0m23:15:44.060925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:15:44.532205 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:9d732925-09ff-47ec-81a9-13aed4f61447&page=queryresults
[0m23:15:44.534126 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:9d732925-09ff-47ec-81a9-13aed4f61447&page=queryresults
[0m23:15:44.538102 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m23:15:44.539343 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60e0443d-7c40-4b5b-8dfb-420595500189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1470e71c0>]}
[0m23:15:44.540528 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 0.49s]
[0m23:15:44.541410 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m23:15:44.542176 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m23:15:44.543681 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:15:44.544583 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:15:44.545056 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m23:15:44.545606 [info ] [MainThread]: 
[0m23:15:44.546084 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.86 seconds (1.86s).
[0m23:15:44.547299 [debug] [MainThread]: Command end result
[0m23:15:44.577313 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m23:15:44.579084 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m23:15:44.585036 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m23:15:44.585339 [info ] [MainThread]: 
[0m23:15:44.585679 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:15:44.585943 [info ] [MainThread]: 
[0m23:15:44.586263 [error] [MainThread]:   Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m23:15:44.586521 [info ] [MainThread]: 
[0m23:15:44.586837 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m23:15:44.587097 [info ] [MainThread]: 
[0m23:15:44.587366 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m23:15:44.589835 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.1759768, "process_in_blocks": "0", "process_kernel_time": 1.172139, "process_mem_max_rss": "211025920", "process_out_blocks": "0", "process_user_time": 2.400687}
[0m23:15:44.590257 [debug] [MainThread]: Command `dbt run` failed at 23:15:44.590186 after 3.18 seconds
[0m23:15:44.590588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112980970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11416efb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a143a0>]}
[0m23:15:44.590904 [debug] [MainThread]: Flushing usage events
[0m23:15:45.021875 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:20:45.593927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a80910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105399e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105399780>]}


============================== 23:20:45.599619 | a8318494-4d9f-4c3e-8bb4-d5f4cf146fc2 ==============================
[0m23:20:45.599619 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:20:45.600067 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_facebook_ads stg_shopify_orders', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:20:46.543823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8318494-4d9f-4c3e-8bb4-d5f4cf146fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15af0aa70>]}
[0m23:20:46.572423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8318494-4d9f-4c3e-8bb4-d5f4cf146fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dcb340>]}
[0m23:20:46.572858 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m23:20:46.685970 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:20:46.762646 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:20:46.763042 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/sources.yml
[0m23:20:46.808593 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.fact_tables
- models.intermatedbt.marts
- models.intermatedbt.staging
[0m23:20:46.816311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8318494-4d9f-4c3e-8bb4-d5f4cf146fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15afa8f10>]}
[0m23:20:46.858637 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m23:20:46.859979 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m23:20:46.870840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8318494-4d9f-4c3e-8bb4-d5f4cf146fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b591e40>]}
[0m23:20:46.871156 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m23:20:46.871339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8318494-4d9f-4c3e-8bb4-d5f4cf146fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b593550>]}
[0m23:20:46.872163 [info ] [MainThread]: 
[0m23:20:46.872374 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:20:46.872526 [info ] [MainThread]: 
[0m23:20:46.872793 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:20:46.874970 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m23:20:46.875199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:20:47.499014 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m23:20:47.499507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:20:47.842036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8318494-4d9f-4c3e-8bb4-d5f4cf146fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10536c670>]}
[0m23:20:47.843646 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:20:47.849726 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m23:20:47.850896 [info ] [Thread-1 (]: 1 of 2 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m23:20:47.851678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m23:20:47.852262 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m23:20:47.865931 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m23:20:47.866979 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m23:20:47.897687 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m23:20:47.898578 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    amount_spent AS ad_spend_usd,
    amount_spent * 0.85 AS ad_spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`raw.clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE amount_spent IS NOT NULL;


[0m23:20:47.898963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:48.290617 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:779d497c-cd6c-4f32-b5e0-dc410eba505b&page=queryresults
[0m23:20:48.292806 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:779d497c-cd6c-4f32-b5e0-dc410eba505b&page=queryresults
[0m23:20:48.302463 [debug] [Thread-1 (]: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m23:20:48.305810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8318494-4d9f-4c3e-8bb4-d5f4cf146fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b17820>]}
[0m23:20:48.306802 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model order_ad_data.stg_facebook_ads ............ [[31mERROR[0m in 0.45s]
[0m23:20:48.307557 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m23:20:48.308055 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m23:20:48.308690 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_facebook_ads' to be skipped because of status 'error'.  Reason: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql.
[0m23:20:48.309386 [info ] [Thread-1 (]: 2 of 2 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m23:20:48.311201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m23:20:48.311694 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m23:20:48.316043 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m23:20:48.317158 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m23:20:48.320419 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m23:20:48.321391 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(created_at AS DATE) AS order_date,
    total_price AS total_amount_usd,
    total_price * 0.85 AS total_amount_eur,
    discount_code
FROM `atomic-sled-453015-g3`.`order_ad_data`.`raw.clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE order_status = 'completed';


[0m23:20:48.321839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:48.731613 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:7bf830c7-fbe0-4ca6-971e-68bda10c1102&page=queryresults
[0m23:20:48.733421 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:7bf830c7-fbe0-4ca6-971e-68bda10c1102&page=queryresults
[0m23:20:48.737510 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m23:20:48.738895 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8318494-4d9f-4c3e-8bb4-d5f4cf146fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b8e7250>]}
[0m23:20:48.740190 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 0.43s]
[0m23:20:48.741299 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m23:20:48.742064 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m23:20:48.743875 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:20:48.744988 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:20:48.745525 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m23:20:48.746152 [info ] [MainThread]: 
[0m23:20:48.746674 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.87 seconds (1.87s).
[0m23:20:48.747886 [debug] [MainThread]: Command end result
[0m23:20:48.778225 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m23:20:48.780082 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m23:20:48.786009 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m23:20:48.786346 [info ] [MainThread]: 
[0m23:20:48.786684 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:20:48.786945 [info ] [MainThread]: 
[0m23:20:48.787255 [error] [MainThread]:   Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m23:20:48.787522 [info ] [MainThread]: 
[0m23:20:48.787808 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m23:20:48.788053 [info ] [MainThread]: 
[0m23:20:48.788307 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m23:20:48.791373 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.2377462, "process_in_blocks": "0", "process_kernel_time": 0.900923, "process_mem_max_rss": "210026496", "process_out_blocks": "0", "process_user_time": 2.699731}
[0m23:20:48.791751 [debug] [MainThread]: Command `dbt run` failed at 23:20:48.791684 after 3.24 seconds
[0m23:20:48.792046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a80910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dcb340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b18a00>]}
[0m23:20:48.792336 [debug] [MainThread]: Flushing usage events
[0m23:20:49.274358 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:23:07.590195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083e4a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c99d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c99660>]}


============================== 23:23:07.596197 | 5d084f77-e557-4453-9097-f8fd9a5fc208 ==============================
[0m23:23:07.596197 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:23:07.596564 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --models stg_facebook_ads stg_shopify_orders', 'send_anonymous_usage_stats': 'True'}
[0m23:23:08.467960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d084f77-e557-4453-9097-f8fd9a5fc208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ab1f2e0>]}
[0m23:23:08.496409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d084f77-e557-4453-9097-f8fd9a5fc208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c6b040>]}
[0m23:23:08.496799 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m23:23:08.604826 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:23:08.680073 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:23:08.680666 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/sources.yml
[0m23:23:08.828913 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.intermate_dbt.stg_shopify_orders' (models/staging/stg_shopify_orders.sql) depends on a source named 'orders-and-ads.clean_shopify_orders' which was not found
[0m23:23:08.831933 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2819799, "process_in_blocks": "0", "process_kernel_time": 0.950736, "process_mem_max_rss": "210190336", "process_out_blocks": "0", "process_user_time": 2.415852}
[0m23:23:08.832199 [debug] [MainThread]: Command `dbt run` failed at 23:23:08.832150 after 1.28 seconds
[0m23:23:08.832423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083e4a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b153c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b1729e0>]}
[0m23:23:08.832628 [debug] [MainThread]: Flushing usage events
[0m23:23:09.310859 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:23:32.816615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b809a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109499d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094996c0>]}


============================== 23:23:32.820003 | c9fd4c5a-bf51-4a34-8252-e2f39fc159e1 ==============================
[0m23:23:32.820003 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:23:32.820381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --models stg_facebook_ads stg_shopify_orders', 'send_anonymous_usage_stats': 'True'}
[0m23:23:33.759078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9fd4c5a-bf51-4a34-8252-e2f39fc159e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e808eb0>]}
[0m23:23:33.786738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9fd4c5a-bf51-4a34-8252-e2f39fc159e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10946efe0>]}
[0m23:23:33.787116 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m23:23:33.909494 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:23:33.979121 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:23:33.979371 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:23:33.982773 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.fact_tables
- models.intermatedbt.marts
- models.intermatedbt.staging
[0m23:23:33.999668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9fd4c5a-bf51-4a34-8252-e2f39fc159e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ef655a0>]}
[0m23:23:34.043948 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m23:23:34.045370 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m23:23:34.056398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9fd4c5a-bf51-4a34-8252-e2f39fc159e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ef04a60>]}
[0m23:23:34.056704 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m23:23:34.056887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9fd4c5a-bf51-4a34-8252-e2f39fc159e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ef04850>]}
[0m23:23:34.057647 [info ] [MainThread]: 
[0m23:23:34.057835 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:23:34.057984 [info ] [MainThread]: 
[0m23:23:34.058253 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:23:34.060437 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m23:23:34.060657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:34.622227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m23:23:34.623911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:23:35.031761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9fd4c5a-bf51-4a34-8252-e2f39fc159e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079452a0>]}
[0m23:23:35.033524 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:23:35.039483 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m23:23:35.040503 [info ] [Thread-1 (]: 1 of 2 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m23:23:35.041438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m23:23:35.042064 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m23:23:35.057118 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m23:23:35.058421 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m23:23:35.087280 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m23:23:35.088122 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    amount_spent AS ad_spend_usd,
    amount_spent * 0.85 AS ad_spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`raw.clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE amount_spent IS NOT NULL;


[0m23:23:35.088485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:35.543714 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:405f34bc-61bf-4106-97eb-ee369613ae6a&page=queryresults
[0m23:23:35.546131 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:405f34bc-61bf-4106-97eb-ee369613ae6a&page=queryresults
[0m23:23:35.555683 [debug] [Thread-1 (]: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m23:23:35.558999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9fd4c5a-bf51-4a34-8252-e2f39fc159e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079c7040>]}
[0m23:23:35.559993 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model order_ad_data.stg_facebook_ads ............ [[31mERROR[0m in 0.52s]
[0m23:23:35.560736 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m23:23:35.561225 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m23:23:35.561864 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_facebook_ads' to be skipped because of status 'error'.  Reason: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql.
[0m23:23:35.562534 [info ] [Thread-1 (]: 2 of 2 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m23:23:35.564010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m23:23:35.564474 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m23:23:35.569153 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m23:23:35.570299 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m23:23:35.573474 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m23:23:35.574536 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(created_at AS DATE) AS order_date,
    total_price AS total_amount_usd,
    total_price * 0.85 AS total_amount_eur,
    discount_code
FROM `atomic-sled-453015-g3`.`order_ad_data`.`raw.clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE order_status = 'completed';


[0m23:23:35.575071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:35.925762 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:009aa640-2b53-4b32-8c54-35fa494529da&page=queryresults
[0m23:23:35.926833 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:009aa640-2b53-4b32-8c54-35fa494529da&page=queryresults
[0m23:23:35.929611 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m23:23:35.930785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9fd4c5a-bf51-4a34-8252-e2f39fc159e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093eb820>]}
[0m23:23:35.932014 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 0.37s]
[0m23:23:35.933497 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m23:23:35.934439 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m23:23:35.935947 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:23:35.936815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:23:35.937361 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m23:23:35.937955 [info ] [MainThread]: 
[0m23:23:35.938441 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.88 seconds (1.88s).
[0m23:23:35.939616 [debug] [MainThread]: Command end result
[0m23:23:35.970349 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m23:23:35.972098 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m23:23:35.978066 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m23:23:35.978425 [info ] [MainThread]: 
[0m23:23:35.978762 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:23:35.979034 [info ] [MainThread]: 
[0m23:23:35.979359 [error] [MainThread]:   Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m23:23:35.979626 [info ] [MainThread]: 
[0m23:23:35.979915 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m23:23:35.980162 [info ] [MainThread]: 
[0m23:23:35.980520 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m23:23:35.983298 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.2035062, "process_in_blocks": "0", "process_kernel_time": 1.163795, "process_mem_max_rss": "210321408", "process_out_blocks": "0", "process_user_time": 2.373349}
[0m23:23:35.983801 [debug] [MainThread]: Command `dbt run` failed at 23:23:35.983726 after 3.20 seconds
[0m23:23:35.984143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b809a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10946efe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093eb3d0>]}
[0m23:23:35.984470 [debug] [MainThread]: Flushing usage events
[0m23:23:36.412867 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:26:48.443789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107880940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121199e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121199750>]}


============================== 23:26:48.450293 | 49f134c7-7b4f-4360-857c-3a160c64b029 ==============================
[0m23:26:48.450293 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:26:48.450665 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_facebook_ads stg_shopify_orders', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:26:49.315495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49f134c7-7b4f-4360-857c-3a160c64b029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065619c0>]}
[0m23:26:49.343609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49f134c7-7b4f-4360-857c-3a160c64b029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120b90a00>]}
[0m23:26:49.344005 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m23:26:49.453242 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:26:49.528561 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:26:49.528822 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:26:49.532254 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.marts
- models.intermatedbt.staging
- models.intermatedbt.fact_tables
[0m23:26:49.549237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49f134c7-7b4f-4360-857c-3a160c64b029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1494653c0>]}
[0m23:26:49.594307 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m23:26:49.595720 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m23:26:49.607649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49f134c7-7b4f-4360-857c-3a160c64b029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14941f1c0>]}
[0m23:26:49.607964 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m23:26:49.608148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49f134c7-7b4f-4360-857c-3a160c64b029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1494670d0>]}
[0m23:26:49.608896 [info ] [MainThread]: 
[0m23:26:49.609084 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:26:49.609240 [info ] [MainThread]: 
[0m23:26:49.609508 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:26:49.611737 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m23:26:49.611957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:50.098402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m23:26:50.100001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:50.616635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49f134c7-7b4f-4360-857c-3a160c64b029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10718bfa0>]}
[0m23:26:50.618617 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:26:50.623792 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m23:26:50.624785 [info ] [Thread-1 (]: 1 of 2 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m23:26:50.625537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m23:26:50.626091 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m23:26:50.642252 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m23:26:50.643369 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m23:26:50.671414 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m23:26:50.672269 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    amount_spent AS ad_spend_usd,
    amount_spent * 0.85 AS ad_spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`raw.clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE amount_spent IS NOT NULL;


[0m23:26:50.672653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:51.128532 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:71de6c48-53c9-4b2d-af11-3561e1d2f87a&page=queryresults
[0m23:26:51.130828 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:71de6c48-53c9-4b2d-af11-3561e1d2f87a&page=queryresults
[0m23:26:51.140261 [debug] [Thread-1 (]: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m23:26:51.143315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49f134c7-7b4f-4360-857c-3a160c64b029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c3040>]}
[0m23:26:51.144435 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model order_ad_data.stg_facebook_ads ............ [[31mERROR[0m in 0.52s]
[0m23:26:51.145370 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m23:26:51.145986 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m23:26:51.148521 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_facebook_ads' to be skipped because of status 'error'.  Reason: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql.
[0m23:26:51.149333 [info ] [Thread-1 (]: 2 of 2 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m23:26:51.150826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m23:26:51.151307 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m23:26:51.155527 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m23:26:51.156553 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m23:26:51.159615 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m23:26:51.160520 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(created_at AS DATE) AS order_date,
    total_price AS total_amount_usd,
    total_price * 0.85 AS total_amount_eur,
    discount_code
FROM `atomic-sled-453015-g3`.`order_ad_data`.`raw.clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE order_status = 'completed';


[0m23:26:51.160996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:51.532796 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:e70eecbc-72d6-4e0c-8cab-42ba4ea44589&page=queryresults
[0m23:26:51.535794 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:e70eecbc-72d6-4e0c-8cab-42ba4ea44589&page=queryresults
[0m23:26:51.539019 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m23:26:51.540006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49f134c7-7b4f-4360-857c-3a160c64b029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1493e4e50>]}
[0m23:26:51.541122 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 0.39s]
[0m23:26:51.542017 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m23:26:51.542808 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m23:26:51.544292 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:26:51.545080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:26:51.545477 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m23:26:51.545978 [info ] [MainThread]: 
[0m23:26:51.546399 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.94 seconds (1.94s).
[0m23:26:51.547417 [debug] [MainThread]: Command end result
[0m23:26:51.578650 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m23:26:51.580336 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m23:26:51.586021 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m23:26:51.586378 [info ] [MainThread]: 
[0m23:26:51.586750 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:26:51.587045 [info ] [MainThread]: 
[0m23:26:51.587403 [error] [MainThread]:   Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m23:26:51.587695 [info ] [MainThread]: 
[0m23:26:51.588020 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m23:26:51.588297 [info ] [MainThread]: 
[0m23:26:51.588589 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m23:26:51.591214 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.1887197, "process_in_blocks": "0", "process_kernel_time": 0.990241, "process_mem_max_rss": "210255872", "process_out_blocks": "0", "process_user_time": 2.510552}
[0m23:26:51.591595 [debug] [MainThread]: Command `dbt run` failed at 23:26:51.591530 after 3.19 seconds
[0m23:26:51.591906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107880940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120b90a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107914520>]}
[0m23:26:51.592217 [debug] [MainThread]: Flushing usage events
[0m23:26:52.057851 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:27:01.776949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057189a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106569d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065696c0>]}


============================== 23:27:01.780079 | 42616250-e0aa-4c9c-9ae2-238df9c8d26a ==============================
[0m23:27:01.780079 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:27:01.780417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:27:02.615594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42616250-e0aa-4c9c-9ae2-238df9c8d26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ec14190>]}
[0m23:27:02.644916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42616250-e0aa-4c9c-9ae2-238df9c8d26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10653efe0>]}
[0m23:27:02.645386 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m23:27:02.753886 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:27:02.826820 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:27:02.827113 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:27:02.830504 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.staging
- models.intermatedbt.fact_tables
- models.intermatedbt.marts
[0m23:27:02.848541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42616250-e0aa-4c9c-9ae2-238df9c8d26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f171510>]}
[0m23:27:02.893515 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m23:27:02.894829 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m23:27:02.906624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42616250-e0aa-4c9c-9ae2-238df9c8d26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f12b100>]}
[0m23:27:02.906987 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m23:27:02.907190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42616250-e0aa-4c9c-9ae2-238df9c8d26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f173340>]}
[0m23:27:02.908124 [info ] [MainThread]: 
[0m23:27:02.908340 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:27:02.908501 [info ] [MainThread]: 
[0m23:27:02.908790 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:27:02.911249 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m23:27:02.911507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:03.416821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m23:27:03.418212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:27:03.707191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42616250-e0aa-4c9c-9ae2-238df9c8d26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10653c760>]}
[0m23:27:03.708507 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:27:03.713156 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m23:27:03.714091 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m23:27:03.714840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m23:27:03.715404 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m23:27:03.731197 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m23:27:03.732128 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m23:27:03.758731 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m23:27:03.760090 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    amount_spent AS ad_spend_usd,
    amount_spent * 0.85 AS ad_spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`raw.clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE amount_spent IS NOT NULL;


[0m23:27:03.760513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:04.231042 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:7bfcd0d3-a69c-4713-a388-eb9bcee54a72&page=queryresults
[0m23:27:04.232663 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:7bfcd0d3-a69c-4713-a388-eb9bcee54a72&page=queryresults
[0m23:27:04.242423 [debug] [Thread-1 (]: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m23:27:04.245489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42616250-e0aa-4c9c-9ae2-238df9c8d26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10555b040>]}
[0m23:27:04.246550 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model order_ad_data.stg_facebook_ads ............ [[31mERROR[0m in 0.53s]
[0m23:27:04.247465 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m23:27:04.248001 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m23:27:04.250401 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_facebook_ads' to be skipped because of status 'error'.  Reason: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql.
[0m23:27:04.251087 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m23:27:04.252632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m23:27:04.253141 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m23:27:04.257354 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m23:27:04.258257 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m23:27:04.261944 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m23:27:04.262924 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(created_at AS DATE) AS order_date,
    total_price AS total_amount_usd,
    total_price * 0.85 AS total_amount_eur,
    discount_code
FROM `atomic-sled-453015-g3`.`order_ad_data`.`raw.clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE order_status = 'completed';


[0m23:27:04.263398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:04.998011 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:e83d6afc-c4c6-414c-bc81-4f5269fae2ff&page=queryresults
[0m23:27:04.999572 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:e83d6afc-c4c6-414c-bc81-4f5269fae2ff&page=queryresults
[0m23:27:05.002434 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m23:27:05.003819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42616250-e0aa-4c9c-9ae2-238df9c8d26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f0f2f80>]}
[0m23:27:05.005293 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 0.75s]
[0m23:27:05.006301 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m23:27:05.007098 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m23:27:05.008380 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m23:27:05.009099 [info ] [Thread-1 (]: 3 of 6 SKIP relation order_ad_data.fact_new_customer_orders .................... [[33mSKIP[0m]
[0m23:27:05.009756 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m23:27:05.010685 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m23:27:05.011522 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m23:27:05.012174 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m23:27:05.012749 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m23:27:05.013396 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m23:27:05.014126 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m23:27:05.014745 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m23:27:05.015365 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m23:27:05.015858 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m23:27:05.017026 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:27:05.017797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:27:05.018240 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m23:27:05.019022 [info ] [MainThread]: 
[0m23:27:05.019467 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 2.11 seconds (2.11s).
[0m23:27:05.020648 [debug] [MainThread]: Command end result
[0m23:27:05.048337 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m23:27:05.050365 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m23:27:05.056081 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m23:27:05.056378 [info ] [MainThread]: 
[0m23:27:05.056692 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:27:05.056955 [info ] [MainThread]: 
[0m23:27:05.057269 [error] [MainThread]:   Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m23:27:05.057611 [info ] [MainThread]: 
[0m23:27:05.058001 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Invalid project ID 'atomic-sled-453015-g3.order_ad_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m23:27:05.058275 [info ] [MainThread]: 
[0m23:27:05.058534 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=4 TOTAL=6
[0m23:27:05.061066 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.3218217, "process_in_blocks": "0", "process_kernel_time": 1.163873, "process_mem_max_rss": "205832192", "process_out_blocks": "0", "process_user_time": 2.374155}
[0m23:27:05.061651 [debug] [MainThread]: Command `dbt run` failed at 23:27:05.061557 after 3.32 seconds
[0m23:27:05.062068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057189a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10653efe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057a1000>]}
[0m23:27:05.062363 [debug] [MainThread]: Flushing usage events
[0m23:27:05.488862 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:29:20.922833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106484850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d95f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d95870>]}


============================== 23:29:20.929660 | fd6188af-e95a-420c-a9e6-3d689c15a2e2 ==============================
[0m23:29:20.929660 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:29:20.930028 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:29:21.820514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd6188af-e95a-420c-a9e6-3d689c15a2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1274aff10>]}
[0m23:29:21.850615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd6188af-e95a-420c-a9e6-3d689c15a2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106521c30>]}
[0m23:29:21.851029 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m23:29:21.961012 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:29:22.036047 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:29:22.036638 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/sources.yml
[0m23:29:22.214174 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.fact_tables
- models.intermatedbt.marts
- models.intermatedbt.staging
[0m23:29:22.221143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd6188af-e95a-420c-a9e6-3d689c15a2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127dc46a0>]}
[0m23:29:22.263121 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m23:29:22.264528 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m23:29:22.274939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd6188af-e95a-420c-a9e6-3d689c15a2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127ddf070>]}
[0m23:29:22.275231 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m23:29:22.275417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd6188af-e95a-420c-a9e6-3d689c15a2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107acbd00>]}
[0m23:29:22.276354 [info ] [MainThread]: 
[0m23:29:22.276552 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:29:22.276706 [info ] [MainThread]: 
[0m23:29:22.276975 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:29:22.279379 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m23:29:22.279619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:22.948210 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m23:29:22.949691 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:29:23.288780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd6188af-e95a-420c-a9e6-3d689c15a2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f98790>]}
[0m23:29:23.290332 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:29:23.295062 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m23:29:23.295984 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m23:29:23.296730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m23:29:23.297308 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m23:29:23.310619 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m23:29:23.311961 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m23:29:23.340738 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m23:29:23.341709 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    amount_spent AS ad_spend_usd,
    amount_spent * 0.85 AS ad_spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE amount_spent IS NOT NULL;


[0m23:29:23.342123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:23.903096 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:cf244779-cc32-4f7e-9056-40d4be715d58&page=queryresults
[0m23:29:24.213719 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:cf244779-cc32-4f7e-9056-40d4be715d58&page=queryresults
[0m23:29:24.223598 [debug] [Thread-1 (]: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Table atomic-sled-453015-g3.order_ad_data.clean_facebook_ads does not have a schema.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m23:29:24.227028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd6188af-e95a-420c-a9e6-3d689c15a2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127a06590>]}
[0m23:29:24.228112 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model order_ad_data.stg_facebook_ads ............ [[31mERROR[0m in 0.93s]
[0m23:29:24.229019 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m23:29:24.229621 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m23:29:24.230330 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_facebook_ads' to be skipped because of status 'error'.  Reason: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Table atomic-sled-453015-g3.order_ad_data.clean_facebook_ads does not have a schema.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql.
[0m23:29:24.230965 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m23:29:24.232449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m23:29:24.232953 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m23:29:24.237412 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m23:29:24.238404 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m23:29:24.241961 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m23:29:24.243063 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(created_at AS DATE) AS order_date,
    total_price AS total_amount_usd,
    total_price * 0.85 AS total_amount_eur,
    discount_code
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE order_status = 'completed';


[0m23:29:24.243555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:24.819936 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:7b8ed9e4-e421-4edd-bf64-8f211de1f0b9&page=queryresults
[0m23:29:25.047421 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:7b8ed9e4-e421-4edd-bf64-8f211de1f0b9&page=queryresults
[0m23:29:25.051502 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Table atomic-sled-453015-g3.order_ad_data.clean_shopify_orders does not have a schema.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m23:29:25.052834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd6188af-e95a-420c-a9e6-3d689c15a2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130b2cd30>]}
[0m23:29:25.054174 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 0.82s]
[0m23:29:25.055557 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m23:29:25.056563 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Table atomic-sled-453015-g3.order_ad_data.clean_shopify_orders does not have a schema.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m23:29:25.057784 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m23:29:25.058745 [info ] [Thread-1 (]: 3 of 6 SKIP relation order_ad_data.fact_new_customer_orders .................... [[33mSKIP[0m]
[0m23:29:25.059584 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m23:29:25.060653 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m23:29:25.061275 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m23:29:25.061905 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m23:29:25.062480 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m23:29:25.063174 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m23:29:25.063850 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m23:29:25.064439 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m23:29:25.065093 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m23:29:25.065737 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m23:29:25.066868 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:29:25.067585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:29:25.067952 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m23:29:25.068445 [info ] [MainThread]: 
[0m23:29:25.068838 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 2.79 seconds (2.79s).
[0m23:29:25.069919 [debug] [MainThread]: Command end result
[0m23:29:25.098444 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m23:29:25.099981 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m23:29:25.105530 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m23:29:25.105814 [info ] [MainThread]: 
[0m23:29:25.106121 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:29:25.106374 [info ] [MainThread]: 
[0m23:29:25.106675 [error] [MainThread]:   Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Table atomic-sled-453015-g3.order_ad_data.clean_facebook_ads does not have a schema.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m23:29:25.106916 [info ] [MainThread]: 
[0m23:29:25.107196 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Table atomic-sled-453015-g3.order_ad_data.clean_shopify_orders does not have a schema.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m23:29:25.107412 [info ] [MainThread]: 
[0m23:29:25.107638 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=4 TOTAL=6
[0m23:29:25.110049 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.2290034, "process_in_blocks": "0", "process_kernel_time": 1.123734, "process_mem_max_rss": "217481216", "process_out_blocks": "0", "process_user_time": 2.596509}
[0m23:29:25.110401 [debug] [MainThread]: Command `dbt run` failed at 23:29:25.110340 after 4.23 seconds
[0m23:29:25.110697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106484850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106522d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130a35bd0>]}
[0m23:29:25.110978 [debug] [MainThread]: Flushing usage events
[0m23:29:25.586818 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:40:29.834182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103abc910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10490de40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10490d780>]}


============================== 23:40:29.839969 | 6e208940-2ac2-4240-ad2e-a074db0ec995 ==============================
[0m23:40:29.839969 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:40:29.840340 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:40:30.713715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e208940-2ac2-4240-ad2e-a074db0ec995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102aad990>]}
[0m23:40:30.743528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e208940-2ac2-4240-ad2e-a074db0ec995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a2a9150>]}
[0m23:40:30.743984 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m23:40:30.856638 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:40:30.934503 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:40:30.934908 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/sources.yml
[0m23:40:30.980999 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.fact_tables
- models.intermatedbt.marts
- models.intermatedbt.staging
[0m23:40:30.988387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e208940-2ac2-4240-ad2e-a074db0ec995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a381a80>]}
[0m23:40:31.031982 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m23:40:31.033250 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m23:40:31.043994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e208940-2ac2-4240-ad2e-a074db0ec995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a8c8760>]}
[0m23:40:31.044313 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m23:40:31.044494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e208940-2ac2-4240-ad2e-a074db0ec995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a8c9cc0>]}
[0m23:40:31.045408 [info ] [MainThread]: 
[0m23:40:31.045600 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:40:31.045754 [info ] [MainThread]: 
[0m23:40:31.046020 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:40:31.048367 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m23:40:31.048594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:40:31.614872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m23:40:31.616029 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:40:31.949449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e208940-2ac2-4240-ad2e-a074db0ec995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10290e6b0>]}
[0m23:40:31.950177 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:40:31.953938 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m23:40:31.954641 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m23:40:31.955377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m23:40:31.955810 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m23:40:31.965186 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m23:40:31.966195 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m23:40:31.990656 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m23:40:31.991599 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    amount_spent AS ad_spend_usd,
    amount_spent * 0.85 AS ad_spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE amount_spent IS NOT NULL;


[0m23:40:31.991947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:32.817023 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:60d7701f-fd08-4daf-870e-f221aba6b9c4&page=queryresults
[0m23:40:33.089958 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:60d7701f-fd08-4daf-870e-f221aba6b9c4&page=queryresults
[0m23:40:33.100406 [debug] [Thread-1 (]: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Table atomic-sled-453015-g3.order_ad_data.clean_facebook_ads does not have a schema.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m23:40:33.103814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e208940-2ac2-4240-ad2e-a074db0ec995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b53820>]}
[0m23:40:33.104871 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model order_ad_data.stg_facebook_ads ............ [[31mERROR[0m in 1.15s]
[0m23:40:33.105761 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m23:40:33.106375 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m23:40:33.107044 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_facebook_ads' to be skipped because of status 'error'.  Reason: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Table atomic-sled-453015-g3.order_ad_data.clean_facebook_ads does not have a schema.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql.
[0m23:40:33.107721 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m23:40:33.109748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m23:40:33.110248 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m23:40:33.114521 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m23:40:33.115513 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m23:40:33.118641 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m23:40:33.119701 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(created_at AS DATE) AS order_date,
    total_price AS total_amount_usd,
    total_price * 0.85 AS total_amount_eur,
    discount_code
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE order_status = 'completed';


[0m23:40:33.120213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:33.911715 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:a0b54c46-c715-42c1-8c65-68e793e09aba&page=queryresults
[0m23:40:34.131901 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:a0b54c46-c715-42c1-8c65-68e793e09aba&page=queryresults
[0m23:40:34.136626 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Table atomic-sled-453015-g3.order_ad_data.clean_shopify_orders does not have a schema.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m23:40:34.138029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e208940-2ac2-4240-ad2e-a074db0ec995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13abe32e0>]}
[0m23:40:34.139452 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 1.03s]
[0m23:40:34.140889 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m23:40:34.141656 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Table atomic-sled-453015-g3.order_ad_data.clean_shopify_orders does not have a schema.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m23:40:34.142693 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m23:40:34.143591 [info ] [Thread-1 (]: 3 of 6 SKIP relation order_ad_data.fact_new_customer_orders .................... [[33mSKIP[0m]
[0m23:40:34.144240 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m23:40:34.145193 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m23:40:34.145880 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m23:40:34.146685 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m23:40:34.147311 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m23:40:34.147965 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m23:40:34.148574 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m23:40:34.149117 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m23:40:34.149739 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m23:40:34.150399 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m23:40:34.151612 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:40:34.152324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:40:34.152690 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m23:40:34.153176 [info ] [MainThread]: 
[0m23:40:34.153572 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 3.11 seconds (3.11s).
[0m23:40:34.154609 [debug] [MainThread]: Command end result
[0m23:40:34.180435 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m23:40:34.182072 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m23:40:34.187470 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m23:40:34.187770 [info ] [MainThread]: 
[0m23:40:34.188089 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:40:34.188349 [info ] [MainThread]: 
[0m23:40:34.188650 [error] [MainThread]:   Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Table atomic-sled-453015-g3.order_ad_data.clean_facebook_ads does not have a schema.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m23:40:34.188892 [info ] [MainThread]: 
[0m23:40:34.189171 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Table atomic-sled-453015-g3.order_ad_data.clean_shopify_orders does not have a schema.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m23:40:34.189408 [info ] [MainThread]: 
[0m23:40:34.189661 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=4 TOTAL=6
[0m23:40:34.192170 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.3979573, "process_in_blocks": "0", "process_kernel_time": 0.999967, "process_mem_max_rss": "211746816", "process_out_blocks": "0", "process_user_time": 2.561084}
[0m23:40:34.192565 [debug] [MainThread]: Command `dbt run` failed at 23:40:34.192497 after 4.40 seconds
[0m23:40:34.192874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103abc910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102aad990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a667df0>]}
[0m23:40:34.193159 [debug] [MainThread]: Flushing usage events
[0m23:40:35.985000 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:41:53.094611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106330970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c95e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c95750>]}


============================== 23:41:53.100893 | c642aa70-ece6-4461-aa8d-746ad95b3707 ==============================
[0m23:41:53.100893 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:41:53.101235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'profiles_dir': '/Users/victoruwaje/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:41:54.069106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c642aa70-ece6-4461-aa8d-746ad95b3707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14520a680>]}
[0m23:41:54.097919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c642aa70-ece6-4461-aa8d-746ad95b3707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6afb0>]}
[0m23:41:54.098358 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m23:41:54.210108 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:41:54.286322 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:41:54.286589 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:41:54.290001 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.marts
- models.intermatedbt.staging
- models.intermatedbt.fact_tables
[0m23:41:54.307219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c642aa70-ece6-4461-aa8d-746ad95b3707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1458655a0>]}
[0m23:41:54.351346 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m23:41:54.352620 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m23:41:54.363598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c642aa70-ece6-4461-aa8d-746ad95b3707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145822740>]}
[0m23:41:54.363933 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m23:41:54.364116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c642aa70-ece6-4461-aa8d-746ad95b3707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1458225c0>]}
[0m23:41:54.365002 [info ] [MainThread]: 
[0m23:41:54.365201 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:41:54.365356 [info ] [MainThread]: 
[0m23:41:54.365630 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:41:54.367975 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m23:41:54.368197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:55.120538 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m23:41:55.122154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:41:55.520283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c642aa70-ece6-4461-aa8d-746ad95b3707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105db7fa0>]}
[0m23:41:55.521645 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:41:55.525892 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m23:41:55.526677 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m23:41:55.527056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m23:41:55.527271 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m23:41:55.534204 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m23:41:55.534899 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m23:41:55.551408 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m23:41:55.552112 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    amount_spent AS ad_spend_usd,
    amount_spent * 0.85 AS ad_spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE amount_spent IS NOT NULL;


[0m23:41:55.552397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:56.130197 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:cc980265-764a-4cc5-8894-7ec1c96bf3fd&page=queryresults
[0m23:41:56.131213 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:cc980265-764a-4cc5-8894-7ec1c96bf3fd&page=queryresults
[0m23:41:56.139512 [debug] [Thread-1 (]: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_facebook_ads was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m23:41:56.140936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c642aa70-ece6-4461-aa8d-746ad95b3707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106173040>]}
[0m23:41:56.141434 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model order_ad_data.stg_facebook_ads ............ [[31mERROR[0m in 0.61s]
[0m23:41:56.142224 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m23:41:56.142514 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m23:41:56.142803 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_facebook_ads' to be skipped because of status 'error'.  Reason: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_facebook_ads was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql.
[0m23:41:56.143082 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m23:41:56.144806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m23:41:56.145111 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m23:41:56.147051 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m23:41:56.147663 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m23:41:56.150105 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m23:41:56.151212 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(created_at AS DATE) AS order_date,
    total_price AS total_amount_usd,
    total_price * 0.85 AS total_amount_eur,
    discount_code
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE order_status = 'completed';


[0m23:41:56.151529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:56.635529 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:4e391d94-910a-4aec-a87b-4b88f82ed2bf&page=queryresults
[0m23:41:56.636496 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:4e391d94-910a-4aec-a87b-4b88f82ed2bf&page=queryresults
[0m23:41:56.639147 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_shopify_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m23:41:56.640098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c642aa70-ece6-4461-aa8d-746ad95b3707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1457e6ef0>]}
[0m23:41:56.641207 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 0.50s]
[0m23:41:56.642545 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m23:41:56.643401 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_shopify_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m23:41:56.644211 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m23:41:56.644567 [info ] [Thread-1 (]: 3 of 6 SKIP relation order_ad_data.fact_new_customer_orders .................... [[33mSKIP[0m]
[0m23:41:56.644835 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m23:41:56.645462 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m23:41:56.645680 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m23:41:56.645905 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m23:41:56.646100 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m23:41:56.646366 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m23:41:56.646736 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m23:41:56.647132 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m23:41:56.647462 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m23:41:56.647685 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m23:41:56.648382 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:41:56.648800 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:41:56.648983 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m23:41:56.649230 [info ] [MainThread]: 
[0m23:41:56.649423 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 2.28 seconds (2.28s).
[0m23:41:56.649948 [debug] [MainThread]: Command end result
[0m23:41:56.664153 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m23:41:56.665339 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m23:41:56.669684 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m23:41:56.669958 [info ] [MainThread]: 
[0m23:41:56.670183 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:41:56.670362 [info ] [MainThread]: 
[0m23:41:56.670574 [error] [MainThread]:   Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_facebook_ads was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m23:41:56.670741 [info ] [MainThread]: 
[0m23:41:56.670929 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_shopify_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m23:41:56.671089 [info ] [MainThread]: 
[0m23:41:56.671299 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=4 TOTAL=6
[0m23:41:56.673131 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.6192188, "process_in_blocks": "0", "process_kernel_time": 0.984396, "process_mem_max_rss": "208715776", "process_out_blocks": "0", "process_user_time": 2.592275}
[0m23:41:56.673490 [debug] [MainThread]: Command `dbt run` failed at 23:41:56.673431 after 3.62 seconds
[0m23:41:56.673737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106330970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6afb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c43a0>]}
[0m23:41:56.673960 [debug] [MainThread]: Flushing usage events
[0m23:41:57.627138 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:44:51.284744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062108b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107061ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070617e0>]}


============================== 23:44:51.292405 | 22c07aa1-81c7-47dc-9c7b-a225efebfb41 ==============================
[0m23:44:51.292405 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:44:51.292806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:44:52.258643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22c07aa1-81c7-47dc-9c7b-a225efebfb41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144a3e2f0>]}
[0m23:44:52.287813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22c07aa1-81c7-47dc-9c7b-a225efebfb41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b2aa40>]}
[0m23:44:52.288252 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m23:44:52.398181 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:44:52.475860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:44:52.476164 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:44:52.479759 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.fact_tables
- models.intermatedbt.staging
- models.intermatedbt.marts
[0m23:44:52.497899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22c07aa1-81c7-47dc-9c7b-a225efebfb41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1450654b0>]}
[0m23:44:52.542139 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m23:44:52.543328 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m23:44:52.554416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22c07aa1-81c7-47dc-9c7b-a225efebfb41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145005b10>]}
[0m23:44:52.554731 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m23:44:52.554915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22c07aa1-81c7-47dc-9c7b-a225efebfb41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145004700>]}
[0m23:44:52.555786 [info ] [MainThread]: 
[0m23:44:52.556057 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:44:52.556247 [info ] [MainThread]: 
[0m23:44:52.556531 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:44:52.559102 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m23:44:52.559479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:44:53.087776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m23:44:53.088972 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:44:53.401293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22c07aa1-81c7-47dc-9c7b-a225efebfb41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107034670>]}
[0m23:44:53.402706 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:44:53.408109 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m23:44:53.409094 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m23:44:53.409937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m23:44:53.410514 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m23:44:53.426899 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m23:44:53.428183 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m23:44:53.456590 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m23:44:53.457505 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    amount_spent AS ad_spend_usd,
    amount_spent * 0.85 AS ad_spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE amount_spent IS NOT NULL;


[0m23:44:53.457912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:54.251748 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:d6f5db31-4ea7-470b-af7e-56edd3c53823&page=queryresults
[0m23:44:54.521540 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:d6f5db31-4ea7-470b-af7e-56edd3c53823&page=queryresults
[0m23:44:54.531297 [debug] [Thread-1 (]: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Table atomic-sled-453015-g3.order_ad_data.clean_facebook_ads does not have a schema.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m23:44:54.534600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22c07aa1-81c7-47dc-9c7b-a225efebfb41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144b83730>]}
[0m23:44:54.535779 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model order_ad_data.stg_facebook_ads ............ [[31mERROR[0m in 1.12s]
[0m23:44:54.538822 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m23:44:54.539446 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m23:44:54.540082 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_facebook_ads' to be skipped because of status 'error'.  Reason: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Table atomic-sled-453015-g3.order_ad_data.clean_facebook_ads does not have a schema.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql.
[0m23:44:54.540781 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m23:44:54.542622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m23:44:54.543154 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m23:44:54.547518 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m23:44:54.548761 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m23:44:54.552358 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m23:44:54.553435 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(created_at AS DATE) AS order_date,
    total_price AS total_amount_usd,
    total_price * 0.85 AS total_amount_eur,
    discount_code
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE order_status = 'completed';


[0m23:44:54.553907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:55.134801 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:c3e86703-b302-4b9f-a8ac-56d4f8c029ad&page=queryresults
[0m23:44:55.373599 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:c3e86703-b302-4b9f-a8ac-56d4f8c029ad&page=queryresults
[0m23:44:55.378554 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Table atomic-sled-453015-g3.order_ad_data.clean_shopify_orders does not have a schema.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m23:44:55.380016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22c07aa1-81c7-47dc-9c7b-a225efebfb41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1450640d0>]}
[0m23:44:55.381537 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 0.84s]
[0m23:44:55.382490 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m23:44:55.383242 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Table atomic-sled-453015-g3.order_ad_data.clean_shopify_orders does not have a schema.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m23:44:55.384416 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m23:44:55.385340 [info ] [Thread-1 (]: 3 of 6 SKIP relation order_ad_data.fact_new_customer_orders .................... [[33mSKIP[0m]
[0m23:44:55.386032 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m23:44:55.387054 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m23:44:55.387825 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m23:44:55.388543 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m23:44:55.389165 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m23:44:55.389866 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m23:44:55.390483 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m23:44:55.391017 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m23:44:55.391542 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m23:44:55.392079 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m23:44:55.393290 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:44:55.394088 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:44:55.394512 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m23:44:55.395039 [info ] [MainThread]: 
[0m23:44:55.395458 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m23:44:55.396554 [debug] [MainThread]: Command end result
[0m23:44:55.423961 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m23:44:55.426136 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m23:44:55.431584 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m23:44:55.431890 [info ] [MainThread]: 
[0m23:44:55.432211 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:44:55.432469 [info ] [MainThread]: 
[0m23:44:55.432775 [error] [MainThread]:   Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Table atomic-sled-453015-g3.order_ad_data.clean_facebook_ads does not have a schema.
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m23:44:55.433024 [info ] [MainThread]: 
[0m23:44:55.433307 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Table atomic-sled-453015-g3.order_ad_data.clean_shopify_orders does not have a schema.
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m23:44:55.433547 [info ] [MainThread]: 
[0m23:44:55.433799 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=4 TOTAL=6
[0m23:44:55.436261 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.195944, "process_in_blocks": "0", "process_kernel_time": 1.131617, "process_mem_max_rss": "203145216", "process_out_blocks": "0", "process_user_time": 2.310023}
[0m23:44:55.436632 [debug] [MainThread]: Command `dbt run` failed at 23:44:55.436570 after 4.20 seconds
[0m23:44:55.436947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062108b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b2aa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144ab6d40>]}
[0m23:44:55.437240 [debug] [MainThread]: Flushing usage events
[0m23:44:55.912305 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:51:40.787183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c80910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107295e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107295780>]}


============================== 23:51:40.793629 | 3327e65b-a0c0-4f9e-8b1b-927a81102622 ==============================
[0m23:51:40.793629 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:51:40.793994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:51:41.699866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3327e65b-a0c0-4f9e-8b1b-927a81102622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102461990>]}
[0m23:51:41.728220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3327e65b-a0c0-4f9e-8b1b-927a81102622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14aaa9150>]}
[0m23:51:41.728632 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m23:51:41.844461 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:51:41.928367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:51:41.928638 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:51:41.932021 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.staging
- models.intermatedbt.marts
- models.intermatedbt.fact_tables
[0m23:51:41.949613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3327e65b-a0c0-4f9e-8b1b-927a81102622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b067fa0>]}
[0m23:51:41.993568 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m23:51:41.994896 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m23:51:42.006177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3327e65b-a0c0-4f9e-8b1b-927a81102622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b023190>]}
[0m23:51:42.006504 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m23:51:42.006691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3327e65b-a0c0-4f9e-8b1b-927a81102622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b067100>]}
[0m23:51:42.007579 [info ] [MainThread]: 
[0m23:51:42.007775 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:51:42.007929 [info ] [MainThread]: 
[0m23:51:42.008198 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:51:42.010750 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m23:51:42.011045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:42.612981 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m23:51:42.613495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:42.928116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3327e65b-a0c0-4f9e-8b1b-927a81102622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fb7fa0>]}
[0m23:51:42.929167 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:51:42.934106 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m23:51:42.935117 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m23:51:42.935960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m23:51:42.936555 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m23:51:42.952537 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m23:51:42.953940 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m23:51:42.984325 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m23:51:42.985207 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    amount_spent AS ad_spend_usd,
    amount_spent * 0.85 AS ad_spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE amount_spent IS NOT NULL;


[0m23:51:42.985561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:43.742691 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:41ff2ae7-9f75-4c55-ad13-f1ccf6bdc617&page=queryresults
[0m23:51:43.951818 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:41ff2ae7-9f75-4c55-ad13-f1ccf6bdc617&page=queryresults
[0m23:51:43.961519 [debug] [Thread-1 (]: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Unrecognized name: amount_spent at [16:7]
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m23:51:43.964652 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3327e65b-a0c0-4f9e-8b1b-927a81102622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b0055d0>]}
[0m23:51:43.965794 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model order_ad_data.stg_facebook_ads ............ [[31mERROR[0m in 1.03s]
[0m23:51:43.968890 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m23:51:43.969509 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m23:51:43.970194 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_facebook_ads' to be skipped because of status 'error'.  Reason: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Unrecognized name: amount_spent at [16:7]
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql.
[0m23:51:43.970999 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m23:51:43.972440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m23:51:43.972937 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m23:51:43.977131 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m23:51:43.978138 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m23:51:43.981669 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m23:51:43.982992 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(created_at AS DATE) AS order_date,
    total_price AS total_amount_usd,
    total_price * 0.85 AS total_amount_eur,
    discount_code
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE order_status = 'completed';


[0m23:51:43.983521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:44.529950 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:5143d580-8f76-4a41-a939-1bb85d050657&page=queryresults
[0m23:51:44.754279 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:5143d580-8f76-4a41-a939-1bb85d050657&page=queryresults
[0m23:51:44.758413 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Unrecognized name: order_status; Did you mean order_date? at [16:7]
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m23:51:44.759644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3327e65b-a0c0-4f9e-8b1b-927a81102622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14afe7460>]}
[0m23:51:44.761169 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 0.79s]
[0m23:51:44.762083 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m23:51:44.762813 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Unrecognized name: order_status; Did you mean order_date? at [16:7]
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m23:51:44.763954 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m23:51:44.764711 [info ] [Thread-1 (]: 3 of 6 SKIP relation order_ad_data.fact_new_customer_orders .................... [[33mSKIP[0m]
[0m23:51:44.765482 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m23:51:44.766674 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m23:51:44.767269 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m23:51:44.767868 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m23:51:44.768412 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m23:51:44.769020 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m23:51:44.769613 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m23:51:44.770142 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m23:51:44.770792 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m23:51:44.771390 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m23:51:44.772548 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:51:44.774008 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:51:44.774405 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m23:51:44.774906 [info ] [MainThread]: 
[0m23:51:44.775319 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 2.77 seconds (2.77s).
[0m23:51:44.776538 [debug] [MainThread]: Command end result
[0m23:51:44.805209 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m23:51:44.806939 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m23:51:44.812844 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m23:51:44.813176 [info ] [MainThread]: 
[0m23:51:44.813492 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:51:44.813751 [info ] [MainThread]: 
[0m23:51:44.814056 [error] [MainThread]:   Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Unrecognized name: amount_spent at [16:7]
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m23:51:44.814304 [info ] [MainThread]: 
[0m23:51:44.814573 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Unrecognized name: order_status; Did you mean order_date? at [16:7]
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m23:51:44.814783 [info ] [MainThread]: 
[0m23:51:44.815010 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=4 TOTAL=6
[0m23:51:44.817269 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.072363, "process_in_blocks": "0", "process_kernel_time": 1.316373, "process_mem_max_rss": "206585856", "process_out_blocks": "0", "process_user_time": 2.256101}
[0m23:51:44.817647 [debug] [MainThread]: Command `dbt run` failed at 23:51:44.817579 after 4.07 seconds
[0m23:51:44.817957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c80910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14aaf1f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d17820>]}
[0m23:51:44.818246 [debug] [MainThread]: Flushing usage events
[0m23:51:45.295569 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:12:45.932255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dd8940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109795e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109795750>]}


============================== 00:12:45.938748 | b40797dc-c0b1-4b73-a409-78147ecfebe8 ==============================
[0m00:12:45.938748 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:12:45.939141 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:12:46.881040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b40797dc-c0b1-4b73-a409-78147ecfebe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14730a470>]}
[0m00:12:46.910293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b40797dc-c0b1-4b73-a409-78147ecfebe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109023760>]}
[0m00:12:46.910873 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m00:12:47.021789 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:12:47.102154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:12:47.102571 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_shopify_orders.sql
[0m00:12:47.225371 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.marts
- models.intermatedbt.fact_tables
- models.intermatedbt.staging
[0m00:12:47.233151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b40797dc-c0b1-4b73-a409-78147ecfebe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14798beb0>]}
[0m00:12:47.276129 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m00:12:47.277368 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m00:12:47.288180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b40797dc-c0b1-4b73-a409-78147ecfebe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147905180>]}
[0m00:12:47.288486 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m00:12:47.288680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b40797dc-c0b1-4b73-a409-78147ecfebe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147adbb20>]}
[0m00:12:47.289703 [info ] [MainThread]: 
[0m00:12:47.289941 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:12:47.290100 [info ] [MainThread]: 
[0m00:12:47.290407 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:12:47.293683 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m00:12:47.294056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:47.884482 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m00:12:47.886005 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:12:48.212108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b40797dc-c0b1-4b73-a409-78147ecfebe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097686a0>]}
[0m00:12:48.213810 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:12:48.219448 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m00:12:48.220402 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m00:12:48.221354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m00:12:48.221967 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m00:12:48.234627 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m00:12:48.235676 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m00:12:48.264844 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m00:12:48.265743 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    amount_spent AS ad_spend_usd,
    amount_spent * 0.85 AS ad_spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE amount_spent IS NOT NULL;


[0m00:12:48.266134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:49.928799 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:4ebcd15d-1a7e-45ed-a7fa-9aec861a60e8&page=queryresults
[0m00:12:49.929847 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:4ebcd15d-1a7e-45ed-a7fa-9aec861a60e8&page=queryresults
[0m00:12:49.939588 [debug] [Thread-1 (]: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_facebook_ads was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m00:12:49.942966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b40797dc-c0b1-4b73-a409-78147ecfebe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1477e5300>]}
[0m00:12:49.943833 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model order_ad_data.stg_facebook_ads ............ [[31mERROR[0m in 1.72s]
[0m00:12:49.944436 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m00:12:49.944849 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m00:12:49.945397 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_facebook_ads' to be skipped because of status 'error'.  Reason: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_facebook_ads was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql.
[0m00:12:49.945965 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m00:12:49.950383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m00:12:49.950924 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m00:12:49.953968 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m00:12:49.954629 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m00:12:49.956807 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m00:12:49.957688 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(created_at AS DATE) AS order_date,
    total_price_eur,
    discount_code
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE order_status = 'completed';


[0m00:12:49.958055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:50.545489 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:fa7a98a3-ff89-455a-99e9-9bd50a00dc8e&page=queryresults
[0m00:12:50.781634 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:fa7a98a3-ff89-455a-99e9-9bd50a00dc8e&page=queryresults
[0m00:12:50.786502 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Unrecognized name: order_status; Did you mean order_date? at [15:7]
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m00:12:50.788285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b40797dc-c0b1-4b73-a409-78147ecfebe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1479b2b90>]}
[0m00:12:50.789885 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 0.84s]
[0m00:12:50.790971 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m00:12:50.791832 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Unrecognized name: order_status; Did you mean order_date? at [15:7]
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m00:12:50.793750 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m00:12:50.794607 [info ] [Thread-1 (]: 3 of 6 SKIP relation order_ad_data.fact_new_customer_orders .................... [[33mSKIP[0m]
[0m00:12:50.795306 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m00:12:50.796445 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m00:12:50.797088 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m00:12:50.797687 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m00:12:50.798229 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m00:12:50.798829 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m00:12:50.799399 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m00:12:50.799857 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m00:12:50.800318 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m00:12:50.801128 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m00:12:50.802507 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:12:50.803311 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:12:50.803715 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m00:12:50.804225 [info ] [MainThread]: 
[0m00:12:50.804646 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 3.51 seconds (3.51s).
[0m00:12:50.805732 [debug] [MainThread]: Command end result
[0m00:12:50.833395 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m00:12:50.834965 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m00:12:50.840420 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m00:12:50.840709 [info ] [MainThread]: 
[0m00:12:50.841013 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m00:12:50.841244 [info ] [MainThread]: 
[0m00:12:50.841527 [error] [MainThread]:   Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_facebook_ads was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m00:12:50.842012 [info ] [MainThread]: 
[0m00:12:50.842342 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Unrecognized name: order_status; Did you mean order_date? at [15:7]
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m00:12:50.842690 [info ] [MainThread]: 
[0m00:12:50.842965 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=4 TOTAL=6
[0m00:12:50.845970 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.956934, "process_in_blocks": "0", "process_kernel_time": 0.945836, "process_mem_max_rss": "209649664", "process_out_blocks": "0", "process_user_time": 2.558532}
[0m00:12:50.846440 [debug] [MainThread]: Command `dbt run` failed at 00:12:50.846370 after 4.96 seconds
[0m00:12:50.846762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dd8940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14730a470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1476245b0>]}
[0m00:12:50.847061 [debug] [MainThread]: Flushing usage events
[0m00:12:51.335295 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:15:57.587454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103208940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104059e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104059750>]}


============================== 00:15:57.597158 | b354ec02-1ced-4a7a-9897-3308e496b7a3 ==============================
[0m00:15:57.597158 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:15:57.597508 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/victoruwaje/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:15:58.544978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b354ec02-1ced-4a7a-9897-3308e496b7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11de09900>]}
[0m00:15:58.573740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b354ec02-1ced-4a7a-9897-3308e496b7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ae7760>]}
[0m00:15:58.574158 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m00:15:58.687596 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:15:58.764642 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:15:58.765042 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_shopify_orders.sql
[0m00:15:58.765263 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_facebook_ads.sql
[0m00:15:58.892697 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.fact_tables
- models.intermatedbt.marts
- models.intermatedbt.staging
[0m00:15:58.900737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b354ec02-1ced-4a7a-9897-3308e496b7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e5d52a0>]}
[0m00:15:58.944070 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m00:15:58.945262 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m00:15:58.956055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b354ec02-1ced-4a7a-9897-3308e496b7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e5aab90>]}
[0m00:15:58.956369 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m00:15:58.956558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b354ec02-1ced-4a7a-9897-3308e496b7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e5aae60>]}
[0m00:15:58.957499 [info ] [MainThread]: 
[0m00:15:58.957701 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:15:58.957859 [info ] [MainThread]: 
[0m00:15:58.958153 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:15:58.961263 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m00:15:58.961581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:15:59.437426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m00:15:59.439027 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:15:59.871492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b354ec02-1ced-4a7a-9897-3308e496b7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10402c6a0>]}
[0m00:15:59.873308 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:15:59.878247 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m00:15:59.879172 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m00:15:59.880121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m00:15:59.880754 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m00:15:59.894493 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m00:15:59.895788 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m00:15:59.924169 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m00:15:59.925558 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m00:15:59.925953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:00.482854 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:d8e4c458-97c9-418f-b64a-d51c412f9320&page=queryresults
[0m00:16:00.484552 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:d8e4c458-97c9-418f-b64a-d51c412f9320&page=queryresults
[0m00:16:00.494417 [debug] [Thread-1 (]: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_facebook_ads was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m00:16:00.497692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b354ec02-1ced-4a7a-9897-3308e496b7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e406fe0>]}
[0m00:16:00.498821 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model order_ad_data.stg_facebook_ads ............ [[31mERROR[0m in 0.62s]
[0m00:16:00.499757 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m00:16:00.500324 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m00:16:00.501095 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_facebook_ads' to be skipped because of status 'error'.  Reason: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_facebook_ads was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql.
[0m00:16:00.501740 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m00:16:00.505023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m00:16:00.505489 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m00:16:00.509662 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m00:16:00.510619 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m00:16:00.514055 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m00:16:00.515030 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(created_at AS DATE) AS order_date,
    total_price_eur,
    discount_code
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE status = 'completed';


[0m00:16:00.515483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:01.109013 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:fa6b1c49-874d-4f09-9751-193cbfca5840&page=queryresults
[0m00:16:01.402221 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:fa6b1c49-874d-4f09-9751-193cbfca5840&page=queryresults
[0m00:16:01.406878 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Unrecognized name: status at [15:7]
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m00:16:01.408562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b354ec02-1ced-4a7a-9897-3308e496b7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e493c40>]}
[0m00:16:01.409847 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 0.90s]
[0m00:16:01.410878 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m00:16:01.411902 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Unrecognized name: status at [15:7]
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m00:16:01.413062 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m00:16:01.413780 [info ] [Thread-1 (]: 3 of 6 SKIP relation order_ad_data.fact_new_customer_orders .................... [[33mSKIP[0m]
[0m00:16:01.414449 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m00:16:01.415649 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m00:16:01.416322 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m00:16:01.416969 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m00:16:01.417539 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m00:16:01.418214 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m00:16:01.418861 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m00:16:01.419475 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m00:16:01.420041 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m00:16:01.420552 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m00:16:01.421722 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:16:01.422521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:16:01.422923 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m00:16:01.423437 [info ] [MainThread]: 
[0m00:16:01.423853 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 2.47 seconds (2.47s).
[0m00:16:01.424949 [debug] [MainThread]: Command end result
[0m00:16:01.452881 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m00:16:01.454366 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m00:16:01.459981 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m00:16:01.460275 [info ] [MainThread]: 
[0m00:16:01.460592 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m00:16:01.460851 [info ] [MainThread]: 
[0m00:16:01.461129 [error] [MainThread]:   Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_facebook_ads was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m00:16:01.461355 [info ] [MainThread]: 
[0m00:16:01.461600 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Unrecognized name: status at [15:7]
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m00:16:01.461812 [info ] [MainThread]: 
[0m00:16:01.462043 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=4 TOTAL=6
[0m00:16:01.464530 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.924129, "process_in_blocks": "0", "process_kernel_time": 0.899702, "process_mem_max_rss": "210567168", "process_out_blocks": "0", "process_user_time": 2.743093}
[0m00:16:01.464952 [debug] [MainThread]: Command `dbt run` failed at 00:16:01.464881 after 3.92 seconds
[0m00:16:01.465255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103208940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ae7760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10329c520>]}
[0m00:16:01.465568 [debug] [MainThread]: Flushing usage events
[0m00:16:01.926310 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:16:25.763191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ba48e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049f5e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049f57b0>]}


============================== 00:16:25.771470 | dffb4781-9eaf-469d-be5f-be758158489f ==============================
[0m00:16:25.771470 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:16:25.771832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:16:26.680549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dffb4781-9eaf-469d-be5f-be758158489f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130e0b610>]}
[0m00:16:26.711913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dffb4781-9eaf-469d-be5f-be758158489f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10482ba30>]}
[0m00:16:26.712401 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m00:16:26.826780 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:16:26.906524 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:16:26.906943 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_shopify_orders.sql
[0m00:16:27.031950 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.marts
- models.intermatedbt.fact_tables
- models.intermatedbt.staging
[0m00:16:27.039693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dffb4781-9eaf-469d-be5f-be758158489f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1316d51e0>]}
[0m00:16:27.083714 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m00:16:27.085155 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m00:16:27.095854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dffb4781-9eaf-469d-be5f-be758158489f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1316caa70>]}
[0m00:16:27.096162 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m00:16:27.096343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dffb4781-9eaf-469d-be5f-be758158489f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1316cacb0>]}
[0m00:16:27.097451 [info ] [MainThread]: 
[0m00:16:27.097907 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:16:27.098111 [info ] [MainThread]: 
[0m00:16:27.098492 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:16:27.101344 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m00:16:27.101607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:27.620456 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m00:16:27.621836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:27.923193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dffb4781-9eaf-469d-be5f-be758158489f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049c8640>]}
[0m00:16:27.924681 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:16:27.929803 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m00:16:27.930678 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m00:16:27.931583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m00:16:27.932158 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m00:16:27.946268 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m00:16:27.947421 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m00:16:27.976522 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m00:16:27.977452 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m00:16:27.977842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:28.543026 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:743679b3-20ad-4eaf-a821-03cf73588d08&page=queryresults
[0m00:16:28.545035 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:743679b3-20ad-4eaf-a821-03cf73588d08&page=queryresults
[0m00:16:28.554961 [debug] [Thread-1 (]: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_facebook_ads was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m00:16:28.558317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dffb4781-9eaf-469d-be5f-be758158489f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131407700>]}
[0m00:16:28.559523 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model order_ad_data.stg_facebook_ads ............ [[31mERROR[0m in 0.62s]
[0m00:16:28.560465 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m00:16:28.561077 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m00:16:28.561771 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_facebook_ads' to be skipped because of status 'error'.  Reason: Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_facebook_ads was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql.
[0m00:16:28.562416 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m00:16:28.566154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m00:16:28.566658 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m00:16:28.570846 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m00:16:28.571971 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m00:16:28.575550 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m00:16:28.576495 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(created_at AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE status = 'completed';


[0m00:16:28.576966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:29.154477 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:e02a7c8f-5c4b-42fb-bb12-51d0548c8d29&page=queryresults
[0m00:16:29.381076 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:e02a7c8f-5c4b-42fb-bb12-51d0548c8d29&page=queryresults
[0m00:16:29.385258 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Unrecognized name: status at [16:7]
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m00:16:29.386607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dffb4781-9eaf-469d-be5f-be758158489f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130eae7d0>]}
[0m00:16:29.388201 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 0.82s]
[0m00:16:29.389109 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m00:16:29.389860 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Unrecognized name: status at [16:7]
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m00:16:29.390826 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m00:16:29.391718 [info ] [Thread-1 (]: 3 of 6 SKIP relation order_ad_data.fact_new_customer_orders .................... [[33mSKIP[0m]
[0m00:16:29.392388 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m00:16:29.393333 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m00:16:29.394075 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m00:16:29.394719 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m00:16:29.395272 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m00:16:29.395898 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m00:16:29.396541 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m00:16:29.397099 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m00:16:29.397748 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m00:16:29.398480 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m00:16:29.399619 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:16:29.400348 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:16:29.400773 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m00:16:29.401299 [info ] [MainThread]: 
[0m00:16:29.401703 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 2.30 seconds (2.30s).
[0m00:16:29.402771 [debug] [MainThread]: Command end result
[0m00:16:29.430416 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m00:16:29.432164 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m00:16:29.438069 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m00:16:29.438404 [info ] [MainThread]: 
[0m00:16:29.438744 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m00:16:29.439019 [info ] [MainThread]: 
[0m00:16:29.439345 [error] [MainThread]:   Database Error in model stg_facebook_ads (models/staging/stg_facebook_ads.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.clean_facebook_ads was not found in location US
  compiled code at target/run/intermate_dbt/models/staging/stg_facebook_ads.sql
[0m00:16:29.439583 [info ] [MainThread]: 
[0m00:16:29.439841 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Unrecognized name: status at [16:7]
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m00:16:29.440103 [info ] [MainThread]: 
[0m00:16:29.440338 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=4 TOTAL=6
[0m00:16:29.442915 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.720516, "process_in_blocks": "0", "process_kernel_time": 1.046577, "process_mem_max_rss": "212385792", "process_out_blocks": "0", "process_user_time": 2.530431}
[0m00:16:29.443367 [debug] [MainThread]: Command `dbt run` failed at 00:16:29.443296 after 3.72 seconds
[0m00:16:29.443695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ba48e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10482ba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13195bfd0>]}
[0m00:16:29.444004 [debug] [MainThread]: Flushing usage events
[0m00:16:29.874823 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:19:06.622158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fd88b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10589e140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10589e800>]}


============================== 00:19:06.629936 | cb27d413-cd0f-4227-8e92-b214c08bd361 ==============================
[0m00:19:06.629936 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:19:06.630309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m00:19:07.499973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb27d413-cd0f-4227-8e92-b214c08bd361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b245d50>]}
[0m00:19:07.528705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb27d413-cd0f-4227-8e92-b214c08bd361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10525cf10>]}
[0m00:19:07.529095 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m00:19:07.637651 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:19:07.714224 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:19:07.714805 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/sources.yml
[0m00:19:07.864281 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.intermate_dbt.stg_facebook_ads' (models/staging/stg_facebook_ads.sql) depends on a source named 'orders-and-ads.clean_facebook_ads' which was not found
[0m00:19:07.866888 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2890341, "process_in_blocks": "0", "process_kernel_time": 1.159803, "process_mem_max_rss": "209731584", "process_out_blocks": "0", "process_user_time": 2.221532}
[0m00:19:07.867153 [debug] [MainThread]: Command `dbt run` failed at 00:19:07.867104 after 1.29 seconds
[0m00:19:07.867368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fd88b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ba1c040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ba1e9b0>]}
[0m00:19:07.867572 [debug] [MainThread]: Flushing usage events
[0m00:19:08.433468 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:19:20.694477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103694910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044e5e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044e5780>]}


============================== 00:19:20.698090 | 6bc3e712-81e1-4e86-b935-93dc7129dff2 ==============================
[0m00:19:20.698090 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:19:20.698427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:19:21.507333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bc3e712-81e1-4e86-b935-93dc7129dff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12410aa70>]}
[0m00:19:21.535088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bc3e712-81e1-4e86-b935-93dc7129dff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10401b340>]}
[0m00:19:21.535495 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m00:19:21.644161 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:19:21.716183 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:19:21.716754 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/sources.yml
[0m00:19:21.892484 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.fact_tables
- models.intermatedbt.marts
- models.intermatedbt.staging
[0m00:19:21.898989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bc3e712-81e1-4e86-b935-93dc7129dff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124bdc1f0>]}
[0m00:19:21.941428 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m00:19:21.943020 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m00:19:21.955162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bc3e712-81e1-4e86-b935-93dc7129dff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124bc7430>]}
[0m00:19:21.955500 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m00:19:21.955702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bc3e712-81e1-4e86-b935-93dc7129dff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124b849a0>]}
[0m00:19:21.956756 [info ] [MainThread]: 
[0m00:19:21.957007 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:19:21.957170 [info ] [MainThread]: 
[0m00:19:21.957453 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:19:21.960171 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m00:19:21.960462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:22.617908 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m00:19:22.619082 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:23.034519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bc3e712-81e1-4e86-b935-93dc7129dff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044b8670>]}
[0m00:19:23.036145 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:19:23.041554 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m00:19:23.042568 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m00:19:23.043377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m00:19:23.043986 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m00:19:23.057213 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m00:19:23.058316 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m00:19:23.089154 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m00:19:23.090108 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ad`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m00:19:23.090506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:23.747188 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:c3c62f2f-db49-454b-b74c-74008b87b9d3&page=queryresults
[0m00:19:24.450009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bc3e712-81e1-4e86-b935-93dc7129dff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1240aabc0>]}
[0m00:19:24.450520 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.41s]
[0m00:19:24.450903 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m00:19:24.451156 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m00:19:24.451482 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m00:19:24.451743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m00:19:24.451951 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m00:19:24.453871 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m00:19:24.454309 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m00:19:24.506843 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m00:19:24.507649 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(created_at AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE status = 'completed';


[0m00:19:24.507877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:24.976418 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:a4f6aba1-a16b-4a25-8fca-9f1b80ab9341&page=queryresults
[0m00:19:25.213587 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:a4f6aba1-a16b-4a25-8fca-9f1b80ab9341&page=queryresults
[0m00:19:25.224871 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Unrecognized name: status at [16:7]
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m00:19:25.225985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bc3e712-81e1-4e86-b935-93dc7129dff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102407dc0>]}
[0m00:19:25.227041 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 0.77s]
[0m00:19:25.227889 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m00:19:25.228698 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Unrecognized name: status at [16:7]
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m00:19:25.230555 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m00:19:25.231239 [info ] [Thread-1 (]: 3 of 6 SKIP relation order_ad_data.fact_new_customer_orders .................... [[33mSKIP[0m]
[0m00:19:25.231766 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m00:19:25.232521 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m00:19:25.232980 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m00:19:25.233456 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m00:19:25.233905 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m00:19:25.234462 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m00:19:25.235052 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m00:19:25.235554 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m00:19:25.236090 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m00:19:25.236721 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m00:19:25.237959 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:19:25.238879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:19:25.239267 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m00:19:25.239753 [info ] [MainThread]: 
[0m00:19:25.240166 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 3.28 seconds (3.28s).
[0m00:19:25.241239 [debug] [MainThread]: Command end result
[0m00:19:25.266480 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m00:19:25.267977 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m00:19:25.273056 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m00:19:25.273317 [info ] [MainThread]: 
[0m00:19:25.273589 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:19:25.273817 [info ] [MainThread]: 
[0m00:19:25.274084 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Unrecognized name: status at [16:7]
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m00:19:25.274297 [info ] [MainThread]: 
[0m00:19:25.274521 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=4 TOTAL=6
[0m00:19:25.276960 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.621847, "process_in_blocks": "0", "process_kernel_time": 1.148564, "process_mem_max_rss": "221839360", "process_out_blocks": "0", "process_user_time": 2.644679}
[0m00:19:25.277303 [debug] [MainThread]: Command `dbt run` failed at 00:19:25.277241 after 4.62 seconds
[0m00:19:25.277592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103694910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124a8a7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124a8aaa0>]}
[0m00:19:25.277868 [debug] [MainThread]: Flushing usage events
[0m00:19:25.716393 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:22:53.916724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065808e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e9e1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e9e860>]}


============================== 00:22:53.925190 | 86bee339-b5fc-43fe-b3d3-7e538d28c3f1 ==============================
[0m00:22:53.925190 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:22:53.925600 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:22:54.998311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86bee339-b5fc-43fe-b3d3-7e538d28c3f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145c3d870>]}
[0m00:22:55.026801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86bee339-b5fc-43fe-b3d3-7e538d28c3f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106641f00>]}
[0m00:22:55.028174 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m00:22:55.138397 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:22:55.215364 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:22:55.215639 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:22:55.219069 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.marts
- models.intermatedbt.fact_tables
- models.intermatedbt.staging
[0m00:22:55.236350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86bee339-b5fc-43fe-b3d3-7e538d28c3f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146165420>]}
[0m00:22:55.280119 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m00:22:55.281356 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m00:22:55.292441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86bee339-b5fc-43fe-b3d3-7e538d28c3f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1460e68f0>]}
[0m00:22:55.292768 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m00:22:55.292959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86bee339-b5fc-43fe-b3d3-7e538d28c3f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e3c340>]}
[0m00:22:55.293870 [info ] [MainThread]: 
[0m00:22:55.294069 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:22:55.294227 [info ] [MainThread]: 
[0m00:22:55.294496 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:22:55.296866 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m00:22:55.297122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:22:55.818884 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m00:22:55.820147 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:22:56.161142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86bee339-b5fc-43fe-b3d3-7e538d28c3f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051fa6e0>]}
[0m00:22:56.162338 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:22:56.167456 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m00:22:56.168508 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m00:22:56.169264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m00:22:56.169846 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m00:22:56.186103 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m00:22:56.187605 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m00:22:56.216434 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m00:22:56.217509 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ad`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m00:22:56.217916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:22:56.787158 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:9b1a8e10-a006-48bf-84bb-f2dab6f5d7e2&page=queryresults
[0m00:22:57.432411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bee339-b5fc-43fe-b3d3-7e538d28c3f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145ab3760>]}
[0m00:22:57.432908 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.26s]
[0m00:22:57.433294 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m00:22:57.433543 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m00:22:57.433867 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m00:22:57.434136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m00:22:57.434353 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m00:22:57.436333 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m00:22:57.436794 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m00:22:57.438464 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m00:22:57.439104 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(created_at AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE status = 'completed';


[0m00:22:57.439380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:22:57.910662 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:8410866d-6eb1-4a60-9f12-69079140c8cd&page=queryresults
[0m00:22:58.579964 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:8410866d-6eb1-4a60-9f12-69079140c8cd&page=queryresults
[0m00:22:58.591568 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Unrecognized name: created_at at [11:10]
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m00:22:58.592639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bee339-b5fc-43fe-b3d3-7e538d28c3f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149a9feb0>]}
[0m00:22:58.593637 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 1.16s]
[0m00:22:58.594506 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m00:22:58.595358 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Unrecognized name: created_at at [11:10]
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m00:22:58.597270 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m00:22:58.598029 [info ] [Thread-1 (]: 3 of 6 SKIP relation order_ad_data.fact_new_customer_orders .................... [[33mSKIP[0m]
[0m00:22:58.598669 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m00:22:58.599478 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m00:22:58.600041 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m00:22:58.600550 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m00:22:58.600995 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m00:22:58.601515 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m00:22:58.602053 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m00:22:58.602511 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m00:22:58.603022 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m00:22:58.603556 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m00:22:58.604821 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:22:58.605631 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:22:58.606035 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m00:22:58.606551 [info ] [MainThread]: 
[0m00:22:58.607055 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 3.31 seconds (3.31s).
[0m00:22:58.608273 [debug] [MainThread]: Command end result
[0m00:22:58.634636 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m00:22:58.636281 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m00:22:58.641640 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m00:22:58.641894 [info ] [MainThread]: 
[0m00:22:58.642219 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:22:58.642488 [info ] [MainThread]: 
[0m00:22:58.642806 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Unrecognized name: created_at at [11:10]
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m00:22:58.643038 [info ] [MainThread]: 
[0m00:22:58.643270 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=4 TOTAL=6
[0m00:22:58.645663 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.77012, "process_in_blocks": "0", "process_kernel_time": 0.844008, "process_mem_max_rss": "203997184", "process_out_blocks": "0", "process_user_time": 2.560947}
[0m00:22:58.646026 [debug] [MainThread]: Command `dbt run` failed at 00:22:58.645959 after 4.77 seconds
[0m00:22:58.646326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065808e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1460e7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1460e53f0>]}
[0m00:22:58.646614 [debug] [MainThread]: Flushing usage events
[0m00:22:59.116983 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:23:48.484815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b308e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118495e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1184957b0>]}


============================== 00:23:48.495517 | 6de5c611-0213-418e-92ac-9c168a33b827 ==============================
[0m00:23:48.495517 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:23:48.495895 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:23:49.360974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6de5c611-0213-418e-92ac-9c168a33b827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144e3e2f0>]}
[0m00:23:49.388830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6de5c611-0213-418e-92ac-9c168a33b827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd18a0>]}
[0m00:23:49.389191 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m00:23:49.499046 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:23:49.574157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:23:49.574535 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_shopify_orders.sql
[0m00:23:49.696869 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.marts
- models.intermatedbt.staging
- models.intermatedbt.fact_tables
[0m00:23:49.704181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6de5c611-0213-418e-92ac-9c168a33b827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148bd91b0>]}
[0m00:23:49.746231 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m00:23:49.747535 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m00:23:49.758441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6de5c611-0213-418e-92ac-9c168a33b827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148bceb30>]}
[0m00:23:49.758750 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m00:23:49.758936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6de5c611-0213-418e-92ac-9c168a33b827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148bced70>]}
[0m00:23:49.759858 [info ] [MainThread]: 
[0m00:23:49.760064 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:23:49.760219 [info ] [MainThread]: 
[0m00:23:49.760483 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:23:49.762798 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m00:23:49.763047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:50.845754 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m00:23:50.846851 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:51.149297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6de5c611-0213-418e-92ac-9c168a33b827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118468640>]}
[0m00:23:51.150982 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:23:51.156431 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m00:23:51.157388 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m00:23:51.158323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m00:23:51.158911 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m00:23:51.172657 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m00:23:51.173749 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m00:23:51.201885 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m00:23:51.202670 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ad`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m00:23:51.203046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:51.770259 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:06a61456-c049-4110-b1cb-21c44c653da0&page=queryresults
[0m00:23:52.357530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6de5c611-0213-418e-92ac-9c168a33b827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144daaa40>]}
[0m00:23:52.358040 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m00:23:52.358440 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m00:23:52.358704 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m00:23:52.359062 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m00:23:52.359373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m00:23:52.359609 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m00:23:52.361705 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m00:23:52.362327 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m00:23:52.364021 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m00:23:52.364648 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE status = 'completed';


[0m00:23:52.364894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:52.891741 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:f84e9fcc-c301-4317-b0fe-9e98e8d3a9d5&page=queryresults
[0m00:23:53.472512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6de5c611-0213-418e-92ac-9c168a33b827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14889d210>]}
[0m00:23:53.474557 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m00:23:53.475861 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m00:23:53.477017 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m00:23:53.477953 [info ] [Thread-1 (]: 3 of 6 START sql incremental model order_ad_data.fact_new_customer_orders ...... [RUN]
[0m00:23:53.478684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m00:23:53.479233 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m00:23:53.485259 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m00:23:53.486992 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m00:23:53.540196 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_new_customer_orders"
[0m00:23:53.541022 [debug] [Thread-1 (]: On model.intermate_dbt.fact_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_new_customer_orders"} */

  
    

    create or replace table `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`
      
    
    

    OPTIONS()
    as (
      

SELECT
    order_id,
    customer_id,
    order_date,
    total_amount_eur,
    discount_code
FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
WHERE order_date >= (SELECT COALESCE(MAX(order_date), '2000-01-01') FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)
    );
  
[0m00:23:53.541333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:54.036302 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:95874d56-1ad3-4166-a3d1-d0ea524e342d&page=queryresults
[0m00:23:54.037157 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:95874d56-1ad3-4166-a3d1-d0ea524e342d&page=queryresults
[0m00:23:54.043241 [debug] [Thread-1 (]: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.fact_new_customer_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m00:23:54.043945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6de5c611-0213-418e-92ac-9c168a33b827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1492954b0>]}
[0m00:23:54.044669 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model order_ad_data.fact_new_customer_orders  [[31mERROR[0m in 0.57s]
[0m00:23:54.045291 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m00:23:54.045868 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_new_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.fact_new_customer_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql.
[0m00:23:54.047258 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m00:23:54.048105 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m00:23:54.049018 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m00:23:54.049806 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m00:23:54.050367 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m00:23:54.051128 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m00:23:54.051692 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m00:23:54.052415 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m00:23:54.053055 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m00:23:54.054373 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:23:54.055294 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:23:54.055772 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_new_customer_orders' was properly closed.
[0m00:23:54.056378 [info ] [MainThread]: 
[0m00:23:54.056863 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 4.30 seconds (4.30s).
[0m00:23:54.058007 [debug] [MainThread]: Command end result
[0m00:23:54.087767 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m00:23:54.089806 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m00:23:54.097168 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m00:23:54.097654 [info ] [MainThread]: 
[0m00:23:54.098078 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:23:54.099110 [info ] [MainThread]: 
[0m00:23:54.099956 [error] [MainThread]:   Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.fact_new_customer_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m00:23:54.100487 [info ] [MainThread]: 
[0m00:23:54.100973 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m00:23:54.106221 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.664225, "process_in_blocks": "0", "process_kernel_time": 0.979153, "process_mem_max_rss": "213712896", "process_out_blocks": "0", "process_user_time": 2.768238}
[0m00:23:54.106922 [debug] [MainThread]: Command `dbt run` failed at 00:23:54.106830 after 5.67 seconds
[0m00:23:54.107331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b308e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148bd82b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148bcea40>]}
[0m00:23:54.108134 [debug] [MainThread]: Flushing usage events
[0m00:23:54.535980 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:08:38.633290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ea8970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf9e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf9750>]}


============================== 01:08:38.642579 | 10ec034a-6110-4313-808e-7059b11f7216 ==============================
[0m01:08:38.642579 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:08:38.642989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:08:39.545572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10ec034a-6110-4313-808e-7059b11f7216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d38e9b0>]}
[0m01:08:39.573948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10ec034a-6110-4313-808e-7059b11f7216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ccefb0>]}
[0m01:08:39.574403 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:08:39.684961 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:08:39.760316 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m01:08:39.760915 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/sources.yml
[0m01:08:39.761110 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_shopify_orders.sql
[0m01:08:39.761279 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_facebook_ads.sql
[0m01:08:39.943836 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.marts
- models.intermatedbt.staging
- models.intermatedbt.fact_tables
[0m01:08:39.950816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10ec034a-6110-4313-808e-7059b11f7216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d92c9d0>]}
[0m01:08:39.997033 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:08:39.998479 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:08:40.009092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10ec034a-6110-4313-808e-7059b11f7216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d8a69e0>]}
[0m01:08:40.009419 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m01:08:40.009620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10ec034a-6110-4313-808e-7059b11f7216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11da8c4c0>]}
[0m01:08:40.010769 [info ] [MainThread]: 
[0m01:08:40.011042 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:08:40.011204 [info ] [MainThread]: 
[0m01:08:40.011555 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:08:40.014703 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m01:08:40.015019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:08:40.529433 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m01:08:40.531129 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:08:40.886834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10ec034a-6110-4313-808e-7059b11f7216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d38d2a0>]}
[0m01:08:40.888351 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:08:40.893347 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m01:08:40.894221 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m01:08:40.894970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m01:08:40.895552 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m01:08:40.908535 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m01:08:40.909680 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m01:08:40.937970 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m01:08:40.938870 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m01:08:40.939274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:41.487192 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:6647f1ec-be98-419f-a63e-af6a40b6355b&page=queryresults
[0m01:08:42.139963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10ec034a-6110-4313-808e-7059b11f7216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d32d4b0>]}
[0m01:08:42.140462 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.24s]
[0m01:08:42.140839 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m01:08:42.141101 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m01:08:42.141445 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m01:08:42.141721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m01:08:42.141943 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m01:08:42.144087 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m01:08:42.144561 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m01:08:42.199858 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m01:08:42.200501 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE status = 'completed';


[0m01:08:42.200868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:42.778300 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:8034c042-1d69-4253-a007-e1c0694203b8&page=queryresults
[0m01:08:43.397868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10ec034a-6110-4313-808e-7059b11f7216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d8a5270>]}
[0m01:08:43.399602 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.26s]
[0m01:08:43.400836 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m01:08:43.401952 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m01:08:43.402807 [info ] [Thread-1 (]: 3 of 6 START sql incremental model order_ad_data.fact_new_customer_orders ...... [RUN]
[0m01:08:43.403516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m01:08:43.404079 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m01:08:43.410200 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:08:43.411738 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m01:08:43.463896 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:08:43.464796 [debug] [Thread-1 (]: On model.intermate_dbt.fact_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_new_customer_orders"} */

  
    

    create or replace table `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`
      
    
    

    OPTIONS()
    as (
      

SELECT
    order_id,
    customer_id,
    order_date,
    total_amount_eur,
    discount_code
FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
WHERE order_date >= (SELECT COALESCE(MAX(order_date), '2000-01-01') FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)
    );
  
[0m01:08:43.465125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:43.906339 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:64145606-34bb-4efb-ad95-b76894f210df&page=queryresults
[0m01:08:43.908297 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:64145606-34bb-4efb-ad95-b76894f210df&page=queryresults
[0m01:08:43.917660 [debug] [Thread-1 (]: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.fact_new_customer_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:08:43.918726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10ec034a-6110-4313-808e-7059b11f7216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d4f1cc0>]}
[0m01:08:43.919788 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model order_ad_data.fact_new_customer_orders  [[31mERROR[0m in 0.52s]
[0m01:08:43.920698 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m01:08:43.921580 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_new_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.fact_new_customer_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql.
[0m01:08:43.923508 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m01:08:43.924242 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m01:08:43.924891 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m01:08:43.925464 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m01:08:43.926228 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m01:08:43.927138 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m01:08:43.927682 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m01:08:43.928272 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m01:08:43.928874 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m01:08:43.930116 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:08:43.930901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:08:43.931296 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_new_customer_orders' was properly closed.
[0m01:08:43.931798 [info ] [MainThread]: 
[0m01:08:43.932215 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 3.92 seconds (3.92s).
[0m01:08:43.933452 [debug] [MainThread]: Command end result
[0m01:08:43.959598 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:08:43.961241 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:08:43.966740 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m01:08:43.967088 [info ] [MainThread]: 
[0m01:08:43.967383 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:08:43.967634 [info ] [MainThread]: 
[0m01:08:43.967920 [error] [MainThread]:   Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.fact_new_customer_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:08:43.968151 [info ] [MainThread]: 
[0m01:08:43.968485 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m01:08:43.971237 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.3975244, "process_in_blocks": "0", "process_kernel_time": 1.118875, "process_mem_max_rss": "221544448", "process_out_blocks": "0", "process_user_time": 2.827754}
[0m01:08:43.971664 [debug] [MainThread]: Command `dbt run` failed at 01:08:43.971597 after 5.40 seconds
[0m01:08:43.972023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ea8970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11da0f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11da0fcd0>]}
[0m01:08:43.972324 [debug] [MainThread]: Flushing usage events
[0m01:08:44.453527 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:14:36.225891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a80940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11029e1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11029e890>]}


============================== 01:14:36.234595 | c39b7512-4663-43dd-a6d2-48980731f65b ==============================
[0m01:14:36.234595 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:14:36.234966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/victoruwaje/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:14:37.171902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c39b7512-4663-43dd-a6d2-48980731f65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d09180>]}
[0m01:14:37.200283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c39b7512-4663-43dd-a6d2-48980731f65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107523760>]}
[0m01:14:37.200654 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:14:37.311339 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:14:37.386888 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:14:37.387144 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:14:37.390502 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.fact_tables
- models.intermatedbt.marts
- models.intermatedbt.staging
[0m01:14:37.408551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c39b7512-4663-43dd-a6d2-48980731f65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1403654b0>]}
[0m01:14:37.453847 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:14:37.455175 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:14:37.467590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c39b7512-4663-43dd-a6d2-48980731f65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1403059c0>]}
[0m01:14:37.467901 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m01:14:37.468085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c39b7512-4663-43dd-a6d2-48980731f65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1403058a0>]}
[0m01:14:37.469009 [info ] [MainThread]: 
[0m01:14:37.469217 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:14:37.469370 [info ] [MainThread]: 
[0m01:14:37.469638 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:14:37.472047 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m01:14:37.472275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:14:38.009333 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m01:14:38.010385 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:14:38.387419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c39b7512-4663-43dd-a6d2-48980731f65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110268670>]}
[0m01:14:38.389007 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:14:38.393853 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m01:14:38.394754 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m01:14:38.395475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m01:14:38.396056 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m01:14:38.412270 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m01:14:38.413743 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m01:14:38.441742 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m01:14:38.442655 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m01:14:38.443047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:14:38.948675 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:9432f1e4-d95b-4ee0-b93b-22c46b24dfde&page=queryresults
[0m01:14:39.826213 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c39b7512-4663-43dd-a6d2-48980731f65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137caa350>]}
[0m01:14:39.826733 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.43s]
[0m01:14:39.827113 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m01:14:39.827376 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m01:14:39.827704 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m01:14:39.827987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m01:14:39.828210 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m01:14:39.830353 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m01:14:39.830873 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m01:14:39.832921 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m01:14:39.833797 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE status = 'completed';


[0m01:14:39.834105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:14:40.436082 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:41d676c0-5cc0-40b6-ac6f-92bd8568af3f&page=queryresults
[0m01:14:40.928919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c39b7512-4663-43dd-a6d2-48980731f65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066eb040>]}
[0m01:14:40.930901 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m01:14:40.932150 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m01:14:40.933175 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m01:14:40.934277 [info ] [Thread-1 (]: 3 of 6 START sql incremental model order_ad_data.fact_new_customer_orders ...... [RUN]
[0m01:14:40.935101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m01:14:40.935703 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m01:14:40.941378 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:14:40.942800 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m01:14:40.996026 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:14:40.996804 [debug] [Thread-1 (]: On model.intermate_dbt.fact_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_new_customer_orders"} */

  
    

    create or replace table `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`
      
    
    

    OPTIONS()
    as (
      

SELECT
    order_id,
    customer_id,
    order_date,
    total_amount_eur,
    discount_code
FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
WHERE order_date >= (SELECT COALESCE(MAX(order_date), '2000-01-01') FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)
    );
  
[0m01:14:40.997142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:14:41.462293 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:b50fe8a7-3b4c-4fe6-9d7f-264abdaf3904&page=queryresults
[0m01:14:41.464052 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:b50fe8a7-3b4c-4fe6-9d7f-264abdaf3904&page=queryresults
[0m01:14:41.473735 [debug] [Thread-1 (]: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.fact_new_customer_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:14:41.474720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c39b7512-4663-43dd-a6d2-48980731f65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140305540>]}
[0m01:14:41.475806 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model order_ad_data.fact_new_customer_orders  [[31mERROR[0m in 0.54s]
[0m01:14:41.476554 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m01:14:41.477277 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_new_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.fact_new_customer_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql.
[0m01:14:41.478965 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m01:14:41.479536 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m01:14:41.480077 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m01:14:41.480538 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m01:14:41.481035 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m01:14:41.481519 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m01:14:41.481966 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m01:14:41.482559 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m01:14:41.483188 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m01:14:41.484368 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:14:41.485122 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:14:41.485513 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_new_customer_orders' was properly closed.
[0m01:14:41.486185 [info ] [MainThread]: 
[0m01:14:41.486627 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 4.02 seconds (4.02s).
[0m01:14:41.487854 [debug] [MainThread]: Command end result
[0m01:14:41.513435 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:14:41.515085 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:14:41.520895 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m01:14:41.521156 [info ] [MainThread]: 
[0m01:14:41.521427 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:14:41.521654 [info ] [MainThread]: 
[0m01:14:41.521937 [error] [MainThread]:   Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.fact_new_customer_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:14:41.522164 [info ] [MainThread]: 
[0m01:14:41.522392 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m01:14:41.524960 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.341141, "process_in_blocks": "0", "process_kernel_time": 0.886578, "process_mem_max_rss": "210829312", "process_out_blocks": "0", "process_user_time": 2.806108}
[0m01:14:41.525324 [debug] [MainThread]: Command `dbt run` failed at 01:14:41.525264 after 5.34 seconds
[0m01:14:41.525621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a80940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107523760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b14520>]}
[0m01:14:41.525904 [debug] [MainThread]: Flushing usage events
[0m01:14:42.012929 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:16:54.906797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c8c8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c95e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c957b0>]}


============================== 01:16:54.916692 | 16cdba04-9849-4270-9d23-1d57f481cb2f ==============================
[0m01:16:54.916692 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:16:54.917076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:16:55.843644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16cdba04-9849-4270-9d23-1d57f481cb2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14553f3a0>]}
[0m01:16:55.873519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16cdba04-9849-4270-9d23-1d57f481cb2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a5540>]}
[0m01:16:55.873979 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:16:56.116312 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:16:56.193013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:16:56.193431 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_facebook_ads.sql
[0m01:16:56.319421 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.staging
- models.intermatedbt.marts
- models.intermatedbt.fact_tables
[0m01:16:56.327732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16cdba04-9849-4270-9d23-1d57f481cb2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145dd9180>]}
[0m01:16:56.373810 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:16:56.375344 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:16:56.387574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16cdba04-9849-4270-9d23-1d57f481cb2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145c065c0>]}
[0m01:16:56.387975 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m01:16:56.388179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16cdba04-9849-4270-9d23-1d57f481cb2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145c06320>]}
[0m01:16:56.389260 [info ] [MainThread]: 
[0m01:16:56.389477 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:16:56.389633 [info ] [MainThread]: 
[0m01:16:56.389914 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:16:56.392282 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m01:16:56.392511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:16:56.842285 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m01:16:56.843427 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:16:57.202672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16cdba04-9849-4270-9d23-1d57f481cb2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ade6e0>]}
[0m01:16:57.204377 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:16:57.210130 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m01:16:57.211462 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m01:16:57.212271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m01:16:57.212895 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m01:16:57.226992 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m01:16:57.228353 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m01:16:57.257059 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m01:16:57.258126 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`;


[0m01:16:57.258618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:16:57.941409 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:d2f5f601-72c3-4a15-8c78-d45aef8201a4&page=queryresults
[0m01:16:58.490420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16cdba04-9849-4270-9d23-1d57f481cb2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1454ab760>]}
[0m01:16:58.490954 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m01:16:58.491336 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m01:16:58.491591 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m01:16:58.491946 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m01:16:58.492261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m01:16:58.492488 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m01:16:58.494472 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m01:16:58.495055 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m01:16:58.496731 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m01:16:58.497332 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE status = 'completed';


[0m01:16:58.497576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:16:58.980348 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:f4892146-cb7f-4c91-a1de-6da764ccbb17&page=queryresults
[0m01:16:59.454071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16cdba04-9849-4270-9d23-1d57f481cb2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145c67a60>]}
[0m01:16:59.455718 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m01:16:59.456848 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m01:16:59.458047 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m01:16:59.458893 [info ] [Thread-1 (]: 3 of 6 START sql incremental model order_ad_data.fact_new_customer_orders ...... [RUN]
[0m01:16:59.459672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m01:16:59.460242 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m01:16:59.465933 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:16:59.467560 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m01:16:59.521628 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:16:59.522366 [debug] [Thread-1 (]: On model.intermate_dbt.fact_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_new_customer_orders"} */

  
    

    create or replace table `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`
      
    
    

    OPTIONS()
    as (
      

SELECT
    order_id,
    customer_id,
    order_date,
    total_amount_eur,
    discount_code
FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
WHERE order_date >= (SELECT COALESCE(MAX(order_date), '2000-01-01') FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)
    );
  
[0m01:16:59.522678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:16:59.957598 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:b514efcc-426e-4aea-8123-2e63b44bd227&page=queryresults
[0m01:16:59.958947 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:b514efcc-426e-4aea-8123-2e63b44bd227&page=queryresults
[0m01:16:59.968595 [debug] [Thread-1 (]: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.fact_new_customer_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:16:59.969707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16cdba04-9849-4270-9d23-1d57f481cb2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1462b8910>]}
[0m01:16:59.970747 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model order_ad_data.fact_new_customer_orders  [[31mERROR[0m in 0.51s]
[0m01:16:59.971628 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m01:16:59.972383 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_new_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.fact_new_customer_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql.
[0m01:16:59.974272 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m01:16:59.975188 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m01:16:59.975839 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m01:16:59.976362 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m01:16:59.976894 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m01:16:59.977434 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m01:16:59.977902 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m01:16:59.978419 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m01:16:59.978951 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m01:16:59.980101 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:16:59.980921 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:16:59.981326 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_new_customer_orders' was properly closed.
[0m01:16:59.981829 [info ] [MainThread]: 
[0m01:16:59.982246 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 3.59 seconds (3.59s).
[0m01:16:59.983487 [debug] [MainThread]: Command end result
[0m01:17:00.009544 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:17:00.011163 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:17:00.017202 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m01:17:00.017529 [info ] [MainThread]: 
[0m01:17:00.017813 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:17:00.018057 [info ] [MainThread]: 
[0m01:17:00.018351 [error] [MainThread]:   Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.fact_new_customer_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:17:00.018593 [info ] [MainThread]: 
[0m01:17:00.018847 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m01:17:00.021966 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.15771, "process_in_blocks": "0", "process_kernel_time": 1.114771, "process_mem_max_rss": "204128256", "process_out_blocks": "0", "process_user_time": 2.727279}
[0m01:17:00.022733 [debug] [MainThread]: Command `dbt run` failed at 01:17:00.022648 after 5.16 seconds
[0m01:17:00.023272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c8c8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a5540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145e56fe0>]}
[0m01:17:00.024140 [debug] [MainThread]: Flushing usage events
[0m01:17:00.491573 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:19:04.958684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105904850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106751ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106751810>]}


============================== 01:19:04.967208 | 8f870717-ca47-44ef-a680-4dbd5fe32e33 ==============================
[0m01:19:04.967208 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:19:04.967630 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:19:05.913947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f870717-ca47-44ef-a680-4dbd5fe32e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132badc90>]}
[0m01:19:05.943397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f870717-ca47-44ef-a680-4dbd5fe32e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10621b550>]}
[0m01:19:05.943866 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:19:06.058021 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:19:06.137634 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:19:06.138064 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_facebook_ads.sql
[0m01:19:06.138300 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_shopify_orders.sql
[0m01:19:06.263994 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.staging
- models.intermatedbt.fact_tables
- models.intermatedbt.marts
[0m01:19:06.271492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f870717-ca47-44ef-a680-4dbd5fe32e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1333d11e0>]}
[0m01:19:06.314559 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:19:06.315891 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:19:06.326630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f870717-ca47-44ef-a680-4dbd5fe32e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133205d80>]}
[0m01:19:06.326950 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m01:19:06.327137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f870717-ca47-44ef-a680-4dbd5fe32e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1332075e0>]}
[0m01:19:06.328093 [info ] [MainThread]: 
[0m01:19:06.328302 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:19:06.328462 [info ] [MainThread]: 
[0m01:19:06.328754 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:19:06.331243 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m01:19:06.331485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:19:06.852976 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m01:19:06.854352 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:07.228602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f870717-ca47-44ef-a680-4dbd5fe32e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105383d90>]}
[0m01:19:07.230622 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:19:07.235495 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m01:19:07.236605 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m01:19:07.237339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m01:19:07.237924 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m01:19:07.251406 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m01:19:07.252472 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m01:19:07.281147 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m01:19:07.281902 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m01:19:07.282271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:07.902603 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:085e4b97-410b-42d8-bc38-cb106f221f36&page=queryresults
[0m01:19:08.507842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f870717-ca47-44ef-a680-4dbd5fe32e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065879a0>]}
[0m01:19:08.508313 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.27s]
[0m01:19:08.508652 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m01:19:08.508875 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m01:19:08.509161 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m01:19:08.509406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m01:19:08.509595 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m01:19:08.511451 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m01:19:08.512025 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m01:19:08.513736 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m01:19:08.514402 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m01:19:08.514694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:09.020085 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:7906a59d-e066-4bc0-96c5-3e423c8eee07&page=queryresults
[0m01:19:09.257643 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:7906a59d-e066-4bc0-96c5-3e423c8eee07&page=queryresults
[0m01:19:09.268584 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Unrecognized name: spend_eur at [17:7]
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m01:19:09.269566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f870717-ca47-44ef-a680-4dbd5fe32e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133559960>]}
[0m01:19:09.270622 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 0.76s]
[0m01:19:09.271484 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m01:19:09.272206 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Unrecognized name: spend_eur at [17:7]
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m01:19:09.274122 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m01:19:09.274773 [info ] [Thread-1 (]: 3 of 6 SKIP relation order_ad_data.fact_new_customer_orders .................... [[33mSKIP[0m]
[0m01:19:09.275551 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m01:19:09.276608 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m01:19:09.277182 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m01:19:09.277711 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m01:19:09.278176 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m01:19:09.278710 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m01:19:09.279243 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m01:19:09.279734 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m01:19:09.280282 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m01:19:09.280802 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m01:19:09.281963 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:19:09.282693 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:19:09.283055 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m01:19:09.283549 [info ] [MainThread]: 
[0m01:19:09.283956 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 2.95 seconds (2.95s).
[0m01:19:09.285075 [debug] [MainThread]: Command end result
[0m01:19:09.311220 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:19:09.313074 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:19:09.318197 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m01:19:09.318461 [info ] [MainThread]: 
[0m01:19:09.318740 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:19:09.318973 [info ] [MainThread]: 
[0m01:19:09.319253 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  Unrecognized name: spend_eur at [17:7]
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m01:19:09.319479 [info ] [MainThread]: 
[0m01:19:09.319710 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=4 TOTAL=6
[0m01:19:09.322085 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.4104943, "process_in_blocks": "0", "process_kernel_time": 1.018971, "process_mem_max_rss": "219480064", "process_out_blocks": "0", "process_user_time": 2.651647}
[0m01:19:09.322501 [debug] [MainThread]: Command `dbt run` failed at 01:19:09.322434 after 4.41 seconds
[0m01:19:09.322817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105904850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10621b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1332aa7d0>]}
[0m01:19:09.323171 [debug] [MainThread]: Flushing usage events
[0m01:19:09.795512 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:20:27.347097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f809a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10579e290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10579e950>]}


============================== 01:20:27.356976 | ffc6eed4-af19-49ff-b5a6-b70e0d6b763d ==============================
[0m01:20:27.356976 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:20:27.357389 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:20:28.308945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffc6eed4-af19-49ff-b5a6-b70e0d6b763d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127408f40>]}
[0m01:20:28.337146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffc6eed4-af19-49ff-b5a6-b70e0d6b763d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10576afe0>]}
[0m01:20:28.337530 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:20:28.447977 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:20:28.522507 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:20:28.522904 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_shopify_orders.sql
[0m01:20:28.646728 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.marts
- models.intermatedbt.fact_tables
- models.intermatedbt.staging
[0m01:20:28.654161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ffc6eed4-af19-49ff-b5a6-b70e0d6b763d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127a8be50>]}
[0m01:20:28.696641 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:20:28.698037 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:20:28.712193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ffc6eed4-af19-49ff-b5a6-b70e0d6b763d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127bd3a00>]}
[0m01:20:28.712531 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m01:20:28.712720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffc6eed4-af19-49ff-b5a6-b70e0d6b763d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127bd2bc0>]}
[0m01:20:28.713713 [info ] [MainThread]: 
[0m01:20:28.713918 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:20:28.714078 [info ] [MainThread]: 
[0m01:20:28.714364 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:20:28.717121 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m01:20:28.717408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:29.218384 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m01:20:29.218911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:29.725559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffc6eed4-af19-49ff-b5a6-b70e0d6b763d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127863d60>]}
[0m01:20:29.727359 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:20:29.732324 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m01:20:29.733472 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m01:20:29.734229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m01:20:29.734810 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m01:20:29.748432 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m01:20:29.749672 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m01:20:29.778539 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m01:20:29.779584 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m01:20:29.779997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:30.338929 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:70c08ce8-fb56-4012-8a41-ac73d8bcd318&page=queryresults
[0m01:20:30.929002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffc6eed4-af19-49ff-b5a6-b70e0d6b763d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1273aac50>]}
[0m01:20:30.929505 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.19s]
[0m01:20:30.929895 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m01:20:30.930154 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m01:20:30.930485 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m01:20:30.930760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m01:20:30.930981 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m01:20:30.933098 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m01:20:30.933701 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m01:20:30.935401 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m01:20:30.935925 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status,
    total_price_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur IS NOT NULL;


[0m01:20:30.936173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:31.464887 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:eb5be368-de37-41c5-9634-fc751db21773&page=queryresults
[0m01:20:31.691879 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:eb5be368-de37-41c5-9634-fc751db21773&page=queryresults
[0m01:20:31.702567 [debug] [Thread-1 (]: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  CREATE VIEW has columns with duplicate name total_price_eur at [8:1]
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m01:20:31.703577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffc6eed4-af19-49ff-b5a6-b70e0d6b763d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127f59780>]}
[0m01:20:31.704591 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model order_ad_data.stg_shopify_orders .......... [[31mERROR[0m in 0.77s]
[0m01:20:31.705446 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m01:20:31.706213 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.stg_shopify_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  CREATE VIEW has columns with duplicate name total_price_eur at [8:1]
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql.
[0m01:20:31.708135 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m01:20:31.709000 [info ] [Thread-1 (]: 3 of 6 SKIP relation order_ad_data.fact_new_customer_orders .................... [[33mSKIP[0m]
[0m01:20:31.709669 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m01:20:31.710441 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m01:20:31.710978 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m01:20:31.711499 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m01:20:31.711959 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m01:20:31.712466 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m01:20:31.712992 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m01:20:31.713433 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m01:20:31.713931 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m01:20:31.714425 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m01:20:31.715611 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:20:31.716360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:20:31.716726 [debug] [MainThread]: Connection 'model.intermate_dbt.stg_shopify_orders' was properly closed.
[0m01:20:31.717240 [info ] [MainThread]: 
[0m01:20:31.717643 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 3.00 seconds (3.00s).
[0m01:20:31.718874 [debug] [MainThread]: Command end result
[0m01:20:31.745898 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:20:31.747562 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:20:31.752886 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m01:20:31.753167 [info ] [MainThread]: 
[0m01:20:31.753442 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:20:31.753679 [info ] [MainThread]: 
[0m01:20:31.753959 [error] [MainThread]:   Database Error in model stg_shopify_orders (models/staging/stg_shopify_orders.sql)
  CREATE VIEW has columns with duplicate name total_price_eur at [8:1]
  compiled code at target/run/intermate_dbt/models/staging/stg_shopify_orders.sql
[0m01:20:31.754180 [info ] [MainThread]: 
[0m01:20:31.754431 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=4 TOTAL=6
[0m01:20:31.756747 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.4511247, "process_in_blocks": "0", "process_kernel_time": 1.071974, "process_mem_max_rss": "210567168", "process_out_blocks": "0", "process_user_time": 2.498388}
[0m01:20:31.757090 [debug] [MainThread]: Command `dbt run` failed at 01:20:31.757030 after 4.45 seconds
[0m01:20:31.757384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f809a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10576afe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127ab2bc0>]}
[0m01:20:31.757667 [debug] [MainThread]: Flushing usage events
[0m01:20:32.238353 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:20:51.192415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038248b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104675ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046757e0>]}


============================== 01:20:51.195969 | e31be263-fecd-4916-b8f4-c202d75350f7 ==============================
[0m01:20:51.195969 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:20:51.196313 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:20:52.032614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e31be263-fecd-4916-b8f4-c202d75350f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fb0bc40>]}
[0m01:20:52.061024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e31be263-fecd-4916-b8f4-c202d75350f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038d99c0>]}
[0m01:20:52.061419 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:20:52.170392 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:20:52.242728 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:20:52.243106 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_shopify_orders.sql
[0m01:20:52.364538 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.marts
- models.intermatedbt.fact_tables
- models.intermatedbt.staging
[0m01:20:52.372216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e31be263-fecd-4916-b8f4-c202d75350f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128192ec0>]}
[0m01:20:52.416729 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:20:52.418220 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:20:52.430135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e31be263-fecd-4916-b8f4-c202d75350f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1282c8d30>]}
[0m01:20:52.430453 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m01:20:52.430637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e31be263-fecd-4916-b8f4-c202d75350f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1282c8af0>]}
[0m01:20:52.431552 [info ] [MainThread]: 
[0m01:20:52.431744 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:20:52.431899 [info ] [MainThread]: 
[0m01:20:52.432161 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:20:52.434522 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m01:20:52.434749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:53.086655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m01:20:53.088059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:53.516253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e31be263-fecd-4916-b8f4-c202d75350f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fc04160>]}
[0m01:20:53.518008 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:20:53.523627 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m01:20:53.524788 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m01:20:53.525512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m01:20:53.526081 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m01:20:53.539485 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m01:20:53.540602 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m01:20:53.570076 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m01:20:53.570917 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m01:20:53.571295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:54.205885 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:79b7ee8b-e47d-41ed-8f94-c7c2e3bb4158&page=queryresults
[0m01:20:54.785811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e31be263-fecd-4916-b8f4-c202d75350f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fc6edd0>]}
[0m01:20:54.786359 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.26s]
[0m01:20:54.786750 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m01:20:54.787006 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m01:20:54.787373 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m01:20:54.787697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m01:20:54.787941 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m01:20:54.790082 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m01:20:54.790558 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m01:20:54.792377 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m01:20:54.792847 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur IS NOT NULL;


[0m01:20:54.793099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:55.835916 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:76f4e8af-534b-4d9d-b307-ee1760cac769&page=queryresults
[0m01:25:22.208828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d80910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110695e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110695780>]}


============================== 01:25:22.218717 | 4fda10ed-d790-4321-9241-d82531703015 ==============================
[0m01:25:22.218717 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:25:22.219076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:25:23.210682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fda10ed-d790-4321-9241-d82531703015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105df7970>]}
[0m01:25:23.240071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fda10ed-d790-4321-9241-d82531703015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101cb340>]}
[0m01:25:23.240531 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:25:23.353457 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:25:23.431731 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:25:23.432152 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/staging/stg_shopify_orders.sql
[0m01:25:23.556036 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.fact_tables
- models.intermatedbt.marts
- models.intermatedbt.staging
[0m01:25:23.563517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fda10ed-d790-4321-9241-d82531703015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137bd91b0>]}
[0m01:25:23.609743 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:25:23.611157 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:25:23.622229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fda10ed-d790-4321-9241-d82531703015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137bcfa60>]}
[0m01:25:23.622558 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m01:25:23.622741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fda10ed-d790-4321-9241-d82531703015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137bceb30>]}
[0m01:25:23.623671 [info ] [MainThread]: 
[0m01:25:23.623877 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:25:23.624039 [info ] [MainThread]: 
[0m01:25:23.624310 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:25:23.626713 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m01:25:23.626953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:25:24.232741 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m01:25:24.233698 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:25:24.592266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fda10ed-d790-4321-9241-d82531703015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110668670>]}
[0m01:25:24.593517 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:25:24.597550 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m01:25:24.598376 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m01:25:24.599080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m01:25:24.599943 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m01:25:24.613155 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m01:25:24.614351 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m01:25:24.642713 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m01:25:24.643594 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m01:25:24.643933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:25.289917 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:30542083-2161-4953-abe0-5f256dcafa78&page=queryresults
[0m01:25:25.933610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fda10ed-d790-4321-9241-d82531703015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1371a9960>]}
[0m01:25:25.934111 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.33s]
[0m01:25:25.934467 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m01:25:25.934707 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m01:25:25.935104 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m01:25:25.935494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m01:25:25.935828 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m01:25:25.937921 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m01:25:25.938598 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m01:25:25.940335 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m01:25:25.940889 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m01:25:25.941178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:26.470861 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:d0f79820-1306-4474-821e-7c68740d903a&page=queryresults
[0m01:25:26.942625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fda10ed-d790-4321-9241-d82531703015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137866e00>]}
[0m01:25:26.944159 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m01:25:26.945500 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m01:25:26.947173 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m01:25:26.948054 [info ] [Thread-1 (]: 3 of 6 START sql incremental model order_ad_data.fact_new_customer_orders ...... [RUN]
[0m01:25:26.948819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m01:25:26.949405 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m01:25:26.955416 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:25:26.957446 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m01:25:27.011297 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:25:27.012026 [debug] [Thread-1 (]: On model.intermate_dbt.fact_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_new_customer_orders"} */

  
    

    create or replace table `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`
      
    
    

    OPTIONS()
    as (
      

SELECT
    order_id,
    customer_id,
    order_date,
    total_amount_eur,
    discount_code
FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
WHERE order_date >= (SELECT COALESCE(MAX(order_date), '2000-01-01') FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)
    );
  
[0m01:25:27.012344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:27.862677 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:89375162-89e5-45ed-b8f4-b0763d87a571&page=queryresults
[0m01:25:27.864566 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:89375162-89e5-45ed-b8f4-b0763d87a571&page=queryresults
[0m01:25:27.876033 [debug] [Thread-1 (]: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.fact_new_customer_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:25:27.877068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fda10ed-d790-4321-9241-d82531703015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146095330>]}
[0m01:25:27.878085 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model order_ad_data.fact_new_customer_orders  [[31mERROR[0m in 0.93s]
[0m01:25:27.878995 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m01:25:27.879871 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_new_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.fact_new_customer_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql.
[0m01:25:27.881600 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m01:25:27.882273 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m01:25:27.882827 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m01:25:27.883292 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m01:25:27.883840 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m01:25:27.884421 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m01:25:27.884899 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m01:25:27.885380 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m01:25:27.885871 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m01:25:27.886988 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:25:27.887698 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:25:27.888056 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_new_customer_orders' was properly closed.
[0m01:25:27.888541 [info ] [MainThread]: 
[0m01:25:27.888931 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 4.26 seconds (4.26s).
[0m01:25:27.890250 [debug] [MainThread]: Command end result
[0m01:25:27.918114 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:25:27.919841 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:25:27.925876 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m01:25:27.926160 [info ] [MainThread]: 
[0m01:25:27.926437 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:25:27.926668 [info ] [MainThread]: 
[0m01:25:27.926940 [error] [MainThread]:   Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.fact_new_customer_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:25:27.927164 [info ] [MainThread]: 
[0m01:25:27.927393 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m01:25:27.930075 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.765268, "process_in_blocks": "0", "process_kernel_time": 0.872771, "process_mem_max_rss": "217726976", "process_out_blocks": "0", "process_user_time": 2.869561}
[0m01:25:27.930486 [debug] [MainThread]: Command `dbt run` failed at 01:25:27.930397 after 5.77 seconds
[0m01:25:27.930805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d80910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105df7940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1373163e0>]}
[0m01:25:27.931101 [debug] [MainThread]: Flushing usage events
[0m01:25:29.472649 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:26:20.794311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104090910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ee1e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ee1780>]}


============================== 01:26:20.806487 | 08d51a09-2df5-470f-93c4-6ef5da1bc8df ==============================
[0m01:26:20.806487 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:26:20.806845 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:26:21.706076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08d51a09-2df5-470f-93c4-6ef5da1bc8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a008eb0>]}
[0m01:26:21.734962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08d51a09-2df5-470f-93c4-6ef5da1bc8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10496e950>]}
[0m01:26:21.735392 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:26:21.847870 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:26:21.924967 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:26:21.925236 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:26:21.928690 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.marts
- models.intermatedbt.fact_tables
- models.intermatedbt.staging
[0m01:26:21.945970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08d51a09-2df5-470f-93c4-6ef5da1bc8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a7654e0>]}
[0m01:26:21.990775 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:26:21.992306 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:26:22.004026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08d51a09-2df5-470f-93c4-6ef5da1bc8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a7077c0>]}
[0m01:26:22.004347 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m01:26:22.004534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08d51a09-2df5-470f-93c4-6ef5da1bc8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a7069b0>]}
[0m01:26:22.005407 [info ] [MainThread]: 
[0m01:26:22.005609 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:26:22.005809 [info ] [MainThread]: 
[0m01:26:22.006132 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:26:22.008572 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m01:26:22.008816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:26:22.461983 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m01:26:22.463475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:26:22.797084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08d51a09-2df5-470f-93c4-6ef5da1bc8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb4670>]}
[0m01:26:22.798630 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:26:22.803330 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m01:26:22.804239 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m01:26:22.804963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m01:26:22.805529 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m01:26:22.821287 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m01:26:22.822559 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m01:26:22.851040 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m01:26:22.851831 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m01:26:22.852199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:26:23.434406 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:14192090-b5f6-4c02-ad49-33742fdc3047&page=queryresults
[0m01:26:23.974069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08d51a09-2df5-470f-93c4-6ef5da1bc8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139fa94e0>]}
[0m01:26:23.974573 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.17s]
[0m01:26:23.974953 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m01:26:23.975212 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m01:26:23.975547 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m01:26:23.975817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m01:26:23.976038 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m01:26:23.978116 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m01:26:23.978719 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m01:26:23.980443 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m01:26:23.980947 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m01:26:23.981178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:26:24.546249 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:0e341a42-0e51-4442-a286-c78cf165f252&page=queryresults
[0m01:26:25.027825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08d51a09-2df5-470f-93c4-6ef5da1bc8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139fa94e0>]}
[0m01:26:25.029342 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m01:26:25.030296 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m01:26:25.031294 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m01:26:25.032318 [info ] [Thread-1 (]: 3 of 6 START sql incremental model order_ad_data.fact_new_customer_orders ...... [RUN]
[0m01:26:25.033017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m01:26:25.033574 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m01:26:25.039317 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:26:25.040923 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m01:26:25.093456 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:26:25.094166 [debug] [Thread-1 (]: On model.intermate_dbt.fact_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_new_customer_orders"} */

  
    

    create or replace table `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`
      
    
    

    OPTIONS()
    as (
      

SELECT
    order_id,
    customer_id,
    order_date,
    total_amount_eur,
    discount_code
FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
WHERE order_date >= (SELECT COALESCE(MAX(order_date), '2000-01-01') FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)
    );
  
[0m01:26:25.094475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:26:25.594086 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:4bc93032-31f9-449c-8f67-3414bb686e8a&page=queryresults
[0m01:26:25.595508 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:4bc93032-31f9-449c-8f67-3414bb686e8a&page=queryresults
[0m01:26:25.604102 [debug] [Thread-1 (]: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.fact_new_customer_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:26:25.605222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08d51a09-2df5-470f-93c4-6ef5da1bc8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a704130>]}
[0m01:26:25.606263 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model order_ad_data.fact_new_customer_orders  [[31mERROR[0m in 0.57s]
[0m01:26:25.607291 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m01:26:25.608160 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_new_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.fact_new_customer_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql.
[0m01:26:25.610055 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m01:26:25.610850 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m01:26:25.611510 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m01:26:25.612062 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m01:26:25.612670 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m01:26:25.613158 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m01:26:25.613591 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m01:26:25.614148 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m01:26:25.614737 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m01:26:25.615943 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:26:25.616691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:26:25.617083 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_new_customer_orders' was properly closed.
[0m01:26:25.617593 [info ] [MainThread]: 
[0m01:26:25.618153 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 3.61 seconds (3.61s).
[0m01:26:25.619627 [debug] [MainThread]: Command end result
[0m01:26:25.647043 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:26:25.648679 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:26:25.654422 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m01:26:25.654731 [info ] [MainThread]: 
[0m01:26:25.655015 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:26:25.655253 [info ] [MainThread]: 
[0m01:26:25.655529 [error] [MainThread]:   Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.fact_new_customer_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:26:25.655755 [info ] [MainThread]: 
[0m01:26:25.655984 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m01:26:25.658516 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.9072857, "process_in_blocks": "0", "process_kernel_time": 1.190755, "process_mem_max_rss": "216268800", "process_out_blocks": "0", "process_user_time": 2.472771}
[0m01:26:25.658901 [debug] [MainThread]: Command `dbt run` failed at 01:26:25.658840 after 4.91 seconds
[0m01:26:25.659202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104090910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10496e950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104144a00>]}
[0m01:26:25.659487 [debug] [MainThread]: Flushing usage events
[0m01:26:26.085956 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:29:27.279528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105214970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107095e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107095750>]}


============================== 01:29:27.291778 | b79af491-9e8b-48a0-a4bf-6add209a53b5 ==============================
[0m01:29:27.291778 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:29:27.292164 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:29:28.208154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b79af491-9e8b-48a0-a4bf-6add209a53b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143b0b190>]}
[0m01:29:28.237223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b79af491-9e8b-48a0-a4bf-6add209a53b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706afb0>]}
[0m01:29:28.237626 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:29:28.349209 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:29:28.425191 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:29:28.425602 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_new_customer_orders.sql
[0m01:29:28.524028 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.intermate_dbt.fact_new_customer_orders' (models/facts_tables/fact_new_customer_orders.sql) depends on a node named 'stg_weather' which was not found
[0m01:29:28.526948 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.291566, "process_in_blocks": "0", "process_kernel_time": 1.03348, "process_mem_max_rss": "207159296", "process_out_blocks": "0", "process_user_time": 2.296719}
[0m01:29:28.527261 [debug] [MainThread]: Command `dbt run` failed at 01:29:28.527207 after 1.29 seconds
[0m01:29:28.527501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105214970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144054cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143f612a0>]}
[0m01:29:28.527721 [debug] [MainThread]: Flushing usage events
[0m01:29:29.016459 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:30:26.573669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108180880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fcdf30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fcd870>]}


============================== 01:30:26.582283 | 13e7ba37-b2c0-4196-a391-d7905594f997 ==============================
[0m01:30:26.582283 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:30:26.582647 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:30:27.477973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13e7ba37-b2c0-4196-a391-d7905594f997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070f9900>]}
[0m01:30:27.507305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13e7ba37-b2c0-4196-a391-d7905594f997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082334c0>]}
[0m01:30:27.507710 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:30:27.619989 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:30:27.695814 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:30:27.696216 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_new_customer_orders.sql
[0m01:30:27.821268 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.staging
- models.intermatedbt.marts
- models.intermatedbt.fact_tables
[0m01:30:27.829314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13e7ba37-b2c0-4196-a391-d7905594f997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13de80dc0>]}
[0m01:30:27.871974 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:30:27.873146 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:30:27.883819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13e7ba37-b2c0-4196-a391-d7905594f997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13dfc06a0>]}
[0m01:30:27.884114 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m01:30:27.884296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13e7ba37-b2c0-4196-a391-d7905594f997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13dfc21a0>]}
[0m01:30:27.885303 [info ] [MainThread]: 
[0m01:30:27.885612 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:30:27.885818 [info ] [MainThread]: 
[0m01:30:27.886153 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:30:27.888775 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m01:30:27.889014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:28.422203 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m01:30:28.423611 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:30:28.772251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13e7ba37-b2c0-4196-a391-d7905594f997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d980dc0>]}
[0m01:30:28.773728 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:30:28.778599 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m01:30:28.779738 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m01:30:28.780492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m01:30:28.781065 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m01:30:28.794630 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m01:30:28.795866 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m01:30:28.825762 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m01:30:28.826577 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m01:30:28.826961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:29.385295 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:cd37b0f9-f1a9-49a0-91f6-44c6462e2dd1&page=queryresults
[0m01:30:30.072998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13e7ba37-b2c0-4196-a391-d7905594f997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13df1c6a0>]}
[0m01:30:30.073512 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.29s]
[0m01:30:30.073899 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m01:30:30.074156 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m01:30:30.074520 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m01:30:30.074837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m01:30:30.075081 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m01:30:30.077225 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m01:30:30.077792 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m01:30:30.079590 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m01:30:30.080141 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m01:30:30.080402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:30.614072 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:7f2c3be2-14cd-4e1c-a67f-93854fe774f1&page=queryresults
[0m01:30:31.129564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13e7ba37-b2c0-4196-a391-d7905594f997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f300d0>]}
[0m01:30:31.131112 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m01:30:31.132266 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m01:30:31.133276 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m01:30:31.134355 [info ] [Thread-1 (]: 3 of 6 START sql incremental model order_ad_data.fact_new_customer_orders ...... [RUN]
[0m01:30:31.135145 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m01:30:31.135746 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m01:30:31.141470 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:30:31.143046 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m01:30:31.196030 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:30:31.196729 [debug] [Thread-1 (]: On model.intermate_dbt.fact_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_new_customer_orders"} */

  
    

    create or replace table `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`
      
    
    

    OPTIONS()
    as (
      

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
)

SELECT
    order_id,
    customer_id,
    order_date,
    total_amount_eur,
    discount_code
FROM stg_shopify
WHERE order_date >= (SELECT COALESCE(MAX(order_date), '2000-01-01') FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)
    );
  
[0m01:30:31.197036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:31.740848 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:ae2177bf-e244-4513-83f8-68347f4bd34d&page=queryresults
[0m01:30:31.742468 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:ae2177bf-e244-4513-83f8-68347f4bd34d&page=queryresults
[0m01:30:31.752155 [debug] [Thread-1 (]: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.fact_new_customer_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:30:31.753326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13e7ba37-b2c0-4196-a391-d7905594f997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e0efa90>]}
[0m01:30:31.754369 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model order_ad_data.fact_new_customer_orders  [[31mERROR[0m in 0.62s]
[0m01:30:31.755266 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m01:30:31.756023 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_new_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.fact_new_customer_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql.
[0m01:30:31.757927 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m01:30:31.758486 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m01:30:31.759008 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m01:30:31.759455 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m01:30:31.760021 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m01:30:31.760608 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m01:30:31.761082 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m01:30:31.761598 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m01:30:31.762098 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m01:30:31.763267 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:30:31.764079 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:30:31.764486 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_new_customer_orders' was properly closed.
[0m01:30:31.765003 [info ] [MainThread]: 
[0m01:30:31.765421 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 3.88 seconds (3.88s).
[0m01:30:31.766674 [debug] [MainThread]: Command end result
[0m01:30:31.844784 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:30:31.845783 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:30:31.849519 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m01:30:31.849718 [info ] [MainThread]: 
[0m01:30:31.849912 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:30:31.850077 [info ] [MainThread]: 
[0m01:30:31.850278 [error] [MainThread]:   Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.fact_new_customer_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:30:31.850441 [info ] [MainThread]: 
[0m01:30:31.850602 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m01:30:31.852430 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.3226337, "process_in_blocks": "0", "process_kernel_time": 1.003673, "process_mem_max_rss": "218382336", "process_out_blocks": "0", "process_user_time": 2.676572}
[0m01:30:31.852645 [debug] [MainThread]: Command `dbt run` failed at 01:30:31.852605 after 5.32 seconds
[0m01:30:31.852848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108180880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e0cf640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e59fb50>]}
[0m01:30:31.853044 [debug] [MainThread]: Flushing usage events
[0m01:30:32.277064 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:32:07.219450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb08b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b01ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b017e0>]}


============================== 01:32:07.233203 | a3625ef9-d5ff-4fb3-983a-6e15dfa7885b ==============================
[0m01:32:07.233203 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:32:07.233572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:32:08.175529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3625ef9-d5ff-4fb3-983a-6e15dfa7885b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13113f3d0>]}
[0m01:32:08.204597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3625ef9-d5ff-4fb3-983a-6e15dfa7885b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1310f2ec0>]}
[0m01:32:08.205016 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:32:08.319035 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:32:08.394381 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:32:08.394768 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_new_customer_orders.sql
[0m01:32:08.521724 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.staging
- models.intermatedbt.marts
- models.intermatedbt.fact_tables
[0m01:32:08.529794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3625ef9-d5ff-4fb3-983a-6e15dfa7885b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131764fa0>]}
[0m01:32:08.576426 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:32:08.577871 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:32:08.588835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3625ef9-d5ff-4fb3-983a-6e15dfa7885b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1318d3460>]}
[0m01:32:08.589148 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m01:32:08.589334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3625ef9-d5ff-4fb3-983a-6e15dfa7885b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1318d2ce0>]}
[0m01:32:08.590767 [info ] [MainThread]: 
[0m01:32:08.591031 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:32:08.591188 [info ] [MainThread]: 
[0m01:32:08.591483 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:32:08.594022 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m01:32:08.594284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:32:09.238253 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m01:32:09.239686 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:32:09.841999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3625ef9-d5ff-4fb3-983a-6e15dfa7885b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad4670>]}
[0m01:32:09.843348 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:32:09.847797 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m01:32:09.848903 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m01:32:09.849650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m01:32:09.850224 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m01:32:09.863376 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m01:32:09.864422 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m01:32:09.894757 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m01:32:09.895625 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m01:32:09.896018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:10.512927 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:f6a25792-a07d-4783-bb03-c473f08455fb&page=queryresults
[0m01:32:11.063102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3625ef9-d5ff-4fb3-983a-6e15dfa7885b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1310ab070>]}
[0m01:32:11.063630 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m01:32:11.064006 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m01:32:11.064265 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m01:32:11.064611 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m01:32:11.064923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m01:32:11.065168 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m01:32:11.067246 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m01:32:11.067847 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m01:32:11.069557 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m01:32:11.070079 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m01:32:11.070319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:11.587890 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:7406d81f-3e6f-41d9-b758-f711a7c368df&page=queryresults
[0m01:32:12.122584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3625ef9-d5ff-4fb3-983a-6e15dfa7885b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131567070>]}
[0m01:32:12.123943 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m01:32:12.125504 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m01:32:12.126705 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m01:32:12.127675 [info ] [Thread-1 (]: 3 of 6 START sql incremental model order_ad_data.fact_new_customer_orders ...... [RUN]
[0m01:32:12.128399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m01:32:12.128970 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m01:32:12.135474 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:32:12.136865 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m01:32:12.189887 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:32:12.190648 [debug] [Thread-1 (]: On model.intermate_dbt.fact_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_new_customer_orders"} */

  
    

    create or replace table `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`
      
    
    

    OPTIONS()
    as (
      

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
)

SELECT
    order_id,
    customer_id,
    order_date,
    total_amount_eur,
    discount_code
FROM stg_shopify
WHERE order_date >= (
    SELECT COALESCE(MAX(order_date), '2000-01-01')
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`
)


    );
  
[0m01:32:12.190969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:12.611620 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:aebd366e-4d96-49b6-a081-e7c79e2d76e4&page=queryresults
[0m01:32:12.613360 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:aebd366e-4d96-49b6-a081-e7c79e2d76e4&page=queryresults
[0m01:32:12.622585 [debug] [Thread-1 (]: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.fact_new_customer_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:32:12.623640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3625ef9-d5ff-4fb3-983a-6e15dfa7885b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131567be0>]}
[0m01:32:12.624647 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model order_ad_data.fact_new_customer_orders  [[31mERROR[0m in 0.50s]
[0m01:32:12.625505 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m01:32:12.626362 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_new_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.fact_new_customer_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql.
[0m01:32:12.628342 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m01:32:12.629014 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m01:32:12.629550 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m01:32:12.630006 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m01:32:12.630561 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m01:32:12.631211 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m01:32:12.631720 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m01:32:12.632260 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m01:32:12.632808 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m01:32:12.633899 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:32:12.634636 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:32:12.635152 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_new_customer_orders' was properly closed.
[0m01:32:12.635731 [info ] [MainThread]: 
[0m01:32:12.636231 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 4.04 seconds (4.04s).
[0m01:32:12.637606 [debug] [MainThread]: Command end result
[0m01:32:12.718109 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:32:12.719852 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:32:12.723591 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m01:32:12.723797 [info ] [MainThread]: 
[0m01:32:12.724001 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:32:12.724171 [info ] [MainThread]: 
[0m01:32:12.724376 [error] [MainThread]:   Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Not found: Table atomic-sled-453015-g3:order_ad_data.fact_new_customer_orders was not found in location US
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:32:12.724541 [info ] [MainThread]: 
[0m01:32:12.724708 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m01:32:12.727774 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.5493665, "process_in_blocks": "0", "process_kernel_time": 0.912488, "process_mem_max_rss": "215367680", "process_out_blocks": "0", "process_user_time": 2.733876}
[0m01:32:12.728131 [debug] [MainThread]: Command `dbt run` failed at 01:32:12.728082 after 5.55 seconds
[0m01:32:12.728366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb08b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13185c670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1369be020>]}
[0m01:32:12.728581 [debug] [MainThread]: Flushing usage events
[0m01:32:13.215690 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:35:03.653598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105778970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c9e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c9750>]}


============================== 01:35:03.663056 | ca313896-0a87-4d66-b92a-aa9cb891f48e ==============================
[0m01:35:03.663056 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:35:03.663446 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:35:04.773504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca313896-0a87-4d66-b92a-aa9cb891f48e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c90a7d0>]}
[0m01:35:04.804067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca313896-0a87-4d66-b92a-aa9cb891f48e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10659efb0>]}
[0m01:35:04.804615 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:35:04.919272 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:35:04.996665 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:35:04.997062 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_new_customer_orders.sql
[0m01:35:05.121453 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.marts
- models.intermatedbt.staging
- models.intermatedbt.fact_tables
[0m01:35:05.129678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca313896-0a87-4d66-b92a-aa9cb891f48e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cf65c90>]}
[0m01:35:05.173203 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:35:05.174630 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:35:05.185216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca313896-0a87-4d66-b92a-aa9cb891f48e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cb16380>]}
[0m01:35:05.185534 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m01:35:05.185722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca313896-0a87-4d66-b92a-aa9cb891f48e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cb16800>]}
[0m01:35:05.186781 [info ] [MainThread]: 
[0m01:35:05.187041 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:35:05.187269 [info ] [MainThread]: 
[0m01:35:05.187650 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:35:05.190308 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m01:35:05.190575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:35:05.805724 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m01:35:05.807067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:35:06.153639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca313896-0a87-4d66-b92a-aa9cb891f48e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10475ca00>]}
[0m01:35:06.154732 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:35:06.159250 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m01:35:06.160318 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m01:35:06.161133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m01:35:06.161750 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m01:35:06.174551 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m01:35:06.175835 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m01:35:06.206710 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m01:35:06.207523 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m01:35:06.207907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:35:06.756994 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:7fcc1a67-1caa-47ab-b317-7c9f7bdf5e9f&page=queryresults
[0m01:35:07.471529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca313896-0a87-4d66-b92a-aa9cb891f48e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c8aac50>]}
[0m01:35:07.472043 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.31s]
[0m01:35:07.475527 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m01:35:07.475800 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m01:35:07.476143 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m01:35:07.476441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m01:35:07.476669 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m01:35:07.479076 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m01:35:07.479787 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m01:35:07.481697 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m01:35:07.482268 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m01:35:07.482540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:35:07.974014 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:2a3f5991-4f72-4ded-9bf8-ea514e0bc7e2&page=queryresults
[0m01:35:08.635553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca313896-0a87-4d66-b92a-aa9cb891f48e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c8aac50>]}
[0m01:35:08.637190 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m01:35:08.638408 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m01:35:08.640045 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m01:35:08.641138 [info ] [Thread-1 (]: 3 of 6 START sql incremental model order_ad_data.fact_new_customer_orders ...... [RUN]
[0m01:35:08.641919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m01:35:08.642506 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m01:35:08.648309 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:35:08.649856 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m01:35:08.687108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:35:09.045285 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:35:09.046354 [debug] [Thread-1 (]: On model.intermate_dbt.fact_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_new_customer_orders"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders` as DBT_INTERNAL_DEST
        using (

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
)

SELECT
    order_id,
    customer_id,
    order_date,
    total_amount_eur,
    discount_code
FROM stg_shopify
WHERE order_date >= (SELECT COALESCE(MAX(order_date), '2000-01-01') FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id))

    
    when matched then update set
        
    

    when not matched then insert
        ()
    values
        ()


    
[0m01:35:09.756389 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:0bec8300-2430-47f2-865d-3a257d74f3c7&page=queryresults
[0m01:35:09.758067 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:0bec8300-2430-47f2-865d-3a257d74f3c7&page=queryresults
[0m01:35:09.767381 [debug] [Thread-1 (]: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Expected "(" but got keyword WHEN at [39:5]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:35:09.768430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca313896-0a87-4d66-b92a-aa9cb891f48e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d25c2e0>]}
[0m01:35:09.769633 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model order_ad_data.fact_new_customer_orders  [[31mERROR[0m in 1.13s]
[0m01:35:09.770622 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m01:35:09.771399 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_new_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Expected "(" but got keyword WHEN at [39:5]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql.
[0m01:35:09.773404 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m01:35:09.774160 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m01:35:09.774823 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m01:35:09.775398 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m01:35:09.775984 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m01:35:09.776471 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m01:35:09.776911 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m01:35:09.777375 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m01:35:09.777861 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m01:35:09.778951 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:35:09.779662 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:35:09.780021 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_new_customer_orders' was properly closed.
[0m01:35:09.780506 [info ] [MainThread]: 
[0m01:35:09.780911 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 4.59 seconds (4.59s).
[0m01:35:09.782093 [debug] [MainThread]: Command end result
[0m01:35:09.861173 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:35:09.862171 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:35:09.865638 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m01:35:09.865825 [info ] [MainThread]: 
[0m01:35:09.866027 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:35:09.866193 [info ] [MainThread]: 
[0m01:35:09.866397 [error] [MainThread]:   Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Expected "(" but got keyword WHEN at [39:5]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:35:09.866562 [info ] [MainThread]: 
[0m01:35:09.866729 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m01:35:09.868613 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.2599273, "process_in_blocks": "0", "process_kernel_time": 1.137355, "process_mem_max_rss": "210206720", "process_out_blocks": "0", "process_user_time": 2.791713}
[0m01:35:09.868873 [debug] [MainThread]: Command `dbt run` failed at 01:35:09.868827 after 6.26 seconds
[0m01:35:09.869086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105778970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d0ccc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d681b40>]}
[0m01:35:09.869286 [debug] [MainThread]: Flushing usage events
[0m01:35:10.345957 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:36:27.076831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036488e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104499ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044997e0>]}


============================== 01:36:27.080640 | 434f3a63-4bcc-41d9-b7ec-7cf188319382 ==============================
[0m01:36:27.080640 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:36:27.081013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'profiles_dir': '/Users/victoruwaje/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:36:27.945720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '434f3a63-4bcc-41d9-b7ec-7cf188319382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f0b610>]}
[0m01:36:27.973685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '434f3a63-4bcc-41d9-b7ec-7cf188319382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042cfa00>]}
[0m01:36:27.974073 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:36:28.082320 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:36:28.157694 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:36:28.158103 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_new_customer_orders.sql
[0m01:36:28.282268 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.staging
- models.intermatedbt.fact_tables
- models.intermatedbt.marts
[0m01:36:28.289900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '434f3a63-4bcc-41d9-b7ec-7cf188319382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1226d20b0>]}
[0m01:36:28.331997 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:36:28.333342 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:36:28.344250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '434f3a63-4bcc-41d9-b7ec-7cf188319382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1227335b0>]}
[0m01:36:28.344582 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m01:36:28.344768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '434f3a63-4bcc-41d9-b7ec-7cf188319382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1225809a0>]}
[0m01:36:28.345699 [info ] [MainThread]: 
[0m01:36:28.345904 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:36:28.346071 [info ] [MainThread]: 
[0m01:36:28.346341 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:36:28.348668 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m01:36:28.348898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:36:28.914911 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m01:36:28.915492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:36:29.325852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '434f3a63-4bcc-41d9-b7ec-7cf188319382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10446c670>]}
[0m01:36:29.327423 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:36:29.332841 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m01:36:29.333808 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m01:36:29.334611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m01:36:29.335184 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m01:36:29.348223 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m01:36:29.349579 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m01:36:29.379603 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m01:36:29.380634 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m01:36:29.381026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:36:29.939690 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:aa358345-3693-4368-aae4-926bfa05bc8a&page=queryresults
[0m01:36:30.525947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '434f3a63-4bcc-41d9-b7ec-7cf188319382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ea9540>]}
[0m01:36:30.526454 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.19s]
[0m01:36:30.527006 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m01:36:30.527263 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m01:36:30.527600 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m01:36:30.527867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m01:36:30.528087 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m01:36:30.530163 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m01:36:30.530860 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m01:36:30.532716 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m01:36:30.533214 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m01:36:30.533533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:36:31.680109 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:6b57b0b4-5bed-4ae5-bd59-e5774024e015&page=queryresults
[0m01:36:32.296631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '434f3a63-4bcc-41d9-b7ec-7cf188319382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1225651e0>]}
[0m01:36:32.298432 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.77s]
[0m01:36:32.299709 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m01:36:32.300811 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m01:36:32.301680 [info ] [Thread-1 (]: 3 of 6 START sql incremental model order_ad_data.fact_new_customer_orders ...... [RUN]
[0m01:36:32.302473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m01:36:32.303058 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m01:36:32.311955 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:36:32.313747 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m01:36:32.347649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:36:32.748048 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:36:32.750135 [debug] [Thread-1 (]: On model.intermate_dbt.fact_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_new_customer_orders"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders` as DBT_INTERNAL_DEST
        using (

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
)

SELECT
    order_id,
    customer_id,
    order_date,
    total_amount_eur,
    discount_code
FROM stg_shopify
WHERE order_date >= (
    SELECT COALESCE(MAX(order_date), '2000-01-01')
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`
)


    -- For incremental runs, you want to filter only the new or changed rows
    AND order_date > (SELECT MAX(order_date) FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)

        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id))

    
    when matched then update set
        
    

    when not matched then insert
        ()
    values
        ()


    
[0m01:36:33.018467 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:72f435d9-ef79-42fb-847b-f79ff52fb555&page=queryresults
[0m01:36:33.020660 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:72f435d9-ef79-42fb-847b-f79ff52fb555&page=queryresults
[0m01:36:33.031181 [debug] [Thread-1 (]: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Expected "(" but got keyword WHEN at [47:5]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:36:33.032199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '434f3a63-4bcc-41d9-b7ec-7cf188319382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1226e97e0>]}
[0m01:36:33.033224 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model order_ad_data.fact_new_customer_orders  [[31mERROR[0m in 0.73s]
[0m01:36:33.034111 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m01:36:33.035045 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_new_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Expected "(" but got keyword WHEN at [47:5]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql.
[0m01:36:33.036997 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m01:36:33.037599 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m01:36:33.038142 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m01:36:33.038608 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m01:36:33.039136 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m01:36:33.039662 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m01:36:33.040119 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m01:36:33.040632 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m01:36:33.041133 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m01:36:33.042311 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:36:33.043085 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:36:33.043478 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_new_customer_orders' was properly closed.
[0m01:36:33.043987 [info ] [MainThread]: 
[0m01:36:33.044406 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 4.70 seconds (4.70s).
[0m01:36:33.045659 [debug] [MainThread]: Command end result
[0m01:36:33.124874 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:36:33.125806 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:36:33.129210 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m01:36:33.129393 [info ] [MainThread]: 
[0m01:36:33.129587 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:36:33.129749 [info ] [MainThread]: 
[0m01:36:33.129950 [error] [MainThread]:   Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Expected "(" but got keyword WHEN at [47:5]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:36:33.130111 [info ] [MainThread]: 
[0m01:36:33.130273 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m01:36:33.132204 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.0957284, "process_in_blocks": "0", "process_kernel_time": 1.153589, "process_mem_max_rss": "220332032", "process_out_blocks": "0", "process_user_time": 2.660302}
[0m01:36:33.132434 [debug] [MainThread]: Command `dbt run` failed at 01:36:33.132392 after 6.10 seconds
[0m01:36:33.132641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036488e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1230b5e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1230b5d20>]}
[0m01:36:33.132836 [debug] [MainThread]: Flushing usage events
[0m01:36:33.676551 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:39:39.631322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071fc8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108056170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108056830>]}


============================== 01:39:39.636341 | d7c37961-c78b-422f-8432-234b570c23ba ==============================
[0m01:39:39.636341 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:39:39.636690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'profiles_dir': '/Users/victoruwaje/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:39:40.520013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7c37961-c78b-422f-8432-234b570c23ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121d3f3d0>]}
[0m01:39:40.547808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7c37961-c78b-422f-8432-234b570c23ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121cf2ec0>]}
[0m01:39:40.548183 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:39:40.658325 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:39:40.730047 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:39:40.730416 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_new_customer_orders.sql
[0m01:39:40.854739 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.staging
- models.intermatedbt.fact_tables
- models.intermatedbt.marts
[0m01:39:40.862446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7c37961-c78b-422f-8432-234b570c23ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122564fa0>]}
[0m01:39:40.904064 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:39:40.905321 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:39:40.915806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7c37961-c78b-422f-8432-234b570c23ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1226d7460>]}
[0m01:39:40.916148 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m01:39:40.916339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7c37961-c78b-422f-8432-234b570c23ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1226d6ce0>]}
[0m01:39:40.917331 [info ] [MainThread]: 
[0m01:39:40.917536 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:39:40.917686 [info ] [MainThread]: 
[0m01:39:40.917960 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:39:40.920434 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m01:39:40.920704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:39:41.494709 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m01:39:41.496332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:39:41.840986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7c37961-c78b-422f-8432-234b570c23ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108020670>]}
[0m01:39:41.842320 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:39:41.847540 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m01:39:41.848396 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m01:39:41.849125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m01:39:41.849703 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m01:39:41.863198 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m01:39:41.864348 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m01:39:41.893855 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m01:39:41.898652 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m01:39:41.902568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:39:42.554506 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:26e685e3-a6bb-4052-bcd8-4ee2965e68e1&page=queryresults
[0m01:39:43.115982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7c37961-c78b-422f-8432-234b570c23ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121cab070>]}
[0m01:39:43.116557 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.27s]
[0m01:39:43.116967 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m01:39:43.117243 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m01:39:43.117639 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m01:39:43.117977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m01:39:43.118236 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m01:39:43.120402 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m01:39:43.120926 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m01:39:43.122711 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m01:39:43.123146 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m01:39:43.123410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:39:43.680374 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:42275b94-4045-419e-846a-f60be001e24e&page=queryresults
[0m01:39:44.149456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7c37961-c78b-422f-8432-234b570c23ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122267070>]}
[0m01:39:44.151091 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m01:39:44.152235 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m01:39:44.153528 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m01:39:44.155028 [info ] [Thread-1 (]: 3 of 6 START sql incremental model order_ad_data.fact_new_customer_orders ...... [RUN]
[0m01:39:44.156051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m01:39:44.156655 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m01:39:44.166089 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:39:44.167287 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m01:39:44.212676 [debug] [Thread-1 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m01:39:44.213276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:39:44.644398 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:39:44.645617 [debug] [Thread-1 (]: On model.intermate_dbt.fact_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_new_customer_orders"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders` as DBT_INTERNAL_DEST
        using (

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
)

SELECT
    order_id,
    customer_id,
    order_date,
    total_amount_eur,
    discount_code
FROM stg_shopify
WHERE order_date >= (SELECT COALESCE(MAX(order_date), '2000-01-01') FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)


    AND order_date > (SELECT MAX(order_date) FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)

        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id))

    
    when matched then update set
        
    

    when not matched then insert
        ()
    values
        ()


    
[0m01:39:44.909420 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:31041649-5509-4850-97b9-2eb8a0ef2b3f&page=queryresults
[0m01:39:44.911478 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:31041649-5509-4850-97b9-2eb8a0ef2b3f&page=queryresults
[0m01:39:44.920640 [debug] [Thread-1 (]: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Expected "(" but got keyword WHEN at [43:5]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:39:44.921715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7c37961-c78b-422f-8432-234b570c23ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1226e9540>]}
[0m01:39:44.922739 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model order_ad_data.fact_new_customer_orders  [[31mERROR[0m in 0.77s]
[0m01:39:44.923619 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m01:39:44.924484 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_new_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Expected "(" but got keyword WHEN at [43:5]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql.
[0m01:39:44.926152 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m01:39:44.926903 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m01:39:44.927624 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m01:39:44.928226 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m01:39:44.928755 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m01:39:44.929268 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m01:39:44.929717 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m01:39:44.930204 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m01:39:44.930685 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m01:39:44.931791 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:39:44.932514 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:39:44.932874 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_new_customer_orders' was properly closed.
[0m01:39:44.933355 [info ] [MainThread]: 
[0m01:39:44.933747 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 4.02 seconds (4.02s).
[0m01:39:44.934994 [debug] [MainThread]: Command end result
[0m01:39:45.010718 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:39:45.011704 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:39:45.015296 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m01:39:45.015510 [info ] [MainThread]: 
[0m01:39:45.015715 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:39:45.015888 [info ] [MainThread]: 
[0m01:39:45.016089 [error] [MainThread]:   Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Expected "(" but got keyword WHEN at [43:5]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:39:45.016255 [info ] [MainThread]: 
[0m01:39:45.016427 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m01:39:45.018506 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.425661, "process_in_blocks": "0", "process_kernel_time": 0.965181, "process_mem_max_rss": "221167616", "process_out_blocks": "0", "process_user_time": 2.953019}
[0m01:39:45.018746 [debug] [MainThread]: Command `dbt run` failed at 01:39:45.018703 after 5.43 seconds
[0m01:39:45.018963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071fc8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12265c670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122cb5e40>]}
[0m01:39:45.019167 [debug] [MainThread]: Flushing usage events
[0m01:39:45.623514 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:40:12.822774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a80910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109395e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109395780>]}


============================== 01:40:12.826636 | 975a7b59-5c9b-452f-9f91-3e001557e3c4 ==============================
[0m01:40:12.826636 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:40:12.826976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:40:13.683063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '975a7b59-5c9b-452f-9f91-3e001557e3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f9082b0>]}
[0m01:40:13.710938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '975a7b59-5c9b-452f-9f91-3e001557e3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d22950>]}
[0m01:40:13.711334 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:40:13.824100 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:40:13.897346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:40:13.897751 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_new_customer_orders.sql
[0m01:40:14.021791 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.staging
- models.intermatedbt.fact_tables
- models.intermatedbt.marts
[0m01:40:14.029462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '975a7b59-5c9b-452f-9f91-3e001557e3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1460f14b0>]}
[0m01:40:14.071148 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:40:14.072349 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:40:14.083102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '975a7b59-5c9b-452f-9f91-3e001557e3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146130190>]}
[0m01:40:14.083438 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m01:40:14.083626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '975a7b59-5c9b-452f-9f91-3e001557e3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146132fb0>]}
[0m01:40:14.084578 [info ] [MainThread]: 
[0m01:40:14.084786 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:40:14.084947 [info ] [MainThread]: 
[0m01:40:14.085219 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:40:14.087916 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m01:40:14.088199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:14.612924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m01:40:14.614062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:40:15.001238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '975a7b59-5c9b-452f-9f91-3e001557e3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109368670>]}
[0m01:40:15.002757 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:40:15.007364 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m01:40:15.008267 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m01:40:15.009020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m01:40:15.009585 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m01:40:15.023611 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m01:40:15.024773 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m01:40:15.054142 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m01:40:15.054942 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m01:40:15.055318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:40:15.548916 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:50bdf50d-762e-419a-947d-47f7e920a234&page=queryresults
[0m01:40:16.144736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '975a7b59-5c9b-452f-9f91-3e001557e3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f8a9900>]}
[0m01:40:16.145283 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m01:40:16.145705 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m01:40:16.145980 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m01:40:16.146327 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m01:40:16.146627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m01:40:16.146863 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m01:40:16.149108 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m01:40:16.149617 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m01:40:16.151395 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m01:40:16.151820 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m01:40:16.152073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:40:16.765809 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:04a02633-0066-4c0c-8cb8-fa07e1f7131e&page=queryresults
[0m01:40:17.242136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '975a7b59-5c9b-452f-9f91-3e001557e3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f8a9900>]}
[0m01:40:17.244046 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m01:40:17.245462 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m01:40:17.246615 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m01:40:17.247469 [info ] [Thread-1 (]: 3 of 6 START sql incremental model order_ad_data.fact_new_customer_orders ...... [RUN]
[0m01:40:17.248301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m01:40:17.248998 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m01:40:17.257928 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:40:17.259035 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m01:40:17.293214 [debug] [Thread-1 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m01:40:17.293766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:40:18.042755 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:40:18.043886 [debug] [Thread-1 (]: On model.intermate_dbt.fact_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_new_customer_orders"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders` as DBT_INTERNAL_DEST
        using (

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
)

SELECT
    order_id,
    customer_id,
    order_date,
    total_amount_eur,
    discount_code
FROM stg_shopify
WHERE order_date >= (SELECT COALESCE(MAX(order_date), '2000-01-01') FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)


    AND order_date > (SELECT MAX(order_date) FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        ()
    values
        ()


    
[0m01:40:18.289523 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:8d51ea76-befe-4acb-b270-a2435ac9a9dc&page=queryresults
[0m01:40:18.291278 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:8d51ea76-befe-4acb-b270-a2435ac9a9dc&page=queryresults
[0m01:40:18.300250 [debug] [Thread-1 (]: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [36:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:40:18.301373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '975a7b59-5c9b-452f-9f91-3e001557e3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1460f2170>]}
[0m01:40:18.302398 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model order_ad_data.fact_new_customer_orders  [[31mERROR[0m in 1.05s]
[0m01:40:18.303282 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m01:40:18.304109 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_new_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [36:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql.
[0m01:40:18.306237 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m01:40:18.306966 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m01:40:18.307508 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m01:40:18.307984 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m01:40:18.308488 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m01:40:18.308971 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m01:40:18.309401 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m01:40:18.309929 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m01:40:18.310488 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m01:40:18.311588 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:40:18.312389 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:40:18.312791 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_new_customer_orders' was properly closed.
[0m01:40:18.313305 [info ] [MainThread]: 
[0m01:40:18.313729 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 4.23 seconds (4.23s).
[0m01:40:18.315097 [debug] [MainThread]: Command end result
[0m01:40:18.393432 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:40:18.394406 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:40:18.398104 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m01:40:18.398317 [info ] [MainThread]: 
[0m01:40:18.398521 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:40:18.398695 [info ] [MainThread]: 
[0m01:40:18.398901 [error] [MainThread]:   Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [36:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:40:18.399064 [info ] [MainThread]: 
[0m01:40:18.399229 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m01:40:18.401195 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.618581, "process_in_blocks": "0", "process_kernel_time": 1.170146, "process_mem_max_rss": "219807744", "process_out_blocks": "0", "process_user_time": 2.635744}
[0m01:40:18.401446 [debug] [MainThread]: Command `dbt run` failed at 01:40:18.401400 after 5.62 seconds
[0m01:40:18.401666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a80910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14612f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14605f940>]}
[0m01:40:18.401862 [debug] [MainThread]: Flushing usage events
[0m01:40:18.832349 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:40:51.170592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041bc8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10500de70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10500d7b0>]}


============================== 01:40:51.174899 | 2236965b-3d42-4a3b-a5a3-47fe1298addd ==============================
[0m01:40:51.174899 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:40:51.175244 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:40:52.110157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2236965b-3d42-4a3b-a5a3-47fe1298addd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13140b610>]}
[0m01:40:52.138092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2236965b-3d42-4a3b-a5a3-47fe1298addd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e43a30>]}
[0m01:40:52.138499 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:40:52.254694 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:40:52.326409 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:40:52.326773 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_new_customer_orders.sql
[0m01:40:52.451137 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.marts
- models.intermatedbt.fact_tables
- models.intermatedbt.staging
[0m01:40:52.459120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2236965b-3d42-4a3b-a5a3-47fe1298addd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131bd20b0>]}
[0m01:40:52.500822 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:40:52.502110 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:40:52.511731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2236965b-3d42-4a3b-a5a3-47fe1298addd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131c2f5b0>]}
[0m01:40:52.512041 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m01:40:52.512228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2236965b-3d42-4a3b-a5a3-47fe1298addd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131a809a0>]}
[0m01:40:52.513154 [info ] [MainThread]: 
[0m01:40:52.513350 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:40:52.513511 [info ] [MainThread]: 
[0m01:40:52.513778 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:40:52.516112 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m01:40:52.516335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:53.010726 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m01:40:53.012286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:40:53.329107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2236965b-3d42-4a3b-a5a3-47fe1298addd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe0640>]}
[0m01:40:53.330775 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:40:53.336884 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m01:40:53.337931 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m01:40:53.338708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m01:40:53.339290 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m01:40:53.352301 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m01:40:53.353361 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m01:40:53.383333 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m01:40:53.384212 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m01:40:53.384599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:40:53.983281 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:3e5d6832-6da2-4dbf-a9df-f96575a0ad9a&page=queryresults
[0m01:40:54.495060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2236965b-3d42-4a3b-a5a3-47fe1298addd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1312a9660>]}
[0m01:40:54.495618 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m01:40:54.496033 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m01:40:54.496341 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m01:40:54.496713 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m01:40:54.497040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m01:40:54.497274 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m01:40:54.499411 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m01:40:54.500075 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m01:40:54.501887 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m01:40:54.502347 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m01:40:54.502617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:40:55.055592 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:faece126-cae6-4667-9ad7-637bfef03761&page=queryresults
[0m01:40:55.774713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2236965b-3d42-4a3b-a5a3-47fe1298addd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131a651e0>]}
[0m01:40:55.776215 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m01:40:55.777117 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m01:40:55.778101 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m01:40:55.779219 [info ] [Thread-1 (]: 3 of 6 START sql incremental model order_ad_data.fact_new_customer_orders ...... [RUN]
[0m01:40:55.780044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m01:40:55.780654 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m01:40:55.789571 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:40:55.790991 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m01:40:55.824411 [debug] [Thread-1 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m01:40:55.824970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:40:56.217203 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:40:56.218291 [debug] [Thread-1 (]: On model.intermate_dbt.fact_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_new_customer_orders"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders` as DBT_INTERNAL_DEST
        using (

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
)

SELECT
    order_id,
    customer_id,
    order_date,
    total_amount_eur,
    discount_code
FROM stg_shopify
WHERE order_date >= (SELECT COALESCE(MAX(order_date), '2000-01-01') FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)


    AND order_date > (SELECT MAX(order_date) FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        ()
    values
        ()


    
[0m01:40:56.456730 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:23ef0fd8-4e9a-4382-afec-afa5b5805f27&page=queryresults
[0m01:40:56.458489 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:23ef0fd8-4e9a-4382-afec-afa5b5805f27&page=queryresults
[0m01:40:56.469093 [debug] [Thread-1 (]: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [36:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:40:56.470165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2236965b-3d42-4a3b-a5a3-47fe1298addd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131be8340>]}
[0m01:40:56.471184 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model order_ad_data.fact_new_customer_orders  [[31mERROR[0m in 0.69s]
[0m01:40:56.472045 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m01:40:56.472894 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_new_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [36:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql.
[0m01:40:56.474662 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m01:40:56.475336 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m01:40:56.475857 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m01:40:56.476312 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m01:40:56.476797 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m01:40:56.477282 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m01:40:56.477721 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m01:40:56.478181 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m01:40:56.478658 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m01:40:56.479736 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:40:56.480469 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:40:56.480827 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_new_customer_orders' was properly closed.
[0m01:40:56.481398 [info ] [MainThread]: 
[0m01:40:56.481810 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 3.97 seconds (3.97s).
[0m01:40:56.483013 [debug] [MainThread]: Command end result
[0m01:40:56.561496 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:40:56.562470 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:40:56.566120 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m01:40:56.566306 [info ] [MainThread]: 
[0m01:40:56.566508 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:40:56.566677 [info ] [MainThread]: 
[0m01:40:56.566876 [error] [MainThread]:   Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [36:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:40:56.567037 [info ] [MainThread]: 
[0m01:40:56.567206 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m01:40:56.569320 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.4425225, "process_in_blocks": "0", "process_kernel_time": 1.144111, "process_mem_max_rss": "220889088", "process_out_blocks": "0", "process_user_time": 2.702041}
[0m01:40:56.569667 [debug] [MainThread]: Command `dbt run` failed at 01:40:56.569620 after 5.44 seconds
[0m01:40:56.570002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041bc8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1321ab1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1321a9c90>]}
[0m01:40:56.570252 [debug] [MainThread]: Flushing usage events
[0m01:40:56.989883 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:41:52.211515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078808e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111195ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111957e0>]}


============================== 01:41:52.222714 | 6c782351-515d-4ec4-a0f4-1f1d6b46b9db ==============================
[0m01:41:52.222714 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:41:52.223088 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:41:53.086120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c782351-515d-4ec4-a0f4-1f1d6b46b9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146343040>]}
[0m01:41:53.114586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c782351-515d-4ec4-a0f4-1f1d6b46b9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b5d540>]}
[0m01:41:53.114973 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:41:53.225497 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:41:53.302498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:41:53.302897 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_new_customer_orders.sql
[0m01:41:53.429870 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.marts
- models.intermatedbt.fact_tables
- models.intermatedbt.staging
[0m01:41:53.438407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c782351-515d-4ec4-a0f4-1f1d6b46b9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146aa9960>]}
[0m01:41:53.483988 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:41:53.485730 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:41:53.496797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c782351-515d-4ec4-a0f4-1f1d6b46b9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146ce9c00>]}
[0m01:41:53.497129 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m01:41:53.497330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c782351-515d-4ec4-a0f4-1f1d6b46b9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146a71c90>]}
[0m01:41:53.498287 [info ] [MainThread]: 
[0m01:41:53.498484 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:41:53.498645 [info ] [MainThread]: 
[0m01:41:53.498907 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:41:53.501372 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m01:41:53.501644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:41:53.942291 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m01:41:53.943404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:41:54.344521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c782351-515d-4ec4-a0f4-1f1d6b46b9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111168670>]}
[0m01:41:54.345608 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:41:54.351122 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m01:41:54.352138 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m01:41:54.352905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m01:41:54.353471 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m01:41:54.366906 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m01:41:54.368070 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m01:41:54.398830 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m01:41:54.399861 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m01:41:54.400265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:54.957837 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:0e105df7-820a-4fb4-b47b-61ec5f12ac52&page=queryresults
[0m01:41:55.849888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c782351-515d-4ec4-a0f4-1f1d6b46b9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1462b3070>]}
[0m01:41:55.850415 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.50s]
[0m01:41:55.850810 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m01:41:55.851067 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m01:41:55.851398 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m01:41:55.851676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m01:41:55.851901 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m01:41:55.854091 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m01:41:55.854539 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m01:41:55.856251 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m01:41:55.856777 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m01:41:55.857015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:56.449342 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:98e0a89d-d779-49a7-9f2e-bf92fa789757&page=queryresults
[0m01:41:57.009455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c782351-515d-4ec4-a0f4-1f1d6b46b9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146ce9cf0>]}
[0m01:41:57.011123 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m01:41:57.011994 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m01:41:57.012924 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m01:41:57.013575 [info ] [Thread-1 (]: 3 of 6 START sql incremental model order_ad_data.fact_new_customer_orders ...... [RUN]
[0m01:41:57.014113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m01:41:57.014510 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m01:41:57.021078 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:41:57.022386 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m01:41:57.058638 [debug] [Thread-1 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m01:41:57.059294 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:57.455898 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:41:57.457103 [debug] [Thread-1 (]: On model.intermate_dbt.fact_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_new_customer_orders"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders` as DBT_INTERNAL_DEST
        using (

WITH stg_shopify AS (SELECT * FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`)

SELECT
    order_id,
    customer_id,
    order_date,
    total_amount_eur,
    discount_code
FROM stg_shopify
WHERE order_date >= (SELECT COALESCE(MAX(order_date), '2000-01-01') FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)


    AND order_date > (SELECT MAX(order_date) FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        ()
    values
        ()


    
[0m01:41:57.721504 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:2745cfe1-5e03-48f9-bef1-5c71920c1eb0&page=queryresults
[0m01:41:57.723257 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:2745cfe1-5e03-48f9-bef1-5c71920c1eb0&page=queryresults
[0m01:41:57.733460 [debug] [Thread-1 (]: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [33:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:41:57.734404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c782351-515d-4ec4-a0f4-1f1d6b46b9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146e4d060>]}
[0m01:41:57.735408 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model order_ad_data.fact_new_customer_orders  [[31mERROR[0m in 0.72s]
[0m01:41:57.736273 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m01:41:57.737010 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_new_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [33:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql.
[0m01:41:57.738854 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m01:41:57.739616 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m01:41:57.740139 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m01:41:57.740588 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m01:41:57.741095 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m01:41:57.741567 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m01:41:57.742007 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m01:41:57.742477 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m01:41:57.742975 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m01:41:57.744430 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:41:57.745232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:41:57.745630 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_new_customer_orders' was properly closed.
[0m01:41:57.746161 [info ] [MainThread]: 
[0m01:41:57.746580 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 4.25 seconds (4.25s).
[0m01:41:57.748279 [debug] [MainThread]: Command end result
[0m01:41:57.827875 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:41:57.828815 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:41:57.832283 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m01:41:57.832468 [info ] [MainThread]: 
[0m01:41:57.832667 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:41:57.832831 [info ] [MainThread]: 
[0m01:41:57.833026 [error] [MainThread]:   Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [33:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:41:57.833187 [info ] [MainThread]: 
[0m01:41:57.833349 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m01:41:57.835192 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.665752, "process_in_blocks": "0", "process_kernel_time": 1.21104, "process_mem_max_rss": "218988544", "process_out_blocks": "0", "process_user_time": 2.642912}
[0m01:41:57.835494 [debug] [MainThread]: Command `dbt run` failed at 01:41:57.835443 after 5.67 seconds
[0m01:41:57.835728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078808e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146cd47f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146cd5ab0>]}
[0m01:41:57.835944 [debug] [MainThread]: Flushing usage events
[0m01:41:58.306950 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:43:54.554833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aa48b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f5ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f57e0>]}


============================== 01:43:54.563072 | 66dba905-1faf-4a7b-80f3-f0ef2e592c1d ==============================
[0m01:43:54.563072 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:43:54.563464 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:43:55.475716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66dba905-1faf-4a7b-80f3-f0ef2e592c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12283f3d0>]}
[0m01:43:55.503651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66dba905-1faf-4a7b-80f3-f0ef2e592c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117df2ec0>]}
[0m01:43:55.504041 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:43:55.613565 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:43:55.689694 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:43:55.690102 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_new_customer_orders.sql
[0m01:43:55.813423 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.fact_tables
- models.intermatedbt.staging
- models.intermatedbt.marts
[0m01:43:55.821517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66dba905-1faf-4a7b-80f3-f0ef2e592c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126fd3940>]}
[0m01:43:55.864365 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:43:55.865698 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:43:55.877242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66dba905-1faf-4a7b-80f3-f0ef2e592c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126febf40>]}
[0m01:43:55.877556 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m01:43:55.877742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66dba905-1faf-4a7b-80f3-f0ef2e592c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122dda440>]}
[0m01:43:55.878657 [info ] [MainThread]: 
[0m01:43:55.878862 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:43:55.879017 [info ] [MainThread]: 
[0m01:43:55.879285 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:43:55.881696 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m01:43:55.881959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:43:56.415214 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m01:43:56.417676 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:43:56.780711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66dba905-1faf-4a7b-80f3-f0ef2e592c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c8670>]}
[0m01:43:56.782510 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:43:56.787948 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m01:43:56.788899 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m01:43:56.789671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m01:43:56.790228 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m01:43:56.802952 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m01:43:56.804201 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m01:43:56.833719 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m01:43:56.834737 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m01:43:56.835108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:57.494563 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:aaddd505-9f10-40ed-bc61-56355552c44b&page=queryresults
[0m01:43:58.212408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66dba905-1faf-4a7b-80f3-f0ef2e592c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117dab070>]}
[0m01:43:58.212904 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.42s]
[0m01:43:58.213280 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m01:43:58.213531 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m01:43:58.213846 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m01:43:58.214114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m01:43:58.214328 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m01:43:58.216435 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m01:43:58.217102 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m01:43:58.218995 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m01:43:58.219658 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m01:43:58.219946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:58.825273 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:72158077-172e-4b14-955a-d99fcc01d1d5&page=queryresults
[0m01:43:59.357050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66dba905-1faf-4a7b-80f3-f0ef2e592c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126fe8130>]}
[0m01:43:59.358666 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.14s]
[0m01:43:59.359824 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m01:43:59.360930 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m01:43:59.361818 [info ] [Thread-1 (]: 3 of 6 START sql incremental model order_ad_data.fact_new_customer_orders ...... [RUN]
[0m01:43:59.362493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m01:43:59.363039 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m01:43:59.372292 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:43:59.374288 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m01:43:59.408060 [debug] [Thread-1 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m01:43:59.408648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:59.891714 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:43:59.892948 [debug] [Thread-1 (]: On model.intermate_dbt.fact_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_new_customer_orders"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders` as DBT_INTERNAL_DEST
        using (

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
)

SELECT
    order_id,
    customer_id,
    order_date,
    total_amount_eur,
    discount_code
FROM stg_shopify
WHERE order_date >= (SELECT COALESCE(MAX(order_date), '2000-01-01') FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)


    AND order_date > (SELECT MAX(order_date) FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)

        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id))

    
    when matched then update set
        
    

    when not matched then insert
        ()
    values
        ()


    
[0m01:44:00.258351 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:1fae434b-17b9-4cd9-96e7-aa2b5b80265d&page=queryresults
[0m01:44:00.260320 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:1fae434b-17b9-4cd9-96e7-aa2b5b80265d&page=queryresults
[0m01:44:00.271000 [debug] [Thread-1 (]: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Expected "(" but got keyword WHEN at [43:5]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:44:00.272092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66dba905-1faf-4a7b-80f3-f0ef2e592c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126feb1c0>]}
[0m01:44:00.273112 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model order_ad_data.fact_new_customer_orders  [[31mERROR[0m in 0.91s]
[0m01:44:00.273993 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m01:44:00.274962 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_new_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Expected "(" but got keyword WHEN at [43:5]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql.
[0m01:44:00.276994 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m01:44:00.277794 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m01:44:00.278428 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m01:44:00.279005 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m01:44:00.279618 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m01:44:00.280158 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m01:44:00.280591 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m01:44:00.281061 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m01:44:00.282065 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m01:44:00.283366 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:44:00.284143 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:44:00.284580 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_new_customer_orders' was properly closed.
[0m01:44:00.285179 [info ] [MainThread]: 
[0m01:44:00.285707 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 4.41 seconds (4.41s).
[0m01:44:00.287025 [debug] [MainThread]: Command end result
[0m01:44:00.366310 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:44:00.367267 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:44:00.370888 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m01:44:00.371069 [info ] [MainThread]: 
[0m01:44:00.371266 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:44:00.371431 [info ] [MainThread]: 
[0m01:44:00.371631 [error] [MainThread]:   Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Expected "(" but got keyword WHEN at [43:5]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:44:00.371792 [info ] [MainThread]: 
[0m01:44:00.371957 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m01:44:00.374329 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.863874, "process_in_blocks": "0", "process_kernel_time": 1.186726, "process_mem_max_rss": "219955200", "process_out_blocks": "0", "process_user_time": 2.742729}
[0m01:44:00.374860 [debug] [MainThread]: Command `dbt run` failed at 01:44:00.374798 after 5.86 seconds
[0m01:44:00.375096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aa48b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126f90e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1274aead0>]}
[0m01:44:00.375310 [debug] [MainThread]: Flushing usage events
[0m01:44:00.886022 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:44:17.878839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e808b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107695ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076957e0>]}


============================== 01:44:17.882599 | 723783f9-cb73-44a5-b367-9041be80477c ==============================
[0m01:44:17.882599 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:44:17.882934 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:44:18.708057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '723783f9-cb73-44a5-b367-9041be80477c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f30bd00>]}
[0m01:44:18.735981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '723783f9-cb73-44a5-b367-9041be80477c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10705cf10>]}
[0m01:44:18.736342 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:44:18.846642 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:44:18.928170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:44:18.928769 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_new_customer_orders.sql
[0m01:44:19.070224 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.fact_tables
- models.intermatedbt.staging
- models.intermatedbt.marts
[0m01:44:19.078129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '723783f9-cb73-44a5-b367-9041be80477c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f8f8df0>]}
[0m01:44:19.121944 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:44:19.123404 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:44:19.137380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '723783f9-cb73-44a5-b367-9041be80477c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12faea980>]}
[0m01:44:19.137731 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m01:44:19.137919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '723783f9-cb73-44a5-b367-9041be80477c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12faebaf0>]}
[0m01:44:19.138920 [info ] [MainThread]: 
[0m01:44:19.139147 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:44:19.139304 [info ] [MainThread]: 
[0m01:44:19.139575 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:44:19.142588 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m01:44:19.142919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:44:19.700220 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m01:44:19.701746 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:44:20.226153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '723783f9-cb73-44a5-b367-9041be80477c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107668670>]}
[0m01:44:20.227445 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:44:20.232793 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m01:44:20.233722 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m01:44:20.234478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m01:44:20.235052 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m01:44:20.248129 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m01:44:20.249224 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m01:44:20.279004 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m01:44:20.279759 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m01:44:20.280032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:44:20.838970 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:cc40bd6e-10a6-4399-a1c6-2acd2f23f36f&page=queryresults
[0m01:44:21.340766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '723783f9-cb73-44a5-b367-9041be80477c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f3afd90>]}
[0m01:44:21.341312 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m01:44:21.341720 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m01:44:21.341991 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m01:44:21.342389 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m01:44:21.342738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m01:44:21.342985 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m01:44:21.345319 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m01:44:21.345920 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m01:44:21.347773 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m01:44:21.348212 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m01:44:21.348473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:44:22.861876 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:291d9af3-efa8-448d-bc71-7a0492aaffc5&page=queryresults
[0m01:44:23.405647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '723783f9-cb73-44a5-b367-9041be80477c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fa38a00>]}
[0m01:44:23.407601 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 2.06s]
[0m01:44:23.408915 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m01:44:23.410020 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m01:44:23.410877 [info ] [Thread-1 (]: 3 of 6 START sql incremental model order_ad_data.fact_new_customer_orders ...... [RUN]
[0m01:44:23.411671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m01:44:23.412247 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m01:44:23.421372 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:44:23.422397 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m01:44:23.456804 [debug] [Thread-1 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m01:44:23.457482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:44:23.850298 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:44:23.851420 [debug] [Thread-1 (]: On model.intermate_dbt.fact_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_new_customer_orders"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders` as DBT_INTERNAL_DEST
        using (

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
)

SELECT
    order_id,
    customer_id,
    order_date,
    total_amount_eur,
    discount_code
FROM stg_shopify
WHERE order_date >= (SELECT COALESCE(MAX(order_date), '2000-01-01') FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)


    AND order_date > (SELECT MAX(order_date) FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        ()
    values
        ()


    
[0m01:44:24.117095 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:c4b1ce81-5c26-4ba4-929b-dbc462e0abc1&page=queryresults
[0m01:44:24.119053 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:c4b1ce81-5c26-4ba4-929b-dbc462e0abc1&page=queryresults
[0m01:44:24.128880 [debug] [Thread-1 (]: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [36:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:44:24.129984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '723783f9-cb73-44a5-b367-9041be80477c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f820dc0>]}
[0m01:44:24.131091 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model order_ad_data.fact_new_customer_orders  [[31mERROR[0m in 0.72s]
[0m01:44:24.131999 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m01:44:24.132816 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_new_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [36:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql.
[0m01:44:24.134497 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m01:44:24.135159 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m01:44:24.135717 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m01:44:24.136189 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m01:44:24.136677 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m01:44:24.137160 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m01:44:24.137625 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m01:44:24.138199 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m01:44:24.138794 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m01:44:24.139961 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:44:24.140718 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:44:24.141115 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_new_customer_orders' was properly closed.
[0m01:44:24.141616 [info ] [MainThread]: 
[0m01:44:24.142030 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 5.00 seconds (5.00s).
[0m01:44:24.143299 [debug] [MainThread]: Command end result
[0m01:44:24.228568 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:44:24.229626 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:44:24.233122 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m01:44:24.233313 [info ] [MainThread]: 
[0m01:44:24.233513 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:44:24.233682 [info ] [MainThread]: 
[0m01:44:24.233887 [error] [MainThread]:   Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [36:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:44:24.234050 [info ] [MainThread]: 
[0m01:44:24.234216 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m01:44:24.236199 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.396756, "process_in_blocks": "0", "process_kernel_time": 1.192088, "process_mem_max_rss": "221675520", "process_out_blocks": "0", "process_user_time": 2.675984}
[0m01:44:24.236462 [debug] [MainThread]: Command `dbt run` failed at 01:44:24.236414 after 6.40 seconds
[0m01:44:24.236678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e808b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fa90e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1461bafe0>]}
[0m01:44:24.236880 [debug] [MainThread]: Flushing usage events
[0m01:44:24.674406 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:45:12.547334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107480940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109595e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109595750>]}


============================== 01:45:12.558481 | 51433987-4d0e-4434-a140-4b3f0b019a33 ==============================
[0m01:45:12.558481 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:45:12.558886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'profiles_dir': '/Users/victoruwaje/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:45:13.512613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51433987-4d0e-4434-a140-4b3f0b019a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146c0a470>]}
[0m01:45:13.540633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51433987-4d0e-4434-a140-4b3f0b019a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109023760>]}
[0m01:45:13.541020 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:45:13.649007 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:45:13.723427 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:45:13.723845 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_new_customer_orders.sql
[0m01:45:13.847749 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.marts
- models.intermatedbt.staging
- models.intermatedbt.fact_tables
[0m01:45:13.855484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51433987-4d0e-4434-a140-4b3f0b019a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1473f14e0>]}
[0m01:45:13.898032 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:45:13.899359 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:45:13.910211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51433987-4d0e-4434-a140-4b3f0b019a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147282890>]}
[0m01:45:13.910512 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m01:45:13.910700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51433987-4d0e-4434-a140-4b3f0b019a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1472805e0>]}
[0m01:45:13.911621 [info ] [MainThread]: 
[0m01:45:13.911828 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:45:13.911988 [info ] [MainThread]: 
[0m01:45:13.912262 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:45:13.914597 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m01:45:13.914874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:45:14.398100 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m01:45:14.399459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:45:14.806379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51433987-4d0e-4434-a140-4b3f0b019a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10600f160>]}
[0m01:45:14.807892 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:45:14.812484 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m01:45:14.813359 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m01:45:14.814094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m01:45:14.814663 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m01:45:14.828281 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m01:45:14.829843 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m01:45:14.858842 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m01:45:14.859666 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m01:45:14.860035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:15.549534 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:95c98948-f074-44d6-afde-9ed0c6728543&page=queryresults
[0m01:45:16.138654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51433987-4d0e-4434-a140-4b3f0b019a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146baa560>]}
[0m01:45:16.139179 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.32s]
[0m01:45:16.139561 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m01:45:16.139825 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m01:45:16.140163 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m01:45:16.140475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m01:45:16.140718 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m01:45:16.142795 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m01:45:16.143400 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m01:45:16.145172 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m01:45:16.145795 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m01:45:16.146038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:16.635849 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:811854df-bc10-4611-9dc8-d1151373bb0d&page=queryresults
[0m01:45:17.106445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51433987-4d0e-4434-a140-4b3f0b019a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147266d70>]}
[0m01:45:17.108287 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 0.97s]
[0m01:45:17.109609 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m01:45:17.110763 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m01:45:17.111625 [info ] [Thread-1 (]: 3 of 6 START sql incremental model order_ad_data.fact_new_customer_orders ...... [RUN]
[0m01:45:17.112377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m01:45:17.112943 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m01:45:17.121624 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:45:17.123346 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m01:45:17.157809 [debug] [Thread-1 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m01:45:17.158394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:17.768012 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:45:17.769024 [debug] [Thread-1 (]: On model.intermate_dbt.fact_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_new_customer_orders"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders` as DBT_INTERNAL_DEST
        using (

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
)

SELECT
    order_id,
    customer_id,
    order_date,
    total_amount_eur,
    discount_code
FROM stg_shopify
WHERE order_date >= (SELECT COALESCE(MAX(order_date), '2000-01-01') FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)


    AND order_date > (SELECT MAX(order_date) FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        ()
    values
        ()


    
[0m01:45:18.111393 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:9eb5c143-2e9a-4e31-81f1-cebb5dc92138&page=queryresults
[0m01:45:18.113332 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:9eb5c143-2e9a-4e31-81f1-cebb5dc92138&page=queryresults
[0m01:45:18.122279 [debug] [Thread-1 (]: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [36:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:45:18.123333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51433987-4d0e-4434-a140-4b3f0b019a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1474539d0>]}
[0m01:45:18.124343 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model order_ad_data.fact_new_customer_orders  [[31mERROR[0m in 1.01s]
[0m01:45:18.125442 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m01:45:18.126875 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_new_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [36:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql.
[0m01:45:18.128949 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m01:45:18.129813 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m01:45:18.130547 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m01:45:18.131033 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m01:45:18.131611 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m01:45:18.132156 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m01:45:18.132623 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m01:45:18.133128 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m01:45:18.133611 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m01:45:18.134807 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:45:18.135539 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:45:18.135914 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_new_customer_orders' was properly closed.
[0m01:45:18.136414 [info ] [MainThread]: 
[0m01:45:18.136921 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 4.22 seconds (4.22s).
[0m01:45:18.138264 [debug] [MainThread]: Command end result
[0m01:45:18.217127 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:45:18.218115 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:45:18.221637 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m01:45:18.221826 [info ] [MainThread]: 
[0m01:45:18.222024 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:45:18.222191 [info ] [MainThread]: 
[0m01:45:18.222393 [error] [MainThread]:   Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [36:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:45:18.222559 [info ] [MainThread]: 
[0m01:45:18.222727 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m01:45:18.224722 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.7198267, "process_in_blocks": "0", "process_kernel_time": 1.063901, "process_mem_max_rss": "219119616", "process_out_blocks": "0", "process_user_time": 2.786676}
[0m01:45:18.224989 [debug] [MainThread]: Command `dbt run` failed at 01:45:18.224941 after 5.72 seconds
[0m01:45:18.225212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107480940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147437a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1479a8d00>]}
[0m01:45:18.225427 [debug] [MainThread]: Flushing usage events
[0m01:45:18.687919 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:47:50.248855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058808b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107195ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071957e0>]}


============================== 01:47:50.258006 | 3b17230a-3900-4848-91d3-3f28c6e4c694 ==============================
[0m01:47:50.258006 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:47:50.258391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:47:51.169801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b17230a-3900-4848-91d3-3f28c6e4c694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14500bd00>]}
[0m01:47:51.198268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b17230a-3900-4848-91d3-3f28c6e4c694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b5cf10>]}
[0m01:47:51.198655 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:47:51.305947 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:47:51.380247 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:47:51.380645 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_new_customer_orders.sql
[0m01:47:51.503698 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.staging
- models.intermatedbt.fact_tables
- models.intermatedbt.marts
[0m01:47:51.511659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b17230a-3900-4848-91d3-3f28c6e4c694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148a30490>]}
[0m01:47:51.553829 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:47:51.555186 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:47:51.565912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b17230a-3900-4848-91d3-3f28c6e4c694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148b22980>]}
[0m01:47:51.566217 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m01:47:51.566398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b17230a-3900-4848-91d3-3f28c6e4c694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148b23af0>]}
[0m01:47:51.567353 [info ] [MainThread]: 
[0m01:47:51.567560 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:47:51.567723 [info ] [MainThread]: 
[0m01:47:51.568003 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:47:51.570343 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m01:47:51.570573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:47:52.092426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m01:47:52.093540 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:47:52.428067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b17230a-3900-4848-91d3-3f28c6e4c694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107168670>]}
[0m01:47:52.429766 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:47:52.435313 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m01:47:52.436230 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m01:47:52.436991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m01:47:52.437561 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m01:47:52.451055 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m01:47:52.452489 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m01:47:52.483121 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m01:47:52.484085 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m01:47:52.484470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:47:53.018455 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:e9b6977f-960d-474b-a0e5-556734803cd8&page=queryresults
[0m01:47:54.104152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b17230a-3900-4848-91d3-3f28c6e4c694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148a119f0>]}
[0m01:47:54.104654 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.67s]
[0m01:47:54.105036 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m01:47:54.105289 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m01:47:54.105635 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m01:47:54.105965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m01:47:54.106225 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m01:47:54.108353 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m01:47:54.108817 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m01:47:54.110509 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m01:47:54.111075 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m01:47:54.111322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:47:54.755452 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:f22b59dd-c1c5-4f69-a143-8e1d2e9ab44a&page=queryresults
[0m01:47:55.279077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b17230a-3900-4848-91d3-3f28c6e4c694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14899e470>]}
[0m01:47:55.280799 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.17s]
[0m01:47:55.282022 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m01:47:55.282967 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m01:47:55.283917 [info ] [Thread-1 (]: 3 of 6 START sql incremental model order_ad_data.fact_new_customer_orders ...... [RUN]
[0m01:47:55.284641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m01:47:55.285210 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m01:47:55.293877 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:47:55.295261 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m01:47:55.330612 [debug] [Thread-1 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m01:47:55.331203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:47:55.682900 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:47:55.684833 [debug] [Thread-1 (]: On model.intermate_dbt.fact_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_new_customer_orders"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders` as DBT_INTERNAL_DEST
        using (

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
)

SELECT
    order_id,
    customer_id,
    order_date,
    total_amount_eur,
    discount_code
FROM stg_shopify
WHERE order_date >= (SELECT COALESCE(MAX(order_date), '2000-01-01') FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`))


    AND order_date > (SELECT MAX(order_date) FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        ()
    values
        ()


    
[0m01:47:55.980315 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:7321ac11-ad7a-4f73-98cf-709ca3c33b3b&page=queryresults
[0m01:47:55.981951 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:7321ac11-ad7a-4f73-98cf-709ca3c33b3b&page=queryresults
[0m01:47:55.991372 [debug] [Thread-1 (]: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Expected keyword ON but got keyword AND at [28:5]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:47:55.992470 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b17230a-3900-4848-91d3-3f28c6e4c694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148b386a0>]}
[0m01:47:55.993661 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model order_ad_data.fact_new_customer_orders  [[31mERROR[0m in 0.71s]
[0m01:47:55.994600 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m01:47:55.995449 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_new_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Expected keyword ON but got keyword AND at [28:5]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql.
[0m01:47:55.997463 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m01:47:55.998202 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m01:47:55.998898 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m01:47:55.999472 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m01:47:56.000118 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m01:47:56.000768 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m01:47:56.001333 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m01:47:56.001840 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m01:47:56.002411 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m01:47:56.003539 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:47:56.004255 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:47:56.004628 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_new_customer_orders' was properly closed.
[0m01:47:56.005113 [info ] [MainThread]: 
[0m01:47:56.005515 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 4.44 seconds (4.44s).
[0m01:47:56.006741 [debug] [MainThread]: Command end result
[0m01:47:56.085850 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:47:56.086852 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:47:56.090502 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m01:47:56.090691 [info ] [MainThread]: 
[0m01:47:56.090896 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:47:56.091062 [info ] [MainThread]: 
[0m01:47:56.091264 [error] [MainThread]:   Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Expected keyword ON but got keyword AND at [28:5]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:47:56.091428 [info ] [MainThread]: 
[0m01:47:56.091595 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m01:47:56.093443 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.885466, "process_in_blocks": "0", "process_kernel_time": 0.949152, "process_mem_max_rss": "220430336", "process_out_blocks": "0", "process_user_time": 2.83622}
[0m01:47:56.093706 [debug] [MainThread]: Command `dbt run` failed at 01:47:56.093661 after 5.89 seconds
[0m01:47:56.093925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058808b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148ac8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1493952a0>]}
[0m01:47:56.094122 [debug] [MainThread]: Flushing usage events
[0m01:47:56.574609 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:48:31.151920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c809a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a595d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a5956c0>]}


============================== 01:48:31.155814 | 9e9f6fa3-86bc-4e3a-8256-818a2625bbce ==============================
[0m01:48:31.155814 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:48:31.156174 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:48:32.050046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e9f6fa3-86bc-4e3a-8256-818a2625bbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f708f40>]}
[0m01:48:32.077876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e9f6fa3-86bc-4e3a-8256-818a2625bbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a56afe0>]}
[0m01:48:32.078254 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:48:32.192691 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:48:32.263813 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:48:32.264186 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_new_customer_orders.sql
[0m01:48:32.388895 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.staging
- models.intermatedbt.fact_tables
- models.intermatedbt.marts
[0m01:48:32.396850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e9f6fa3-86bc-4e3a-8256-818a2625bbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fdf5510>]}
[0m01:48:32.438632 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:48:32.439916 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:48:32.450120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e9f6fa3-86bc-4e3a-8256-818a2625bbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fde5540>]}
[0m01:48:32.450428 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m01:48:32.450616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e9f6fa3-86bc-4e3a-8256-818a2625bbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fc72c20>]}
[0m01:48:32.451575 [info ] [MainThread]: 
[0m01:48:32.451775 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:48:32.451937 [info ] [MainThread]: 
[0m01:48:32.452207 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:48:32.454651 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m01:48:32.454920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:48:33.056164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m01:48:33.057511 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:48:33.464823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e9f6fa3-86bc-4e3a-8256-818a2625bbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a568760>]}
[0m01:48:33.466380 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:48:33.471731 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m01:48:33.472648 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m01:48:33.473436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m01:48:33.473998 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m01:48:33.487372 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m01:48:33.488413 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m01:48:33.518387 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m01:48:33.519211 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m01:48:33.519591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:48:34.340905 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:62842637-5c4f-47a7-99f7-7446569a8151&page=queryresults
[0m01:48:35.063920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e9f6fa3-86bc-4e3a-8256-818a2625bbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f6aac50>]}
[0m01:48:35.064500 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.59s]
[0m01:48:35.064975 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m01:48:35.065275 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m01:48:35.065643 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m01:48:35.065933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m01:48:35.066170 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m01:48:35.068417 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m01:48:35.068934 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m01:48:35.070862 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m01:48:35.071305 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m01:48:35.071585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:48:35.612974 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:7366d4a8-2b10-421e-944f-367e5f645970&page=queryresults
[0m01:48:36.125256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e9f6fa3-86bc-4e3a-8256-818a2625bbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fc65000>]}
[0m01:48:36.127140 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m01:48:36.128675 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m01:48:36.130077 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m01:48:36.131046 [info ] [Thread-1 (]: 3 of 6 START sql incremental model order_ad_data.fact_new_customer_orders ...... [RUN]
[0m01:48:36.131811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m01:48:36.132398 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m01:48:36.141199 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:48:36.142350 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m01:48:36.176930 [debug] [Thread-1 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m01:48:36.177529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:48:36.573395 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:48:36.574546 [debug] [Thread-1 (]: On model.intermate_dbt.fact_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_new_customer_orders"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders` as DBT_INTERNAL_DEST
        using (

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
)

SELECT
    order_id,
    customer_id,
    order_date,
    total_amount_eur,
    discount_code
FROM stg_shopify
WHERE order_date >= (SELECT COALESCE(MAX(order_date), '2000-01-01') FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`


    AND order_date > (SELECT MAX(order_date) FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        ()
    values
        ()


    
[0m01:48:36.943267 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:1fb45b4f-85c7-4f73-90c0-d37a920f9959&page=queryresults
[0m01:48:36.944423 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:1fb45b4f-85c7-4f73-90c0-d37a920f9959&page=queryresults
[0m01:48:36.954701 [debug] [Thread-1 (]: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Expected ")" but got keyword AND at [28:5]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:48:36.955723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e9f6fa3-86bc-4e3a-8256-818a2625bbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fe03d00>]}
[0m01:48:36.956795 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model order_ad_data.fact_new_customer_orders  [[31mERROR[0m in 0.82s]
[0m01:48:36.957839 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m01:48:36.958737 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_new_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Expected ")" but got keyword AND at [28:5]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql.
[0m01:48:36.960715 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m01:48:36.961368 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m01:48:36.962216 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m01:48:36.962897 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m01:48:36.963486 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m01:48:36.964034 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m01:48:36.964499 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m01:48:36.965033 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m01:48:36.965561 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m01:48:36.966961 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:48:36.967695 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:48:36.968063 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_new_customer_orders' was properly closed.
[0m01:48:36.968555 [info ] [MainThread]: 
[0m01:48:36.968966 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 4.52 seconds (4.52s).
[0m01:48:36.970215 [debug] [MainThread]: Command end result
[0m01:48:37.048084 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:48:37.049053 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:48:37.052570 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m01:48:37.052775 [info ] [MainThread]: 
[0m01:48:37.052977 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:48:37.053148 [info ] [MainThread]: 
[0m01:48:37.053348 [error] [MainThread]:   Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Expected ")" but got keyword AND at [28:5]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:48:37.053511 [info ] [MainThread]: 
[0m01:48:37.053676 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m01:48:37.055444 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.9439783, "process_in_blocks": "0", "process_kernel_time": 1.052473, "process_mem_max_rss": "218808320", "process_out_blocks": "0", "process_user_time": 2.750897}
[0m01:48:37.055697 [debug] [MainThread]: Command `dbt run` failed at 01:48:37.055651 after 5.94 seconds
[0m01:48:37.055925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c809a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fe33820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1484ba350>]}
[0m01:48:37.056130 [debug] [MainThread]: Flushing usage events
[0m01:48:37.537763 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:48:48.159064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057cc910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10661de40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10661d780>]}


============================== 01:48:48.162679 | 32144736-7578-418e-91a6-bbe1df221214 ==============================
[0m01:48:48.162679 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:48:48.163026 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'profiles_dir': '/Users/victoruwaje/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:48:49.026116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32144736-7578-418e-91a6-bbe1df221214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047bd990>]}
[0m01:48:49.054223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32144736-7578-418e-91a6-bbe1df221214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1315a9150>]}
[0m01:48:49.054608 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:48:49.162758 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:48:49.235873 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:48:49.236262 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_new_customer_orders.sql
[0m01:48:49.358594 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.marts
- models.intermatedbt.fact_tables
- models.intermatedbt.staging
[0m01:48:49.366420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32144736-7578-418e-91a6-bbe1df221214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1343fb3d0>]}
[0m01:48:49.408778 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:48:49.409947 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:48:49.421557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32144736-7578-418e-91a6-bbe1df221214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1344ea650>]}
[0m01:48:49.421882 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m01:48:49.422073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32144736-7578-418e-91a6-bbe1df221214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1345282b0>]}
[0m01:48:49.423039 [info ] [MainThread]: 
[0m01:48:49.423241 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:48:49.423399 [info ] [MainThread]: 
[0m01:48:49.423679 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:48:49.426110 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m01:48:49.426347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:48:49.950598 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m01:48:49.951838 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:48:50.359712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32144736-7578-418e-91a6-bbe1df221214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f0670>]}
[0m01:48:50.361082 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:48:50.365905 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m01:48:50.366855 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m01:48:50.367602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m01:48:50.368183 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m01:48:50.381394 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m01:48:50.382503 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m01:48:50.411924 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m01:48:50.412660 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m01:48:50.413002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:48:51.072251 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:9cb1cbe8-b914-4690-afa9-f3f002e910d4&page=queryresults
[0m01:48:52.089960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32144736-7578-418e-91a6-bbe1df221214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1345338b0>]}
[0m01:48:52.090524 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.72s]
[0m01:48:52.090939 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m01:48:52.091226 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m01:48:52.091610 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m01:48:52.091922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m01:48:52.092159 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m01:48:52.094237 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m01:48:52.094718 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m01:48:52.096498 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m01:48:52.097082 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m01:48:52.097347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:48:52.520711 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:27bc5d03-1df3-4406-9fc1-c41a3248b158&page=queryresults
[0m01:48:52.969474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32144736-7578-418e-91a6-bbe1df221214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1342e5d80>]}
[0m01:48:52.970618 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 0.88s]
[0m01:48:52.971478 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m01:48:52.972290 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m01:48:52.972674 [info ] [Thread-1 (]: 3 of 6 START sql incremental model order_ad_data.fact_new_customer_orders ...... [RUN]
[0m01:48:52.973014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m01:48:52.973230 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m01:48:52.976862 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:48:52.977510 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m01:48:52.995638 [debug] [Thread-1 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m01:48:52.996047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:48:53.470521 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:48:53.471628 [debug] [Thread-1 (]: On model.intermate_dbt.fact_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_new_customer_orders"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders` as DBT_INTERNAL_DEST
        using (

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
)

SELECT
    order_id,
    customer_id,
    order_date,
    total_amount_eur,
    discount_code
FROM stg_shopify
WHERE order_date >= (SELECT COALESCE(MAX(order_date), '2000-01-01') FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)


    AND order_date > (SELECT MAX(order_date) FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        ()
    values
        ()


    
[0m01:48:53.838965 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:f2d2e2f2-8abc-4078-972a-d28e3a18d508&page=queryresults
[0m01:48:53.840529 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:f2d2e2f2-8abc-4078-972a-d28e3a18d508&page=queryresults
[0m01:48:53.849529 [debug] [Thread-1 (]: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [36:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:48:53.850534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32144736-7578-418e-91a6-bbe1df221214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13464d9f0>]}
[0m01:48:53.851557 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model order_ad_data.fact_new_customer_orders  [[31mERROR[0m in 0.88s]
[0m01:48:53.852430 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m01:48:53.853215 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_new_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [36:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql.
[0m01:48:53.854876 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m01:48:53.855535 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m01:48:53.856053 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m01:48:53.856499 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m01:48:53.856984 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m01:48:53.857455 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m01:48:53.857897 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m01:48:53.858373 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m01:48:53.858854 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m01:48:53.859996 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:48:53.860810 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:48:53.861212 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_new_customer_orders' was properly closed.
[0m01:48:53.861721 [info ] [MainThread]: 
[0m01:48:53.862223 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 4.44 seconds (4.44s).
[0m01:48:53.863594 [debug] [MainThread]: Command end result
[0m01:48:53.941004 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:48:53.942019 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:48:53.945469 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m01:48:53.945660 [info ] [MainThread]: 
[0m01:48:53.945866 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:48:53.946045 [info ] [MainThread]: 
[0m01:48:53.946255 [error] [MainThread]:   Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [36:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:48:53.946419 [info ] [MainThread]: 
[0m01:48:53.946586 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m01:48:53.948585 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.829712, "process_in_blocks": "0", "process_kernel_time": 1.051643, "process_mem_max_rss": "221167616", "process_out_blocks": "0", "process_user_time": 2.704481}
[0m01:48:53.948836 [debug] [MainThread]: Command `dbt run` failed at 01:48:53.948790 after 5.83 seconds
[0m01:48:53.949061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057cc910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134491390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134ab30a0>]}
[0m01:48:53.949268 [debug] [MainThread]: Flushing usage events
[0m01:48:54.379811 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:49:18.603908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076a8970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084f9e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084f9750>]}


============================== 01:49:18.607766 | 22c10768-ae1b-48f6-8df3-d4dcc8f7e824 ==============================
[0m01:49:18.607766 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:49:18.608132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:49:19.431297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22c10768-ae1b-48f6-8df3-d4dcc8f7e824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b50a7d0>]}
[0m01:49:19.458941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22c10768-ae1b-48f6-8df3-d4dcc8f7e824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084cefb0>]}
[0m01:49:19.459306 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:49:19.578630 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:49:19.650351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:49:19.650771 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_new_customer_orders.sql
[0m01:49:19.780113 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.staging
- models.intermatedbt.fact_tables
- models.intermatedbt.marts
[0m01:49:19.791028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22c10768-ae1b-48f6-8df3-d4dcc8f7e824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bdf5510>]}
[0m01:49:19.833859 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:49:19.835168 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:49:19.845024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22c10768-ae1b-48f6-8df3-d4dcc8f7e824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bde4d90>]}
[0m01:49:19.845357 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m01:49:19.845542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22c10768-ae1b-48f6-8df3-d4dcc8f7e824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bde4af0>]}
[0m01:49:19.846484 [info ] [MainThread]: 
[0m01:49:19.846685 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:49:19.846842 [info ] [MainThread]: 
[0m01:49:19.847112 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:49:19.849642 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m01:49:19.849917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:49:20.358416 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m01:49:20.359784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:49:20.689578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22c10768-ae1b-48f6-8df3-d4dcc8f7e824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084cc700>]}
[0m01:49:20.690547 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:49:20.693905 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m01:49:20.694600 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m01:49:20.695152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m01:49:20.695553 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m01:49:20.707733 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m01:49:20.708913 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m01:49:20.734178 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m01:49:20.734895 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m01:49:20.735215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:49:21.281563 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:eba8c380-558e-4e5f-810a-f9f6afbea358&page=queryresults
[0m01:49:21.795148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22c10768-ae1b-48f6-8df3-d4dcc8f7e824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b4aac50>]}
[0m01:49:21.795691 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m01:49:21.796111 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m01:49:21.796380 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m01:49:21.796741 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m01:49:21.797085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m01:49:21.797346 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m01:49:21.799590 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m01:49:21.800129 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m01:49:21.802001 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m01:49:21.802441 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m01:49:21.802708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:49:22.281543 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:0daac488-b377-4475-a167-caee94a459e4&page=queryresults
[0m01:49:22.731075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22c10768-ae1b-48f6-8df3-d4dcc8f7e824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bb65000>]}
[0m01:49:22.732788 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 0.93s]
[0m01:49:22.734480 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m01:49:22.735763 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m01:49:22.736702 [info ] [Thread-1 (]: 3 of 6 START sql incremental model order_ad_data.fact_new_customer_orders ...... [RUN]
[0m01:49:22.737500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m01:49:22.738108 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m01:49:22.747228 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:49:22.748462 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m01:49:22.783228 [debug] [Thread-1 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m01:49:22.783863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:49:23.276360 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:49:23.277616 [debug] [Thread-1 (]: On model.intermate_dbt.fact_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_new_customer_orders"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders` as DBT_INTERNAL_DEST
        using (

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
)

SELECT
    order_id,
    customer_id,
    order_date,
    total_amount_eur,
    discount_code
FROM stg_shopify
WHERE order_date >= (SELECT COALESCE(MAX(order_date), '2000-01-01') FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`


    AND order_date > (SELECT MAX(order_date) FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        ()
    values
        ()


    
[0m01:49:23.534660 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:0c1bd562-d678-4491-aef3-82acab6fa57f&page=queryresults
[0m01:49:23.537268 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:0c1bd562-d678-4491-aef3-82acab6fa57f&page=queryresults
[0m01:49:23.547015 [debug] [Thread-1 (]: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Expected ")" but got keyword AND at [28:5]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:49:23.548209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22c10768-ae1b-48f6-8df3-d4dcc8f7e824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bae6c50>]}
[0m01:49:23.549331 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model order_ad_data.fact_new_customer_orders  [[31mERROR[0m in 0.81s]
[0m01:49:23.550374 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m01:49:23.551132 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_new_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Expected ")" but got keyword AND at [28:5]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql.
[0m01:49:23.553127 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m01:49:23.553777 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m01:49:23.554318 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m01:49:23.554787 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m01:49:23.555290 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m01:49:23.555771 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m01:49:23.556200 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m01:49:23.556665 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m01:49:23.557146 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m01:49:23.558275 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:49:23.559056 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:49:23.559454 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_new_customer_orders' was properly closed.
[0m01:49:23.559961 [info ] [MainThread]: 
[0m01:49:23.560374 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 3.71 seconds (3.71s).
[0m01:49:23.561615 [debug] [MainThread]: Command end result
[0m01:49:23.639254 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:49:23.640236 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:49:23.643733 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m01:49:23.643912 [info ] [MainThread]: 
[0m01:49:23.644104 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:49:23.644264 [info ] [MainThread]: 
[0m01:49:23.644462 [error] [MainThread]:   Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Expected ")" but got keyword AND at [28:5]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:49:23.644626 [info ] [MainThread]: 
[0m01:49:23.644805 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m01:49:23.646797 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.0815463, "process_in_blocks": "0", "process_kernel_time": 0.894888, "process_mem_max_rss": "214892544", "process_out_blocks": "0", "process_user_time": 2.856963}
[0m01:49:23.647057 [debug] [MainThread]: Command `dbt run` failed at 01:49:23.647011 after 5.08 seconds
[0m01:49:23.647272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076a8970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f033820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f6b6020>]}
[0m01:49:23.647476 [debug] [MainThread]: Flushing usage events
[0m01:49:24.215958 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:49:59.980766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037c08e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104611e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046117b0>]}


============================== 01:49:59.991959 | 5967bb96-5ac2-4c07-9ffb-76b5b5629354 ==============================
[0m01:49:59.991959 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:49:59.992404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:50:00.949029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5967bb96-5ac2-4c07-9ffb-76b5b5629354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c7422f0>]}
[0m01:50:00.977028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5967bb96-5ac2-4c07-9ffb-76b5b5629354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038618a0>]}
[0m01:50:00.977412 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:50:01.096863 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:50:01.172029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:50:01.172421 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_new_customer_orders.sql
[0m01:50:01.295560 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.staging
- models.intermatedbt.marts
- models.intermatedbt.fact_tables
[0m01:50:01.303835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5967bb96-5ac2-4c07-9ffb-76b5b5629354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ce65c60>]}
[0m01:50:01.346885 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:50:01.349062 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:50:01.359978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5967bb96-5ac2-4c07-9ffb-76b5b5629354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cec0e20>]}
[0m01:50:01.360294 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m01:50:01.360480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5967bb96-5ac2-4c07-9ffb-76b5b5629354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cec16f0>]}
[0m01:50:01.361413 [info ] [MainThread]: 
[0m01:50:01.361614 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:50:01.361774 [info ] [MainThread]: 
[0m01:50:01.362038 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:50:01.364430 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m01:50:01.364669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:50:01.849273 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m01:50:01.850779 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:50:02.246142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5967bb96-5ac2-4c07-9ffb-76b5b5629354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045e4640>]}
[0m01:50:02.247969 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:50:02.253445 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m01:50:02.254404 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m01:50:02.255149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m01:50:02.255734 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m01:50:02.268858 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m01:50:02.270024 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m01:50:02.299613 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m01:50:02.300456 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m01:50:02.300830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:50:02.958284 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:0291f01f-c3dd-4752-989b-994d82bcffec&page=queryresults
[0m01:50:03.542277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5967bb96-5ac2-4c07-9ffb-76b5b5629354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cff4820>]}
[0m01:50:03.542793 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.29s]
[0m01:50:03.543538 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m01:50:03.543803 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m01:50:03.544165 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m01:50:03.544483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m01:50:03.544725 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m01:50:03.546828 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m01:50:03.547335 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m01:50:03.549085 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m01:50:03.549674 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m01:50:03.549917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:50:04.083720 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:b8ce98e2-f880-454d-a9ae-08cdfb19b8ac&page=queryresults
[0m01:50:04.554490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5967bb96-5ac2-4c07-9ffb-76b5b5629354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cff4820>]}
[0m01:50:04.556198 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m01:50:04.557238 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m01:50:04.558143 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m01:50:04.559084 [info ] [Thread-1 (]: 3 of 6 START sql incremental model order_ad_data.fact_new_customer_orders ...... [RUN]
[0m01:50:04.559786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m01:50:04.560332 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m01:50:04.566351 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:50:04.567844 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m01:50:04.604078 [debug] [Thread-1 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m01:50:04.604640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:50:05.050462 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:50:05.052358 [debug] [Thread-1 (]: On model.intermate_dbt.fact_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_new_customer_orders"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders` as DBT_INTERNAL_DEST
        using (

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
)

SELECT
    order_id,
    customer_id,
    order_date,
    total_amount_eur,
    discount_code
FROM stg_shopify
WHERE order_date >= (SELECT COALESCE(MAX(order_date), '2000-01-01') FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        ()
    values
        ()


    
[0m01:50:05.520774 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:b576aa7e-f97d-41ca-b0e1-2f2294199f54&page=queryresults
[0m01:50:05.522792 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:b576aa7e-f97d-41ca-b0e1-2f2294199f54&page=queryresults
[0m01:50:05.532684 [debug] [Thread-1 (]: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [32:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:50:05.533738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5967bb96-5ac2-4c07-9ffb-76b5b5629354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d25ece0>]}
[0m01:50:05.534776 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model order_ad_data.fact_new_customer_orders  [[31mERROR[0m in 0.97s]
[0m01:50:05.535656 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m01:50:05.536477 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_new_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [32:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql.
[0m01:50:05.538339 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m01:50:05.538982 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m01:50:05.539554 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m01:50:05.540029 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m01:50:05.540549 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m01:50:05.541064 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m01:50:05.541513 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m01:50:05.542014 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m01:50:05.542536 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m01:50:05.543727 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:50:05.544552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:50:05.544958 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_new_customer_orders' was properly closed.
[0m01:50:05.545467 [info ] [MainThread]: 
[0m01:50:05.545880 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 4.18 seconds (4.18s).
[0m01:50:05.547119 [debug] [MainThread]: Command end result
[0m01:50:05.624770 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:50:05.625736 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:50:05.629353 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m01:50:05.629550 [info ] [MainThread]: 
[0m01:50:05.629753 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:50:05.629927 [info ] [MainThread]: 
[0m01:50:05.630128 [error] [MainThread]:   Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [32:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:50:05.630287 [info ] [MainThread]: 
[0m01:50:05.630451 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m01:50:05.632429 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.6958466, "process_in_blocks": "0", "process_kernel_time": 0.913774, "process_mem_max_rss": "211386368", "process_out_blocks": "0", "process_user_time": 2.880462}
[0m01:50:05.632683 [debug] [MainThread]: Command `dbt run` failed at 01:50:05.632636 after 5.70 seconds
[0m01:50:05.632891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037c08e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037e4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cddc760>]}
[0m01:50:05.633092 [debug] [MainThread]: Flushing usage events
[0m01:50:06.061217 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:50:54.600655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105330910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108595e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108595780>]}


============================== 01:50:54.613850 | 7f3c53a4-ce33-4a7b-b9d7-5c07b324b03b ==============================
[0m01:50:54.613850 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:50:54.614276 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:50:55.553898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f3c53a4-ce33-4a7b-b9d7-5c07b324b03b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053a7970>]}
[0m01:50:55.581889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f3c53a4-ce33-4a7b-b9d7-5c07b324b03b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080cb340>]}
[0m01:50:55.582282 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:50:55.692813 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:50:55.767724 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:50:55.768125 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_new_customer_orders.sql
[0m01:50:55.894424 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.marts
- models.intermatedbt.fact_tables
- models.intermatedbt.staging
[0m01:50:55.902586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f3c53a4-ce33-4a7b-b9d7-5c07b324b03b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f0ed4e0>]}
[0m01:50:55.946254 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:50:55.947572 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:50:55.961233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f3c53a4-ce33-4a7b-b9d7-5c07b324b03b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ef814b0>]}
[0m01:50:55.961557 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m01:50:55.961747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f3c53a4-ce33-4a7b-b9d7-5c07b324b03b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ef805e0>]}
[0m01:50:55.962710 [info ] [MainThread]: 
[0m01:50:55.962916 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:50:55.963075 [info ] [MainThread]: 
[0m01:50:55.963356 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:50:55.965760 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m01:50:55.966161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:50:56.519749 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m01:50:56.521131 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:50:56.924474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f3c53a4-ce33-4a7b-b9d7-5c07b324b03b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108568670>]}
[0m01:50:56.925460 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:50:56.930325 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m01:50:56.931403 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m01:50:56.932121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m01:50:56.932606 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m01:50:56.945078 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m01:50:56.946267 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m01:50:56.977048 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m01:50:56.977912 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m01:50:56.978292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:50:57.537712 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:3c855fc4-8c5c-435a-bf89-114608e817ba&page=queryresults
[0m01:50:58.196389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f3c53a4-ce33-4a7b-b9d7-5c07b324b03b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e8a9960>]}
[0m01:50:58.196917 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.26s]
[0m01:50:58.197303 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m01:50:58.197560 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m01:50:58.197896 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m01:50:58.198210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m01:50:58.198450 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m01:50:58.200488 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m01:50:58.201105 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m01:50:58.202823 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m01:50:58.203368 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m01:50:58.203622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:50:59.074371 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:aabd8bb9-030d-4dd5-b9a0-78e74fac20dc&page=queryresults
[0m01:50:59.707080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f3c53a4-ce33-4a7b-b9d7-5c07b324b03b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ef66d70>]}
[0m01:50:59.708716 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.51s]
[0m01:50:59.709966 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m01:50:59.711128 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m01:50:59.712123 [info ] [Thread-1 (]: 3 of 6 START sql incremental model order_ad_data.fact_new_customer_orders ...... [RUN]
[0m01:50:59.712862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m01:50:59.713538 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m01:50:59.722319 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:50:59.723585 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m01:50:59.757986 [debug] [Thread-1 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m01:50:59.758596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:00.137210 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:51:00.138438 [debug] [Thread-1 (]: On model.intermate_dbt.fact_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_new_customer_orders"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders` as DBT_INTERNAL_DEST
        using (

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
)

SELECT
    order_id,
    customer_id,
    order_date,
    total_amount_eur,
    discount_code
FROM stg_shopify
WHERE order_date >= (SELECT COALESCE(MAX(order_date), '2000-01-01') FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)


    AND order_date > (SELECT MAX(order_date) FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        ()
    values
        ()


    
[0m01:51:00.400597 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:7816adb1-b0ff-4583-8d96-385669ca3118&page=queryresults
[0m01:51:00.401639 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:7816adb1-b0ff-4583-8d96-385669ca3118&page=queryresults
[0m01:51:00.409710 [debug] [Thread-1 (]: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [36:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:51:00.410700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f3c53a4-ce33-4a7b-b9d7-5c07b324b03b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f0edf00>]}
[0m01:51:00.411575 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model order_ad_data.fact_new_customer_orders  [[31mERROR[0m in 0.70s]
[0m01:51:00.412537 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m01:51:00.413232 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_new_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [36:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql.
[0m01:51:00.415161 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m01:51:00.415732 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m01:51:00.416257 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m01:51:00.416713 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m01:51:00.417210 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m01:51:00.417704 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m01:51:00.418201 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m01:51:00.418687 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m01:51:00.419172 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m01:51:00.420357 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:51:00.421238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:51:00.421849 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_new_customer_orders' was properly closed.
[0m01:51:00.422452 [info ] [MainThread]: 
[0m01:51:00.422872 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 4.46 seconds (4.46s).
[0m01:51:00.423988 [debug] [MainThread]: Command end result
[0m01:51:00.500410 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:51:00.501416 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:51:00.505336 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m01:51:00.505551 [info ] [MainThread]: 
[0m01:51:00.505754 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:51:00.505925 [info ] [MainThread]: 
[0m01:51:00.506126 [error] [MainThread]:   Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [36:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:51:00.506290 [info ] [MainThread]: 
[0m01:51:00.506459 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m01:51:00.508497 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.948411, "process_in_blocks": "0", "process_kernel_time": 0.974437, "process_mem_max_rss": "216662016", "process_out_blocks": "0", "process_user_time": 2.836384}
[0m01:51:00.508766 [debug] [MainThread]: Command `dbt run` failed at 01:51:00.508718 after 5.95 seconds
[0m01:51:00.508997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105330910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f127a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f58c5b0>]}
[0m01:51:00.509217 [debug] [MainThread]: Flushing usage events
[0m01:51:01.902316 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:52:42.082340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074088e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108259e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082597b0>]}


============================== 01:52:42.093156 | 92a2ab12-e789-4088-905e-558a3e4b3b25 ==============================
[0m01:52:42.093156 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:52:42.093529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:52:42.994467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92a2ab12-e789-4088-905e-558a3e4b3b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c90b610>]}
[0m01:52:43.022713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92a2ab12-e789-4088-905e-558a3e4b3b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10808fa30>]}
[0m01:52:43.023157 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:52:43.137664 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:52:43.214746 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:52:43.215139 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_new_customer_orders.sql
[0m01:52:43.339542 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.staging
- models.intermatedbt.fact_tables
- models.intermatedbt.marts
[0m01:52:43.347360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92a2ab12-e789-4088-905e-558a3e4b3b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d1d20b0>]}
[0m01:52:43.397490 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:52:43.399529 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:52:43.414017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92a2ab12-e789-4088-905e-558a3e4b3b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d2335b0>]}
[0m01:52:43.415504 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m01:52:43.415721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92a2ab12-e789-4088-905e-558a3e4b3b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cf809a0>]}
[0m01:52:43.416768 [info ] [MainThread]: 
[0m01:52:43.417000 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:52:43.417169 [info ] [MainThread]: 
[0m01:52:43.417474 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:52:43.420288 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m01:52:43.420534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:52:43.935533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m01:52:43.937129 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:52:44.343274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92a2ab12-e789-4088-905e-558a3e4b3b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108225d80>]}
[0m01:52:44.344445 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:52:44.348628 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m01:52:44.349365 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m01:52:44.349879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m01:52:44.350236 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m01:52:44.361093 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m01:52:44.362261 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m01:52:44.389282 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m01:52:44.390337 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m01:52:44.390750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:52:44.883526 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:1be60c1c-c705-4d7a-a47a-b9c6960efcc9&page=queryresults
[0m01:52:45.473639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a2ab12-e789-4088-905e-558a3e4b3b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c7a9660>]}
[0m01:52:45.474149 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.12s]
[0m01:52:45.474661 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m01:52:45.474918 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m01:52:45.475265 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m01:52:45.475593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m01:52:45.475832 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m01:52:45.477944 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m01:52:45.478413 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m01:52:45.480158 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m01:52:45.480697 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m01:52:45.480941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:52:45.995120 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:728dd7c3-d1e0-44fb-bb06-0531da00304c&page=queryresults
[0m01:52:46.466553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a2ab12-e789-4088-905e-558a3e4b3b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cf651e0>]}
[0m01:52:46.468543 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 0.99s]
[0m01:52:46.469802 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m01:52:46.470970 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m01:52:46.471921 [info ] [Thread-1 (]: 3 of 6 START sql incremental model order_ad_data.fact_new_customer_orders ...... [RUN]
[0m01:52:46.472726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m01:52:46.473341 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m01:52:46.482589 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:52:46.483939 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m01:52:46.517685 [debug] [Thread-1 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m01:52:46.518243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:52:46.943770 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:52:46.944925 [debug] [Thread-1 (]: On model.intermate_dbt.fact_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_new_customer_orders"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders` as DBT_INTERNAL_DEST
        using (

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
)

SELECT
    order_id,
    customer_id,
    order_date,
    total_amount_eur,
    discount_code
FROM stg_shopify
WHERE order_date >= (
    SELECT COALESCE(MAX(order_date), DATE('2000-01-01'))
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`
    
    WHERE order_date IS NOT NULL
    
)


    AND order_date > (
        SELECT COALESCE(MAX(order_date), DATE('2000-01-01'))
        FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`
        WHERE order_date IS NOT NULL
    )

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        ()
    values
        ()


    
[0m01:52:47.189460 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:eea089f5-6658-4b96-9e2c-5c8f6e87ebb1&page=queryresults
[0m01:52:47.191630 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:eea089f5-6658-4b96-9e2c-5c8f6e87ebb1&page=queryresults
[0m01:52:47.200572 [debug] [Thread-1 (]: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [46:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:52:47.201446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a2ab12-e789-4088-905e-558a3e4b3b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cee7490>]}
[0m01:52:47.202476 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model order_ad_data.fact_new_customer_orders  [[31mERROR[0m in 0.73s]
[0m01:52:47.203321 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m01:52:47.204078 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_new_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [46:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql.
[0m01:52:47.205762 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m01:52:47.206304 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m01:52:47.206804 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m01:52:47.207243 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m01:52:47.207722 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m01:52:47.208196 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m01:52:47.208633 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m01:52:47.209095 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m01:52:47.209575 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m01:52:47.210652 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:52:47.211463 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:52:47.211869 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_new_customer_orders' was properly closed.
[0m01:52:47.212363 [info ] [MainThread]: 
[0m01:52:47.212768 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 3.79 seconds (3.79s).
[0m01:52:47.214076 [debug] [MainThread]: Command end result
[0m01:52:47.292139 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:52:47.293105 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:52:47.296664 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m01:52:47.296854 [info ] [MainThread]: 
[0m01:52:47.297055 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:52:47.297220 [info ] [MainThread]: 
[0m01:52:47.297419 [error] [MainThread]:   Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [46:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:52:47.297582 [info ] [MainThread]: 
[0m01:52:47.297748 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m01:52:47.299897 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.2605166, "process_in_blocks": "0", "process_kernel_time": 1.183455, "process_mem_max_rss": "221298688", "process_out_blocks": "0", "process_user_time": 2.682525}
[0m01:52:47.300175 [debug] [MainThread]: Command `dbt run` failed at 01:52:47.300126 after 5.26 seconds
[0m01:52:47.300400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074088e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d8b93f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d8b92d0>]}
[0m01:52:47.300618 [debug] [MainThread]: Flushing usage events
[0m01:52:48.794460 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:54:06.703475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105994910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e5ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e57e0>]}


============================== 01:54:06.713731 | 96fa8663-47dc-4a35-bb2f-870f9b08fa07 ==============================
[0m01:54:06.713731 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:54:06.714083 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:54:07.670956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96fa8663-47dc-4a35-bb2f-870f9b08fa07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104985990>]}
[0m01:54:07.700425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96fa8663-47dc-4a35-bb2f-870f9b08fa07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10661ba30>]}
[0m01:54:07.700873 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:54:07.812950 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:54:07.889088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:54:07.889354 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:54:07.892786 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.staging
- models.intermatedbt.marts
- models.intermatedbt.fact_tables
[0m01:54:07.910719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96fa8663-47dc-4a35-bb2f-870f9b08fa07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129567fa0>]}
[0m01:54:07.954331 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:54:07.955485 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:54:07.966414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96fa8663-47dc-4a35-bb2f-870f9b08fa07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12957ac50>]}
[0m01:54:07.966734 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m01:54:07.966926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96fa8663-47dc-4a35-bb2f-870f9b08fa07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129567130>]}
[0m01:54:07.967812 [info ] [MainThread]: 
[0m01:54:07.968016 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:54:07.968174 [info ] [MainThread]: 
[0m01:54:07.968441 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:54:07.970892 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m01:54:07.971118 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:54:08.606366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m01:54:08.607750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:54:08.947630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96fa8663-47dc-4a35-bb2f-870f9b08fa07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b8640>]}
[0m01:54:08.949312 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:54:08.953840 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m01:54:08.954688 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m01:54:08.955440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m01:54:08.956023 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m01:54:08.972169 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m01:54:08.973368 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m01:54:09.001589 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m01:54:09.002430 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m01:54:09.002829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:09.539879 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:d873214c-5897-46d9-bc76-22312122ac07&page=queryresults
[0m01:54:10.131268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96fa8663-47dc-4a35-bb2f-870f9b08fa07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128fb1990>]}
[0m01:54:10.131779 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m01:54:10.132162 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m01:54:10.132414 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m01:54:10.132751 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m01:54:10.133015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m01:54:10.133233 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m01:54:10.135308 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m01:54:10.135856 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m01:54:10.137521 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m01:54:10.138052 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m01:54:10.138288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:10.972342 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:fef9ca4f-65bb-4bcb-9f44-9bbe27c935dc&page=queryresults
[0m01:54:11.617373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96fa8663-47dc-4a35-bb2f-870f9b08fa07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1298bd1b0>]}
[0m01:54:11.619074 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.48s]
[0m01:54:11.620353 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m01:54:11.621381 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m01:54:11.622386 [info ] [Thread-1 (]: 3 of 6 START sql incremental model order_ad_data.fact_new_customer_orders ...... [RUN]
[0m01:54:11.623119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m01:54:11.623683 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m01:54:11.637391 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:54:11.638886 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m01:54:11.671126 [debug] [Thread-1 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m01:54:11.671667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:12.036595 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:54:12.038015 [debug] [Thread-1 (]: On model.intermate_dbt.fact_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_new_customer_orders"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders` as DBT_INTERNAL_DEST
        using (

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
)

SELECT
    order_id,
    customer_id,
    order_date,
    total_amount_eur,
    discount_code
FROM stg_shopify
WHERE order_date >= (
    SELECT COALESCE(MAX(order_date), DATE('2000-01-01'))
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`
    
    WHERE order_date IS NOT NULL
    
)


    AND order_date > (
        SELECT COALESCE(MAX(order_date), DATE('2000-01-01'))
        FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`
        WHERE order_date IS NOT NULL
    )

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        ()
    values
        ()


    
[0m01:54:12.382959 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:d673a412-21ca-4db1-8dc7-debb19770b7b&page=queryresults
[0m01:54:12.384709 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:d673a412-21ca-4db1-8dc7-debb19770b7b&page=queryresults
[0m01:54:12.395440 [debug] [Thread-1 (]: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [46:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:54:12.396372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96fa8663-47dc-4a35-bb2f-870f9b08fa07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129507b50>]}
[0m01:54:12.397392 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model order_ad_data.fact_new_customer_orders  [[31mERROR[0m in 0.77s]
[0m01:54:12.398260 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m01:54:12.399175 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_new_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [46:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql.
[0m01:54:12.400929 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m01:54:12.401527 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m01:54:12.402071 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m01:54:12.402534 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m01:54:12.403033 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m01:54:12.403513 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m01:54:12.403953 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m01:54:12.404485 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m01:54:12.405041 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m01:54:12.406166 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:54:12.406890 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:54:12.407263 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_new_customer_orders' was properly closed.
[0m01:54:12.407773 [info ] [MainThread]: 
[0m01:54:12.408175 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 4.44 seconds (4.44s).
[0m01:54:12.409632 [debug] [MainThread]: Command end result
[0m01:54:12.436146 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:54:12.437907 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:54:12.443219 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m01:54:12.443499 [info ] [MainThread]: 
[0m01:54:12.443783 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:54:12.444019 [info ] [MainThread]: 
[0m01:54:12.444345 [error] [MainThread]:   Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [46:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:54:12.444616 [info ] [MainThread]: 
[0m01:54:12.444869 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m01:54:12.447772 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.7854033, "process_in_blocks": "0", "process_kernel_time": 1.028178, "process_mem_max_rss": "216596480", "process_out_blocks": "0", "process_user_time": 2.740271}
[0m01:54:12.448111 [debug] [MainThread]: Command `dbt run` failed at 01:54:12.448049 after 5.79 seconds
[0m01:54:12.448415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105994910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10661ba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a48a00>]}
[0m01:54:12.448712 [debug] [MainThread]: Flushing usage events
[0m01:54:12.931587 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:54:46.711834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037f08b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10463dea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10463d7e0>]}


============================== 01:54:46.721670 | 83279a2f-26b9-4cda-8e95-4b102c08e05a ==============================
[0m01:54:46.721670 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:54:46.722092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:54:47.647037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83279a2f-26b9-4cda-8e95-4b102c08e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122742770>]}
[0m01:54:47.675511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83279a2f-26b9-4cda-8e95-4b102c08e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104104f10>]}
[0m01:54:47.675904 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:54:47.791665 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:54:47.868256 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:54:47.868645 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_new_customer_orders.sql
[0m01:54:47.995607 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.fact_tables
- models.intermatedbt.marts
- models.intermatedbt.staging
[0m01:54:48.005559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83279a2f-26b9-4cda-8e95-4b102c08e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122eb3580>]}
[0m01:54:48.052580 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:54:48.054509 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:54:48.067868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83279a2f-26b9-4cda-8e95-4b102c08e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122fe9ba0>]}
[0m01:54:48.068218 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m01:54:48.068415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83279a2f-26b9-4cda-8e95-4b102c08e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122e73760>]}
[0m01:54:48.069518 [info ] [MainThread]: 
[0m01:54:48.069764 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:54:48.069934 [info ] [MainThread]: 
[0m01:54:48.070230 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:54:48.072989 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m01:54:48.073289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:54:48.523654 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m01:54:48.524794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:54:48.827734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83279a2f-26b9-4cda-8e95-4b102c08e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104610670>]}
[0m01:54:48.828629 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:54:48.832430 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m01:54:48.833373 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m01:54:48.834094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m01:54:48.834411 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m01:54:48.840652 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m01:54:48.841167 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m01:54:48.858507 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m01:54:48.859386 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m01:54:48.859661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:49.304871 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:51fd4928-1055-4a0b-8110-1519ba012321&page=queryresults
[0m01:54:49.838298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83279a2f-26b9-4cda-8e95-4b102c08e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1226b3070>]}
[0m01:54:49.838827 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m01:54:49.839185 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m01:54:49.839417 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m01:54:49.840090 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m01:54:49.840382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m01:54:49.840586 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m01:54:49.842772 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m01:54:49.844764 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m01:54:49.847375 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m01:54:49.848127 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m01:54:49.848392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:50.387369 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:98a2a724-3c5e-4d34-8d62-1f21b64185d8&page=queryresults
[0m01:54:50.816325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83279a2f-26b9-4cda-8e95-4b102c08e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122e67dc0>]}
[0m01:54:50.819022 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m01:54:50.820165 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m01:54:50.821083 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m01:54:50.821947 [info ] [Thread-1 (]: 3 of 6 START sql incremental model order_ad_data.fact_new_customer_orders ...... [RUN]
[0m01:54:50.823084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m01:54:50.823762 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m01:54:50.829838 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:54:50.830700 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m01:54:50.853515 [debug] [Thread-1 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m01:54:50.854042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:51.261186 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:54:51.261839 [debug] [Thread-1 (]: On model.intermate_dbt.fact_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_new_customer_orders"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders` as DBT_INTERNAL_DEST
        using (

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
)

SELECT
    order_id,
    customer_id,
    order_date,
    total_amount_eur,
    discount_code
FROM stg_shopify
WHERE
    order_date >= (
        SELECT COALESCE(MAX(order_date), DATE('2000-01-01'))
        FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`
    )
    
    AND order_date > (
        SELECT COALESCE(MAX(order_date), DATE('2000-01-01'))
        FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`
    )
    
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        ()
    values
        ()


    
[0m01:54:51.550073 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:e57c43c8-eefe-4275-82fa-15be07eef036&page=queryresults
[0m01:54:51.551371 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:e57c43c8-eefe-4275-82fa-15be07eef036&page=queryresults
[0m01:54:51.561568 [debug] [Thread-1 (]: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [42:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:54:51.562567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83279a2f-26b9-4cda-8e95-4b102c08e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12394d8a0>]}
[0m01:54:51.563603 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model order_ad_data.fact_new_customer_orders  [[31mERROR[0m in 0.74s]
[0m01:54:51.564496 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m01:54:51.565240 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_new_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [42:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql.
[0m01:54:51.567137 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m01:54:51.568002 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m01:54:51.568733 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m01:54:51.569260 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m01:54:51.570002 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m01:54:51.570639 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m01:54:51.571255 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m01:54:51.571965 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m01:54:51.572497 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m01:54:51.573861 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:54:51.574642 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:54:51.575022 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_new_customer_orders' was properly closed.
[0m01:54:51.575527 [info ] [MainThread]: 
[0m01:54:51.575976 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 3.51 seconds (3.51s).
[0m01:54:51.577208 [debug] [MainThread]: Command end result
[0m01:54:51.668371 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:54:51.669425 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:54:51.672903 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m01:54:51.673101 [info ] [MainThread]: 
[0m01:54:51.673307 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:54:51.673475 [info ] [MainThread]: 
[0m01:54:51.673680 [error] [MainThread]:   Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [42:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:54:51.673851 [info ] [MainThread]: 
[0m01:54:51.674042 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m01:54:51.676007 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.006092, "process_in_blocks": "0", "process_kernel_time": 1.143716, "process_mem_max_rss": "213024768", "process_out_blocks": "0", "process_user_time": 2.623145}
[0m01:54:51.676276 [debug] [MainThread]: Command `dbt run` failed at 01:54:51.676228 after 5.01 seconds
[0m01:54:51.676502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037f08b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122f5b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122fd0760>]}
[0m01:54:51.676723 [debug] [MainThread]: Flushing usage events
[0m01:54:52.166228 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:56:52.363099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103264910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040b5e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040b5780>]}


============================== 01:56:52.376121 | 33331ca9-b73a-49a9-bd65-bfc0079ed0a0 ==============================
[0m01:56:52.376121 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:56:52.376505 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:56:53.301271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33331ca9-b73a-49a9-bd65-bfc0079ed0a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ab0aa70>]}
[0m01:56:53.330063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33331ca9-b73a-49a9-bd65-bfc0079ed0a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103beb340>]}
[0m01:56:53.330510 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:56:53.442408 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:56:53.519024 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:56:53.519407 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_new_customer_orders.sql
[0m01:56:53.648884 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.marts
- models.intermatedbt.staging
- models.intermatedbt.fact_tables
[0m01:56:53.657981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33331ca9-b73a-49a9-bd65-bfc0079ed0a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b3f1510>]}
[0m01:56:53.703044 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:56:53.704576 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:56:53.715498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33331ca9-b73a-49a9-bd65-bfc0079ed0a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b3901c0>]}
[0m01:56:53.715811 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m01:56:53.715998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33331ca9-b73a-49a9-bd65-bfc0079ed0a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b336d40>]}
[0m01:56:53.716979 [info ] [MainThread]: 
[0m01:56:53.717196 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:56:53.717370 [info ] [MainThread]: 
[0m01:56:53.717736 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:56:53.720554 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m01:56:53.720891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:56:54.242975 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m01:56:54.244657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:56:54.572879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33331ca9-b73a-49a9-bd65-bfc0079ed0a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104088670>]}
[0m01:56:54.574103 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:56:54.578744 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m01:56:54.579676 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m01:56:54.580438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m01:56:54.581012 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m01:56:54.594645 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m01:56:54.596019 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m01:56:54.626906 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m01:56:54.627909 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m01:56:54.628352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:55.128994 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:3f1098c5-2733-4d6a-806c-a79bfe166f96&page=queryresults
[0m01:56:56.052516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33331ca9-b73a-49a9-bd65-bfc0079ed0a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13aaaabc0>]}
[0m01:56:56.053248 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.47s]
[0m01:56:56.053639 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m01:56:56.053894 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m01:56:56.054216 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m01:56:56.054491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m01:56:56.054707 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m01:56:56.057019 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m01:56:56.057983 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m01:56:56.059761 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m01:56:56.060371 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m01:56:56.060621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:56.507657 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:1c604480-172c-411d-8d94-ae6de2d57b97&page=queryresults
[0m01:56:57.061861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33331ca9-b73a-49a9-bd65-bfc0079ed0a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ab0b610>]}
[0m01:56:57.062394 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m01:56:57.062745 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m01:56:57.063252 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m01:56:57.063630 [info ] [Thread-1 (]: 3 of 6 START sql incremental model order_ad_data.fact_new_customer_orders ...... [RUN]
[0m01:56:57.063937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m01:56:57.064152 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m01:56:57.068847 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:56:57.069818 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m01:56:57.097610 [debug] [Thread-1 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m01:56:57.098113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:57.500038 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_new_customer_orders"
[0m01:56:57.501638 [debug] [Thread-1 (]: On model.intermate_dbt.fact_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_new_customer_orders"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders` as DBT_INTERNAL_DEST
        using (

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
)

SELECT
    order_id,
    customer_id,
    order_date,
    total_amount_eur,
    discount_code
FROM stg_shopify
WHERE order_date >= (
    SELECT COALESCE(MAX(order_date), DATE('2000-01-01'))
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`
    
    WHERE order_date IS NOT NULL
    
)


AND order_date > (
    SELECT COALESCE(MAX(order_date), DATE('2000-01-01'))
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`
    WHERE order_date IS NOT NULL
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        ()
    values
        ()


    
[0m01:56:57.742017 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:784462a1-04f0-49f6-adc2-a73b8cdac8f4&page=queryresults
[0m01:56:57.743382 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:784462a1-04f0-49f6-adc2-a73b8cdac8f4&page=queryresults
[0m01:56:57.753275 [debug] [Thread-1 (]: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [46:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:56:57.754271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33331ca9-b73a-49a9-bd65-bfc0079ed0a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bab8880>]}
[0m01:56:57.755277 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model order_ad_data.fact_new_customer_orders  [[31mERROR[0m in 0.69s]
[0m01:56:57.756148 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m01:56:57.756900 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_new_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [46:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql.
[0m01:56:57.758957 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m01:56:57.759739 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m01:56:57.760592 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m01:56:57.761120 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m01:56:57.761720 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m01:56:57.762337 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m01:56:57.762811 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m01:56:57.763299 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m01:56:57.763821 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m01:56:57.764987 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:56:57.765816 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:56:57.766229 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_new_customer_orders' was properly closed.
[0m01:56:57.766749 [info ] [MainThread]: 
[0m01:56:57.767168 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 4.05 seconds (4.05s).
[0m01:56:57.768396 [debug] [MainThread]: Command end result
[0m01:56:57.848471 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m01:56:57.849507 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m01:56:57.853032 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m01:56:57.853225 [info ] [MainThread]: 
[0m01:56:57.853450 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:56:57.853620 [info ] [MainThread]: 
[0m01:56:57.853823 [error] [MainThread]:   Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ")" at [46:10]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m01:56:57.853986 [info ] [MainThread]: 
[0m01:56:57.854166 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m01:56:57.856178 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.535404, "process_in_blocks": "0", "process_kernel_time": 1.150501, "process_mem_max_rss": "219299840", "process_out_blocks": "0", "process_user_time": 2.738371}
[0m01:56:57.856444 [debug] [MainThread]: Command `dbt run` failed at 01:56:57.856398 after 5.54 seconds
[0m01:56:57.856663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103264910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f7f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fd77f0>]}
[0m01:56:57.856866 [debug] [MainThread]: Flushing usage events
[0m01:56:58.336216 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:01:45.299004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d888b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd5ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd57e0>]}


============================== 02:01:45.307115 | 53ab6d4a-66d0-4b8c-8e19-bc2a06433c14 ==============================
[0m02:01:45.307115 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:01:45.307519 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m02:01:46.248069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53ab6d4a-66d0-4b8c-8e19-bc2a06433c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121242770>]}
[0m02:01:46.276001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53ab6d4a-66d0-4b8c-8e19-bc2a06433c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10669cf10>]}
[0m02:01:46.276393 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m02:01:46.387349 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:01:46.468084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:01:46.468499 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_new_customer_orders.sql
[0m02:01:46.597739 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.staging
- models.intermatedbt.fact_tables
- models.intermatedbt.marts
[0m02:01:46.605731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53ab6d4a-66d0-4b8c-8e19-bc2a06433c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124de10f0>]}
[0m02:01:46.651742 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m02:01:46.653196 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m02:01:46.665042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53ab6d4a-66d0-4b8c-8e19-bc2a06433c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124c056c0>]}
[0m02:01:46.665529 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m02:01:46.665724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53ab6d4a-66d0-4b8c-8e19-bc2a06433c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124c05480>]}
[0m02:01:46.666666 [info ] [MainThread]: 
[0m02:01:46.666861 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:01:46.667013 [info ] [MainThread]: 
[0m02:01:46.667280 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:01:46.669591 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m02:01:46.669818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:01:47.548749 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m02:01:47.549789 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:01:47.876905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53ab6d4a-66d0-4b8c-8e19-bc2a06433c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b2bdf0>]}
[0m02:01:47.878819 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:01:47.884329 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m02:01:47.885277 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m02:01:47.886033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m02:01:47.886621 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m02:01:47.899916 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m02:01:47.901170 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m02:01:47.929613 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m02:01:47.930654 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m02:01:47.931053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:01:48.474995 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:bb3d1164-e735-4c2a-b27c-69342dca0475&page=queryresults
[0m02:01:49.044515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53ab6d4a-66d0-4b8c-8e19-bc2a06433c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1211b3070>]}
[0m02:01:49.045039 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m02:01:49.045434 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m02:01:49.045686 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m02:01:49.046002 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m02:01:49.046275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m02:01:49.046492 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m02:01:49.048606 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m02:01:49.049113 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m02:01:49.050852 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m02:01:49.051270 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m02:01:49.051514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:01:49.588510 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:af96d19e-d10e-4778-8854-845f5e64a167&page=queryresults
[0m02:01:50.134146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53ab6d4a-66d0-4b8c-8e19-bc2a06433c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124c67dc0>]}
[0m02:01:50.135531 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.09s]
[0m02:01:50.136424 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m02:01:50.137492 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m02:01:50.138328 [info ] [Thread-1 (]: 3 of 6 START sql view model order_ad_data.fact_new_customer_orders ............. [RUN]
[0m02:01:50.139102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m02:01:50.139677 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m02:01:50.144911 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m02:01:50.146041 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m02:01:50.155064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:01:50.160075 [debug] [Thread-1 (]: Compilation Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Trying to create view `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`, but it currently exists as a table. Either drop `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/relations/view/replace.sql)
  > called by macro bigquery__create_or_replace_view (macros/relations/view/replace.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
[0m02:01:50.160717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53ab6d4a-66d0-4b8c-8e19-bc2a06433c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12525bd30>]}
[0m02:01:50.161422 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model order_ad_data.fact_new_customer_orders .... [[31mERROR[0m in 0.02s]
[0m02:01:50.162108 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m02:01:50.162713 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_new_customer_orders' to be skipped because of status 'error'.  Reason: Compilation Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Trying to create view `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`, but it currently exists as a table. Either drop `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/relations/view/replace.sql)
  > called by macro bigquery__create_or_replace_view (macros/relations/view/replace.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql).
[0m02:01:50.164046 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m02:01:50.164564 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m02:01:50.164998 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m02:01:50.165382 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m02:01:50.165824 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m02:01:50.166217 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m02:01:50.166574 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m02:01:50.166949 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m02:01:50.167295 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m02:01:50.168269 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:01:50.168931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:01:50.169251 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_new_customer_orders' was properly closed.
[0m02:01:50.169653 [info ] [MainThread]: 
[0m02:01:50.169983 [info ] [MainThread]: Finished running 3 table models, 3 view models in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m02:01:50.171066 [debug] [MainThread]: Command end result
[0m02:01:50.192678 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m02:01:50.194202 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m02:01:50.198790 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m02:01:50.199031 [info ] [MainThread]: 
[0m02:01:50.199274 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:01:50.199478 [info ] [MainThread]: 
[0m02:01:50.199747 [error] [MainThread]:   Compilation Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Trying to create view `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`, but it currently exists as a table. Either drop `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/relations/view/replace.sql)
  > called by macro bigquery__create_or_replace_view (macros/relations/view/replace.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
[0m02:01:50.199979 [info ] [MainThread]: 
[0m02:01:50.200193 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m02:01:50.202584 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.943967, "process_in_blocks": "0", "process_kernel_time": 0.942015, "process_mem_max_rss": "215416832", "process_out_blocks": "0", "process_user_time": 2.752317}
[0m02:01:50.202911 [debug] [MainThread]: Command `dbt run` failed at 02:01:50.202853 after 4.94 seconds
[0m02:01:50.203171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d888b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121242770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124d7df30>]}
[0m02:01:50.203420 [debug] [MainThread]: Flushing usage events
[0m02:01:50.684293 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:03:35.801496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110380910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112495e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112495780>]}


============================== 02:03:35.812129 | 1b199259-1e40-4423-a9b9-48d04b8a7f5d ==============================
[0m02:03:35.812129 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:03:35.812500 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:03:36.821194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b199259-1e40-4423-a9b9-48d04b8a7f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103f7970>]}
[0m02:03:36.849766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b199259-1e40-4423-a9b9-48d04b8a7f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116cb340>]}
[0m02:03:36.850171 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m02:03:36.962527 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:03:37.038836 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:03:37.039319 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_new_customer_orders.sql
[0m02:03:37.168467 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.staging
- models.intermatedbt.fact_tables
- models.intermatedbt.marts
[0m02:03:37.176672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b199259-1e40-4423-a9b9-48d04b8a7f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147ef14e0>]}
[0m02:03:37.220081 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m02:03:37.221581 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m02:03:37.233024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b199259-1e40-4423-a9b9-48d04b8a7f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147e5d4b0>]}
[0m02:03:37.233328 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m02:03:37.233514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b199259-1e40-4423-a9b9-48d04b8a7f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147e5c5e0>]}
[0m02:03:37.234439 [info ] [MainThread]: 
[0m02:03:37.234654 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:03:37.234817 [info ] [MainThread]: 
[0m02:03:37.235102 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:03:37.237484 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m02:03:37.237721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:03:37.778775 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m02:03:37.779900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:03:38.103890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b199259-1e40-4423-a9b9-48d04b8a7f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112468670>]}
[0m02:03:38.105384 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:03:38.110221 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m02:03:38.111156 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m02:03:38.111914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m02:03:38.112483 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m02:03:38.126170 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m02:03:38.127713 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m02:03:38.157496 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m02:03:38.158514 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m02:03:38.158973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:03:38.777876 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:8f037445-7146-4bda-997f-9f71408ab097&page=queryresults
[0m02:03:39.467264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b199259-1e40-4423-a9b9-48d04b8a7f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1476a9960>]}
[0m02:03:39.467774 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.35s]
[0m02:03:39.468159 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m02:03:39.468424 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m02:03:39.468788 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m02:03:39.469118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m02:03:39.469375 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m02:03:39.471470 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m02:03:39.472050 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m02:03:39.473817 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m02:03:39.474399 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m02:03:39.474642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:03:39.986074 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:381b7499-ecb5-4b15-8aed-c75ad1ebe81f&page=queryresults
[0m02:03:40.728211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b199259-1e40-4423-a9b9-48d04b8a7f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147d66d70>]}
[0m02:03:40.729686 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.26s]
[0m02:03:40.730769 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m02:03:40.732349 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m02:03:40.733320 [info ] [Thread-1 (]: 3 of 6 START sql incremental model order_ad_data.fact_new_customer_orders ...... [RUN]
[0m02:03:40.734144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m02:03:40.734766 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m02:03:40.743811 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m02:03:40.745109 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m02:03:40.779968 [debug] [Thread-1 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m02:03:40.780567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:03:41.276540 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_new_customer_orders"
[0m02:03:41.277655 [debug] [Thread-1 (]: On model.intermate_dbt.fact_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_new_customer_orders"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders` as DBT_INTERNAL_DEST
        using (

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
),

first_orders AS (
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
)

SELECT
    s.order_date,
    COUNT(DISTINCT s.customer_id) AS new_customers_count,
    SUM(s.total_price_eur) AS total_revenue_eur
FROM stg_shopify s
JOIN first_orders f
    ON s.customer_id = f.customer_id
    AND s.order_date = f.first_order_date
WHERE s.status NOT IN ('canceled')  -- Ensure valid orders

    AND s.order_date > (SELECT MAX(order_date) FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`)  -- Incremental logic

GROUP BY s.order_date
ORDER BY s.order_date;
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        ()
    values
        ()


    
[0m02:03:41.544235 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:83b84b1e-54ac-4f23-a48b-05def68720c7&page=queryresults
[0m02:03:41.544923 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:83b84b1e-54ac-4f23-a48b-05def68720c7&page=queryresults
[0m02:03:41.550541 [debug] [Thread-1 (]: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Expected ")" but got ";" at [40:22]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m02:03:41.551232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b199259-1e40-4423-a9b9-48d04b8a7f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147f02380>]}
[0m02:03:41.551777 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model order_ad_data.fact_new_customer_orders  [[31mERROR[0m in 0.82s]
[0m02:03:41.552240 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m02:03:41.552671 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_new_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Expected ")" but got ";" at [40:22]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql.
[0m02:03:41.553701 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m02:03:41.554103 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m02:03:41.554425 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m02:03:41.554700 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m02:03:41.555028 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m02:03:41.555357 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m02:03:41.555638 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m02:03:41.555948 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m02:03:41.556252 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m02:03:41.556972 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:03:41.557464 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:03:41.557684 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_new_customer_orders' was properly closed.
[0m02:03:41.557987 [info ] [MainThread]: 
[0m02:03:41.558259 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 4.32 seconds (4.32s).
[0m02:03:41.558955 [debug] [MainThread]: Command end result
[0m02:03:41.639094 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m02:03:41.640141 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m02:03:41.643764 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m02:03:41.643975 [info ] [MainThread]: 
[0m02:03:41.644190 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:03:41.644367 [info ] [MainThread]: 
[0m02:03:41.644568 [error] [MainThread]:   Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Expected ")" but got ";" at [40:22]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m02:03:41.644738 [info ] [MainThread]: 
[0m02:03:41.644908 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m02:03:41.646659 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.8877625, "process_in_blocks": "0", "process_kernel_time": 0.907311, "process_mem_max_rss": "207749120", "process_out_blocks": "0", "process_user_time": 2.886936}
[0m02:03:41.646892 [debug] [MainThread]: Command `dbt run` failed at 02:03:41.646850 after 5.89 seconds
[0m02:03:41.647108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110380910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147f2b7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15baa1e10>]}
[0m02:03:41.647318 [debug] [MainThread]: Flushing usage events
[0m02:03:42.124829 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:04:27.053774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103420850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10426ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10426d810>]}


============================== 02:04:27.066949 | 4c76bb5f-0751-46b8-b7e8-3b432d812462 ==============================
[0m02:04:27.066949 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:04:27.067996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'profiles_dir': '/Users/victoruwaje/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:04:27.966189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c76bb5f-0751-46b8-b7e8-3b432d812462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023918d0>]}
[0m02:04:27.996132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c76bb5f-0751-46b8-b7e8-3b432d812462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d37550>]}
[0m02:04:27.996611 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m02:04:28.110600 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:04:28.191123 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:04:28.191528 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_new_customer_orders.sql
[0m02:04:28.314393 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.fact_tables
- models.intermatedbt.staging
- models.intermatedbt.marts
[0m02:04:28.321998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c76bb5f-0751-46b8-b7e8-3b432d812462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cfd90f0>]}
[0m02:04:28.364374 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m02:04:28.365618 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m02:04:28.376563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c76bb5f-0751-46b8-b7e8-3b432d812462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cfcfbb0>]}
[0m02:04:28.376881 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m02:04:28.377064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c76bb5f-0751-46b8-b7e8-3b432d812462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cfcf910>]}
[0m02:04:28.378012 [info ] [MainThread]: 
[0m02:04:28.378220 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:04:28.378375 [info ] [MainThread]: 
[0m02:04:28.378659 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:04:28.381132 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m02:04:28.381378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:28.862317 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m02:04:28.864008 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:04:29.477644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c76bb5f-0751-46b8-b7e8-3b432d812462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104240640>]}
[0m02:04:29.479169 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:04:29.483889 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m02:04:29.484970 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m02:04:29.485711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m02:04:29.486300 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m02:04:29.499698 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m02:04:29.500775 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m02:04:29.528899 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m02:04:29.529802 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m02:04:29.530185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:30.409743 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:c9788a82-3677-4307-8e79-e87622ccd720&page=queryresults
[0m02:04:31.002459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c76bb5f-0751-46b8-b7e8-3b432d812462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031e20b0>]}
[0m02:04:31.002983 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.52s]
[0m02:04:31.003367 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m02:04:31.003620 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m02:04:31.003976 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m02:04:31.004296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m02:04:31.004547 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m02:04:31.006621 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m02:04:31.007228 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m02:04:31.008942 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m02:04:31.009562 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m02:04:31.009805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:31.617552 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:6030c2c2-e60f-4f23-b04c-5e46af619cc8&page=queryresults
[0m02:04:32.130024 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c76bb5f-0751-46b8-b7e8-3b432d812462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ce5f7c0>]}
[0m02:04:32.131367 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m02:04:32.132742 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m02:04:32.134117 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m02:04:32.135038 [info ] [Thread-1 (]: 3 of 6 START sql view model order_ad_data.fact_new_customer_orders ............. [RUN]
[0m02:04:32.135848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m02:04:32.136227 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m02:04:32.139518 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m02:04:32.141236 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m02:04:32.144057 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_new_customer_orders"
[0m02:04:32.144886 [debug] [Thread-1 (]: On model.intermate_dbt.fact_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_new_customer_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`
  OPTIONS()
  as WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
),

first_orders AS (
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
)

SELECT
    s.order_date,
    COUNT(DISTINCT s.customer_id) AS new_customers_count,
    SUM(s.total_price_eur) AS total_revenue_eur
FROM stg_shopify s
JOIN first_orders f
    ON s.customer_id = f.customer_id
    AND s.order_date = f.first_order_date
WHERE s.status NOT IN ('canceled')  -- Ensure valid orders
GROUP BY s.order_date
ORDER BY s.order_date;;


[0m02:04:32.145310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:32.495817 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:d0af970c-fa7c-44f7-b94c-b81212c0dc1e&page=queryresults
[0m02:04:32.497088 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:d0af970c-fa7c-44f7-b94c-b81212c0dc1e&page=queryresults
[0m02:04:32.505531 [debug] [Thread-1 (]: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ";" at [30:23]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m02:04:32.506496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c76bb5f-0751-46b8-b7e8-3b432d812462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d595300>]}
[0m02:04:32.507487 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model order_ad_data.fact_new_customer_orders .... [[31mERROR[0m in 0.37s]
[0m02:04:32.508346 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m02:04:32.509084 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_new_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ";" at [30:23]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql.
[0m02:04:32.510893 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m02:04:32.511665 [info ] [Thread-1 (]: 4 of 6 SKIP relation order_ad_data.dim_customers ............................... [[33mSKIP[0m]
[0m02:04:32.512232 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m02:04:32.512458 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m02:04:32.512734 [info ] [Thread-1 (]: 5 of 6 SKIP relation order_ad_data.fact_combined_performance ................... [[33mSKIP[0m]
[0m02:04:32.513024 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m02:04:32.513256 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m02:04:32.513474 [info ] [Thread-1 (]: 6 of 6 SKIP relation order_ad_data.fact_discount_performance ................... [[33mSKIP[0m]
[0m02:04:32.513748 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m02:04:32.514390 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:04:32.514777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:04:32.514956 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_new_customer_orders' was properly closed.
[0m02:04:32.515208 [info ] [MainThread]: 
[0m02:04:32.515420 [info ] [MainThread]: Finished running 3 table models, 3 view models in 0 hours 0 minutes and 4.14 seconds (4.14s).
[0m02:04:32.516043 [debug] [MainThread]: Command end result
[0m02:04:32.532557 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m02:04:32.533891 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m02:04:32.538206 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m02:04:32.538499 [info ] [MainThread]: 
[0m02:04:32.538718 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:04:32.538900 [info ] [MainThread]: 
[0m02:04:32.539114 [error] [MainThread]:   Database Error in model fact_new_customer_orders (models/facts_tables/fact_new_customer_orders.sql)
  Syntax error: Unexpected ";" at [30:23]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_new_customer_orders.sql
[0m02:04:32.539295 [info ] [MainThread]: 
[0m02:04:32.539475 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m02:04:32.541392 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.5311227, "process_in_blocks": "0", "process_kernel_time": 1.198192, "process_mem_max_rss": "214499328", "process_out_blocks": "0", "process_user_time": 2.554502}
[0m02:04:32.541703 [debug] [MainThread]: Command `dbt run` failed at 02:04:32.541652 after 5.53 seconds
[0m02:04:32.541998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103420850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023918d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ce83730>]}
[0m02:04:32.542231 [debug] [MainThread]: Flushing usage events
[0m02:04:32.968455 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:04:48.951300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103868940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046b9e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046b9750>]}


============================== 02:04:48.955423 | 0d2061c6-a27b-4d98-95ff-2340cc7bef08 ==============================
[0m02:04:48.955423 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:04:48.955818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'profiles_dir': '/Users/victoruwaje/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:04:49.835940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d2061c6-a27b-4d98-95ff-2340cc7bef08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f10a1a0>]}
[0m02:04:49.863790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d2061c6-a27b-4d98-95ff-2340cc7bef08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044eefb0>]}
[0m02:04:49.864202 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m02:04:49.972813 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:04:50.044129 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:04:50.044553 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_new_customer_orders.sql
[0m02:04:50.165771 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.marts
- models.intermatedbt.fact_tables
- models.intermatedbt.staging
[0m02:04:50.173033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d2061c6-a27b-4d98-95ff-2340cc7bef08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f9e7fa0>]}
[0m02:04:50.215227 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m02:04:50.216501 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m02:04:50.226340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d2061c6-a27b-4d98-95ff-2340cc7bef08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f9d8520>]}
[0m02:04:50.226651 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m02:04:50.226841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d2061c6-a27b-4d98-95ff-2340cc7bef08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f9d81f0>]}
[0m02:04:50.227963 [info ] [MainThread]: 
[0m02:04:50.228233 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:04:50.228409 [info ] [MainThread]: 
[0m02:04:50.228719 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:04:50.231870 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m02:04:50.232144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:50.772467 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m02:04:50.773957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:04:51.094822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d2061c6-a27b-4d98-95ff-2340cc7bef08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102643160>]}
[0m02:04:51.095880 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:04:51.100586 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m02:04:51.101739 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m02:04:51.102670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m02:04:51.103290 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m02:04:51.116308 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m02:04:51.117441 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m02:04:51.148632 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m02:04:51.149620 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m02:04:51.150036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:51.679912 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:c6e3ec7a-7a57-4f57-a7ad-d7e427f9b69f&page=queryresults
[0m02:04:52.267049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d2061c6-a27b-4d98-95ff-2340cc7bef08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041b55a0>]}
[0m02:04:52.267580 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m02:04:52.267984 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m02:04:52.268254 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m02:04:52.268636 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m02:04:52.268981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m02:04:52.269240 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m02:04:52.271491 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m02:04:52.272005 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m02:04:52.274008 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m02:04:52.274505 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m02:04:52.274765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:52.810948 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:f692a768-672f-46be-a851-14a5e40fdda9&page=queryresults
[0m02:04:53.321739 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d2061c6-a27b-4d98-95ff-2340cc7bef08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f866b00>]}
[0m02:04:53.323071 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m02:04:53.324049 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m02:04:53.325659 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m02:04:53.327092 [info ] [Thread-1 (]: 3 of 6 START sql view model order_ad_data.fact_new_customer_orders ............. [RUN]
[0m02:04:53.327925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m02:04:53.328515 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m02:04:53.333629 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m02:04:53.334889 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m02:04:53.338777 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_new_customer_orders"
[0m02:04:53.339714 [debug] [Thread-1 (]: On model.intermate_dbt.fact_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_new_customer_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`
  OPTIONS()
  as WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
),

first_orders AS (
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
)

SELECT
    s.order_date,
    COUNT(DISTINCT s.customer_id) AS new_customers_count,
    SUM(s.total_price_eur) AS total_revenue_eur
FROM stg_shopify s
JOIN first_orders f
    ON s.customer_id = f.customer_id
    AND s.order_date = f.first_order_date
WHERE s.status NOT IN ('canceled')  -- Ensure valid orders
GROUP BY s.order_date
ORDER BY s.order_date;


[0m02:04:53.340278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:53.942003 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:9c7f0198-0911-43a1-982d-21404131005a&page=queryresults
[0m02:04:54.399948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d2061c6-a27b-4d98-95ff-2340cc7bef08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f8074f0>]}
[0m02:04:54.401523 [info ] [Thread-1 (]: 3 of 6 OK created sql view model order_ad_data.fact_new_customer_orders ........ [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m02:04:54.402545 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m02:04:54.403771 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m02:04:54.404663 [info ] [Thread-1 (]: 4 of 6 START sql table model order_ad_data.dim_customers ....................... [RUN]
[0m02:04:54.405609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_new_customer_orders, now model.intermate_dbt.dim_customers)
[0m02:04:54.406197 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.dim_customers
[0m02:04:54.412285 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.dim_customers"
[0m02:04:54.413192 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.dim_customers
[0m02:04:54.444624 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.dim_customers"
[0m02:04:54.445517 [debug] [Thread-1 (]: On model.intermate_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.dim_customers"} */

  
    

    create or replace table `atomic-sled-453015-g3`.`order_ad_data`.`dim_customers`
      
    
    

    OPTIONS()
    as (
      

SELECT
    customer_id,
    COUNT(DISTINCT order_id) AS total_orders,
    MIN(order_date) AS first_order_date,
    MAX(order_date) AS last_order_date,
    SUM(total_amount_eur) AS lifetime_value
FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`
GROUP BY customer_id
    );
  
[0m02:04:54.445933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:55.038731 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:65b1ca4c-dc8f-4594-953b-f46a93263e7c&page=queryresults
[0m02:04:55.263768 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:65b1ca4c-dc8f-4594-953b-f46a93263e7c&page=queryresults
[0m02:04:55.273003 [debug] [Thread-1 (]: Database Error in model dim_customers (models/facts_tables/dim_customers.sql)
  Unrecognized name: customer_id at [16:5]
  compiled code at target/run/intermate_dbt/models/facts_tables/dim_customers.sql
[0m02:04:55.274088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d2061c6-a27b-4d98-95ff-2340cc7bef08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ffaf6a0>]}
[0m02:04:55.275236 [error] [Thread-1 (]: 4 of 6 ERROR creating sql table model order_ad_data.dim_customers .............. [[31mERROR[0m in 0.87s]
[0m02:04:55.276141 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m02:04:55.276761 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m02:04:55.277676 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models/facts_tables/dim_customers.sql)
  Unrecognized name: customer_id at [16:5]
  compiled code at target/run/intermate_dbt/models/facts_tables/dim_customers.sql.
[0m02:04:55.278633 [info ] [Thread-1 (]: 5 of 6 START sql table model order_ad_data.fact_combined_performance ........... [RUN]
[0m02:04:55.280509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.dim_customers, now model.intermate_dbt.fact_combined_performance)
[0m02:04:55.281115 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_combined_performance
[0m02:04:55.286271 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_combined_performance"
[0m02:04:55.287355 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_combined_performance
[0m02:04:55.291011 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_combined_performance"
[0m02:04:55.291967 [debug] [Thread-1 (]: On model.intermate_dbt.fact_combined_performance: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_combined_performance"} */

  
    

    create or replace table `atomic-sled-453015-g3`.`order_ad_data`.`fact_combined_performance`
      
    
    

    OPTIONS()
    as (
      

SELECT
    s.order_date,
    COUNT(DISTINCT s.order_id) AS total_orders,
    SUM(s.total_amount_eur) AS total_revenue,
    f.impressions,
    f.clicks,
    f.ad_spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders` s
LEFT JOIN `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads` f
ON s.order_date = f.ad_date
GROUP BY s.order_date, f.impressions, f.clicks, f.ad_spend_eur
ORDER BY s.order_date DESC
    );
  
[0m02:04:55.292525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:56.601426 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:8ff1463e-cb26-4d53-a76a-7ed3b08cf205&page=queryresults
[0m02:04:56.817481 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:8ff1463e-cb26-4d53-a76a-7ed3b08cf205&page=queryresults
[0m02:04:56.820741 [debug] [Thread-1 (]: Database Error in model fact_combined_performance (models/facts_tables/fact_combined_performance.sql)
  Name order_id not found inside s at [17:22]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_combined_performance.sql
[0m02:04:56.821926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d2061c6-a27b-4d98-95ff-2340cc7bef08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c051b10>]}
[0m02:04:56.823184 [error] [Thread-1 (]: 5 of 6 ERROR creating sql table model order_ad_data.fact_combined_performance .. [[31mERROR[0m in 1.54s]
[0m02:04:56.824275 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m02:04:56.825228 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m02:04:56.825892 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_combined_performance' to be skipped because of status 'error'.  Reason: Database Error in model fact_combined_performance (models/facts_tables/fact_combined_performance.sql)
  Name order_id not found inside s at [17:22]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_combined_performance.sql.
[0m02:04:56.826552 [info ] [Thread-1 (]: 6 of 6 START sql table model order_ad_data.fact_discount_performance ........... [RUN]
[0m02:04:56.827438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_combined_performance, now model.intermate_dbt.fact_discount_performance)
[0m02:04:56.827995 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_discount_performance
[0m02:04:56.832547 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_discount_performance"
[0m02:04:56.833582 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_discount_performance
[0m02:04:56.839241 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_discount_performance"
[0m02:04:56.840196 [debug] [Thread-1 (]: On model.intermate_dbt.fact_discount_performance: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_discount_performance"} */

  
    

    create or replace table `atomic-sled-453015-g3`.`order_ad_data`.`fact_discount_performance`
      
    
    

    OPTIONS()
    as (
      

SELECT
    discount_code,
    COUNT(DISTINCT order_id) AS total_orders,
    SUM(total_amount_eur) AS total_revenue
FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`
WHERE discount_code IS NOT NULL
GROUP BY discount_code
ORDER BY total_revenue DESC
    );
  
[0m02:04:56.840732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:57.524004 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:8ae6493f-d321-4253-951f-6ccd3194ef63&page=queryresults
[0m02:04:57.746033 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:8ae6493f-d321-4253-951f-6ccd3194ef63&page=queryresults
[0m02:04:57.748526 [debug] [Thread-1 (]: Database Error in model fact_discount_performance (models/facts_tables/fact_discount_performance.sql)
  Unrecognized name: discount_code at [20:7]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_discount_performance.sql
[0m02:04:57.749379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d2061c6-a27b-4d98-95ff-2340cc7bef08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c065150>]}
[0m02:04:57.751171 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model order_ad_data.fact_discount_performance .. [[31mERROR[0m in 0.92s]
[0m02:04:57.752324 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m02:04:57.753042 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_discount_performance' to be skipped because of status 'error'.  Reason: Database Error in model fact_discount_performance (models/facts_tables/fact_discount_performance.sql)
  Unrecognized name: discount_code at [20:7]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_discount_performance.sql.
[0m02:04:57.754648 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:04:57.755486 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:04:57.755896 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_discount_performance' was properly closed.
[0m02:04:57.756436 [info ] [MainThread]: 
[0m02:04:57.756873 [info ] [MainThread]: Finished running 3 table models, 3 view models in 0 hours 0 minutes and 7.53 seconds (7.53s).
[0m02:04:57.758996 [debug] [MainThread]: Command end result
[0m02:04:57.784807 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m02:04:57.786797 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m02:04:57.792210 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m02:04:57.792495 [info ] [MainThread]: 
[0m02:04:57.792781 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m02:04:57.793018 [info ] [MainThread]: 
[0m02:04:57.793293 [error] [MainThread]:   Database Error in model dim_customers (models/facts_tables/dim_customers.sql)
  Unrecognized name: customer_id at [16:5]
  compiled code at target/run/intermate_dbt/models/facts_tables/dim_customers.sql
[0m02:04:57.793515 [info ] [MainThread]: 
[0m02:04:57.793772 [error] [MainThread]:   Database Error in model fact_combined_performance (models/facts_tables/fact_combined_performance.sql)
  Name order_id not found inside s at [17:22]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_combined_performance.sql
[0m02:04:57.793992 [info ] [MainThread]: 
[0m02:04:57.794243 [error] [MainThread]:   Database Error in model fact_discount_performance (models/facts_tables/fact_discount_performance.sql)
  Unrecognized name: discount_code at [20:7]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_discount_performance.sql
[0m02:04:57.794457 [info ] [MainThread]: 
[0m02:04:57.794689 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=0 TOTAL=6
[0m02:04:57.796900 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.883201, "process_in_blocks": "0", "process_kernel_time": 0.946344, "process_mem_max_rss": "214401024", "process_out_blocks": "0", "process_user_time": 2.939042}
[0m02:04:57.797229 [debug] [MainThread]: Command `dbt run` failed at 02:04:57.797172 after 8.88 seconds
[0m02:04:57.797496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103868940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044eefb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038fc520>]}
[0m02:04:57.797759 [debug] [MainThread]: Flushing usage events
[0m02:04:58.318754 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:06:53.879812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c80940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c91e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c91750>]}


============================== 02:06:53.884123 | 70631d8c-8913-4b87-a432-cbb7c5ee8054 ==============================
[0m02:06:53.884123 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:06:53.884489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:06:54.770304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70631d8c-8913-4b87-a432-cbb7c5ee8054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146a41d50>]}
[0m02:06:54.798553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70631d8c-8913-4b87-a432-cbb7c5ee8054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fcb310>]}
[0m02:06:54.798973 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m02:06:55.005243 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:06:55.077512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:06:55.077902 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_new_customer_orders.sql
[0m02:06:55.202676 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.staging
- models.intermatedbt.fact_tables
- models.intermatedbt.marts
[0m02:06:55.211113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70631d8c-8913-4b87-a432-cbb7c5ee8054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1473f1540>]}
[0m02:06:55.252891 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m02:06:55.254200 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m02:06:55.264281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70631d8c-8913-4b87-a432-cbb7c5ee8054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1475342e0>]}
[0m02:06:55.264586 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m02:06:55.264784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70631d8c-8913-4b87-a432-cbb7c5ee8054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147536fe0>]}
[0m02:06:55.265694 [info ] [MainThread]: 
[0m02:06:55.265891 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:06:55.266046 [info ] [MainThread]: 
[0m02:06:55.266317 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:06:55.268667 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m02:06:55.268899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:06:55.794637 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m02:06:55.795781 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:06:56.209840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70631d8c-8913-4b87-a432-cbb7c5ee8054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146a412a0>]}
[0m02:06:56.211579 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:06:56.216064 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m02:06:56.217004 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m02:06:56.217747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m02:06:56.218315 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m02:06:56.231524 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m02:06:56.232610 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m02:06:56.262357 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m02:06:56.263190 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m02:06:56.263568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:56.919416 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:c3b77230-af3d-48e3-a1e4-c919b4e20ab9&page=queryresults
[0m02:06:57.607689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70631d8c-8913-4b87-a432-cbb7c5ee8054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1469e1750>]}
[0m02:06:57.608213 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.39s]
[0m02:06:57.608599 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m02:06:57.608853 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m02:06:57.609170 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m02:06:57.609443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m02:06:57.609663 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m02:06:57.611763 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m02:06:57.612225 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m02:06:57.614003 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m02:06:57.614430 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m02:06:57.614686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:58.050670 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:e5cf5057-b222-4458-9e1d-7354958ac466&page=queryresults
[0m02:06:58.564492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70631d8c-8913-4b87-a432-cbb7c5ee8054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147266680>]}
[0m02:06:58.566107 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m02:06:58.567359 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m02:06:58.568799 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_new_customer_orders
[0m02:06:58.569690 [info ] [Thread-1 (]: 3 of 6 START sql incremental model order_ad_data.fact_new_customer_orders ...... [RUN]
[0m02:06:58.570481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_new_customer_orders)
[0m02:06:58.571082 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_new_customer_orders
[0m02:06:58.577649 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_new_customer_orders"
[0m02:06:58.578908 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_new_customer_orders
[0m02:06:58.615670 [debug] [Thread-1 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m02:06:58.616540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:59.002971 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_new_customer_orders"
[0m02:06:59.004284 [debug] [Thread-1 (]: On model.intermate_dbt.fact_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_new_customer_orders"} */

  
    

    create or replace table `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`
      
    
    

    OPTIONS()
    as (
      

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
),

first_orders AS (
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
)

SELECT
    s.order_date,
    COUNT(DISTINCT s.customer_id) AS new_customers_count,
    ROUND(SUM(s.total_price_eur), 2) AS total_revenue_eur  -- Round to 2 decimal places
FROM stg_shopify s
JOIN first_orders f
    ON s.customer_id = f.customer_id
    AND s.order_date = f.first_order_date
WHERE s.status NOT IN ('canceled')  -- Ensure valid orders

GROUP BY s.order_date
ORDER BY s.order_date
    );
  
[0m02:06:59.685372 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:a447990d-d4f1-4f1c-8ec0-c3c496968387&page=queryresults
[0m02:07:02.346099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70631d8c-8913-4b87-a432-cbb7c5ee8054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1475374f0>]}
[0m02:07:02.347888 [info ] [Thread-1 (]: 3 of 6 OK created sql incremental model order_ad_data.fact_new_customer_orders . [[32mCREATE TABLE (51.0 rows, 17.5 KiB processed)[0m in 3.78s]
[0m02:07:02.348615 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_new_customer_orders
[0m02:07:02.349565 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m02:07:02.350261 [info ] [Thread-1 (]: 4 of 6 START sql table model order_ad_data.dim_customers ....................... [RUN]
[0m02:07:02.351011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_new_customer_orders, now model.intermate_dbt.dim_customers)
[0m02:07:02.351582 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.dim_customers
[0m02:07:02.356795 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.dim_customers"
[0m02:07:02.357935 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.dim_customers
[0m02:07:02.372510 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.dim_customers"
[0m02:07:02.373725 [debug] [Thread-1 (]: On model.intermate_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.dim_customers"} */

  
    

    create or replace table `atomic-sled-453015-g3`.`order_ad_data`.`dim_customers`
      
    
    

    OPTIONS()
    as (
      

SELECT
    customer_id,
    COUNT(DISTINCT order_id) AS total_orders,
    MIN(order_date) AS first_order_date,
    MAX(order_date) AS last_order_date,
    SUM(total_amount_eur) AS lifetime_value
FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`
GROUP BY customer_id
    );
  
[0m02:07:02.374389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:02.925328 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:f4b8c04e-a73f-4624-9ab9-b9035159bfe7&page=queryresults
[0m02:07:03.131714 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:f4b8c04e-a73f-4624-9ab9-b9035159bfe7&page=queryresults
[0m02:07:03.144624 [debug] [Thread-1 (]: Database Error in model dim_customers (models/facts_tables/dim_customers.sql)
  Unrecognized name: customer_id at [16:5]
  compiled code at target/run/intermate_dbt/models/facts_tables/dim_customers.sql
[0m02:07:03.145652 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70631d8c-8913-4b87-a432-cbb7c5ee8054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147bde320>]}
[0m02:07:03.146763 [error] [Thread-1 (]: 4 of 6 ERROR creating sql table model order_ad_data.dim_customers .............. [[31mERROR[0m in 0.79s]
[0m02:07:03.147669 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m02:07:03.148270 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m02:07:03.149023 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models/facts_tables/dim_customers.sql)
  Unrecognized name: customer_id at [16:5]
  compiled code at target/run/intermate_dbt/models/facts_tables/dim_customers.sql.
[0m02:07:03.150001 [info ] [Thread-1 (]: 5 of 6 START sql table model order_ad_data.fact_combined_performance ........... [RUN]
[0m02:07:03.151567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.dim_customers, now model.intermate_dbt.fact_combined_performance)
[0m02:07:03.152086 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_combined_performance
[0m02:07:03.156805 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_combined_performance"
[0m02:07:03.157989 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_combined_performance
[0m02:07:03.162996 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_combined_performance"
[0m02:07:03.164028 [debug] [Thread-1 (]: On model.intermate_dbt.fact_combined_performance: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_combined_performance"} */

  
    

    create or replace table `atomic-sled-453015-g3`.`order_ad_data`.`fact_combined_performance`
      
    
    

    OPTIONS()
    as (
      

SELECT
    s.order_date,
    COUNT(DISTINCT s.order_id) AS total_orders,
    SUM(s.total_amount_eur) AS total_revenue,
    f.impressions,
    f.clicks,
    f.ad_spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders` s
LEFT JOIN `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads` f
ON s.order_date = f.ad_date
GROUP BY s.order_date, f.impressions, f.clicks, f.ad_spend_eur
ORDER BY s.order_date DESC
    );
  
[0m02:07:03.164514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:03.770575 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:b477d8db-6d0c-459b-a83e-dceb67a616bc&page=queryresults
[0m02:07:04.035749 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:b477d8db-6d0c-459b-a83e-dceb67a616bc&page=queryresults
[0m02:07:04.040058 [debug] [Thread-1 (]: Database Error in model fact_combined_performance (models/facts_tables/fact_combined_performance.sql)
  Name order_id not found inside s at [17:22]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_combined_performance.sql
[0m02:07:04.041467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70631d8c-8913-4b87-a432-cbb7c5ee8054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147c6a6b0>]}
[0m02:07:04.043163 [error] [Thread-1 (]: 5 of 6 ERROR creating sql table model order_ad_data.fact_combined_performance .. [[31mERROR[0m in 0.89s]
[0m02:07:04.044562 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m02:07:04.045255 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m02:07:04.046045 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_combined_performance' to be skipped because of status 'error'.  Reason: Database Error in model fact_combined_performance (models/facts_tables/fact_combined_performance.sql)
  Name order_id not found inside s at [17:22]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_combined_performance.sql.
[0m02:07:04.046931 [info ] [Thread-1 (]: 6 of 6 START sql table model order_ad_data.fact_discount_performance ........... [RUN]
[0m02:07:04.047900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_combined_performance, now model.intermate_dbt.fact_discount_performance)
[0m02:07:04.048630 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_discount_performance
[0m02:07:04.054079 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_discount_performance"
[0m02:07:04.055194 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_discount_performance
[0m02:07:04.059151 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_discount_performance"
[0m02:07:04.060185 [debug] [Thread-1 (]: On model.intermate_dbt.fact_discount_performance: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_discount_performance"} */

  
    

    create or replace table `atomic-sled-453015-g3`.`order_ad_data`.`fact_discount_performance`
      
    
    

    OPTIONS()
    as (
      

SELECT
    discount_code,
    COUNT(DISTINCT order_id) AS total_orders,
    SUM(total_amount_eur) AS total_revenue
FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_new_customer_orders`
WHERE discount_code IS NOT NULL
GROUP BY discount_code
ORDER BY total_revenue DESC
    );
  
[0m02:07:04.060750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:04.600406 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:7c2adcd6-11c7-40d9-8f05-aa387626baa9&page=queryresults
[0m02:07:04.827325 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:7c2adcd6-11c7-40d9-8f05-aa387626baa9&page=queryresults
[0m02:07:04.830197 [debug] [Thread-1 (]: Database Error in model fact_discount_performance (models/facts_tables/fact_discount_performance.sql)
  Unrecognized name: discount_code at [20:7]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_discount_performance.sql
[0m02:07:04.831084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70631d8c-8913-4b87-a432-cbb7c5ee8054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147a72980>]}
[0m02:07:04.832355 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model order_ad_data.fact_discount_performance .. [[31mERROR[0m in 0.78s]
[0m02:07:04.833176 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m02:07:04.833838 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_discount_performance' to be skipped because of status 'error'.  Reason: Database Error in model fact_discount_performance (models/facts_tables/fact_discount_performance.sql)
  Unrecognized name: discount_code at [20:7]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_discount_performance.sql.
[0m02:07:04.835202 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:07:04.836223 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:07:04.836732 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_discount_performance' was properly closed.
[0m02:07:04.837406 [info ] [MainThread]: 
[0m02:07:04.837924 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 9.57 seconds (9.57s).
[0m02:07:04.839954 [debug] [MainThread]: Command end result
[0m02:07:04.924549 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m02:07:04.925860 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m02:07:04.929504 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m02:07:04.929695 [info ] [MainThread]: 
[0m02:07:04.929902 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m02:07:04.930070 [info ] [MainThread]: 
[0m02:07:04.930267 [error] [MainThread]:   Database Error in model dim_customers (models/facts_tables/dim_customers.sql)
  Unrecognized name: customer_id at [16:5]
  compiled code at target/run/intermate_dbt/models/facts_tables/dim_customers.sql
[0m02:07:04.930428 [info ] [MainThread]: 
[0m02:07:04.930610 [error] [MainThread]:   Database Error in model fact_combined_performance (models/facts_tables/fact_combined_performance.sql)
  Name order_id not found inside s at [17:22]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_combined_performance.sql
[0m02:07:04.930762 [info ] [MainThread]: 
[0m02:07:04.930944 [error] [MainThread]:   Database Error in model fact_discount_performance (models/facts_tables/fact_discount_performance.sql)
  Unrecognized name: discount_code at [20:7]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_discount_performance.sql
[0m02:07:04.931099 [info ] [MainThread]: 
[0m02:07:04.931262 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=0 TOTAL=6
[0m02:07:04.933432 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.09801, "process_in_blocks": "0", "process_kernel_time": 1.04662, "process_mem_max_rss": "219971584", "process_out_blocks": "0", "process_user_time": 2.982953}
[0m02:07:04.933696 [debug] [MainThread]: Command `dbt run` failed at 02:07:04.933649 after 11.10 seconds
[0m02:07:04.933976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c80940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14752f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147bbab90>]}
[0m02:07:04.934203 [debug] [MainThread]: Flushing usage events
[0m02:07:05.657841 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:08:06.440707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105788970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065d9e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065d9750>]}


============================== 02:08:06.444650 | 1fb2827e-519d-4c47-a266-0e3dcc5f5f9c ==============================
[0m02:08:06.444650 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:08:06.445012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:08:07.420582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fb2827e-519d-4c47-a266-0e3dcc5f5f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127f08640>]}
[0m02:08:07.448528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fb2827e-519d-4c47-a266-0e3dcc5f5f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a07f0>]}
[0m02:08:07.448959 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m02:08:07.558342 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:08:07.634286 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m02:08:07.634660 [debug] [MainThread]: Partial parsing: added file: intermate_dbt://models/facts_tables/fact_daily_new_customer_orders.sql
[0m02:08:07.634926 [debug] [MainThread]: Partial parsing: deleted file: intermate_dbt://models/facts_tables/fact_new_customer_orders.sql
[0m02:08:07.738554 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.intermate_dbt.dim_customers' (models/facts_tables/dim_customers.sql) depends on a node named 'fact_new_customer_orders' which was not found
[0m02:08:07.740547 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3429499, "process_in_blocks": "0", "process_kernel_time": 0.950739, "process_mem_max_rss": "201719808", "process_out_blocks": "0", "process_user_time": 2.437484}
[0m02:08:07.740814 [debug] [MainThread]: Command `dbt run` failed at 02:08:07.740762 after 1.34 seconds
[0m02:08:07.741035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105788970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d550430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d794520>]}
[0m02:08:07.741240 [debug] [MainThread]: Flushing usage events
[0m02:08:08.172128 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:08:48.905174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104230910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a95e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a95780>]}


============================== 02:08:48.909343 | 76ddcfb7-f1dd-49dc-83ec-f5307acca8ad ==============================
[0m02:08:48.909343 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:08:48.909680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:08:49.715698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76ddcfb7-f1dd-49dc-83ec-f5307acca8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e61990>]}
[0m02:08:49.743722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76ddcfb7-f1dd-49dc-83ec-f5307acca8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1424b1120>]}
[0m02:08:49.744108 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m02:08:49.853600 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:08:49.924467 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 3 files changed.
[0m02:08:49.924811 [debug] [MainThread]: Partial parsing: added file: intermate_dbt://models/facts_tables/fact_daily_new_customer_orders.sql
[0m02:08:49.925070 [debug] [MainThread]: Partial parsing: deleted file: intermate_dbt://models/facts_tables/fact_new_customer_orders.sql
[0m02:08:49.925249 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/dim_customers.sql
[0m02:08:49.925411 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_combined_performance.sql
[0m02:08:49.925572 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_discount_performance.sql
[0m02:08:50.054016 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.staging
- models.intermatedbt.marts
- models.intermatedbt.fact_tables
[0m02:08:50.062012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76ddcfb7-f1dd-49dc-83ec-f5307acca8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142cf57b0>]}
[0m02:08:50.103578 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m02:08:50.104833 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m02:08:50.115502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76ddcfb7-f1dd-49dc-83ec-f5307acca8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142e2b0a0>]}
[0m02:08:50.115794 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m02:08:50.115982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76ddcfb7-f1dd-49dc-83ec-f5307acca8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142e2b460>]}
[0m02:08:50.116906 [info ] [MainThread]: 
[0m02:08:50.117102 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:08:50.117257 [info ] [MainThread]: 
[0m02:08:50.117522 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:08:50.119845 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m02:08:50.120064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:08:50.691020 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m02:08:50.692234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:08:51.108742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76ddcfb7-f1dd-49dc-83ec-f5307acca8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a68670>]}
[0m02:08:51.110482 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:08:51.116182 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m02:08:51.117391 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m02:08:51.118207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m02:08:51.118795 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m02:08:51.131709 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m02:08:51.132802 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m02:08:51.162677 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m02:08:51.163652 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m02:08:51.164030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:08:51.729740 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:88e9e2d6-cc99-4bf3-9e21-2ca1cdb948d1&page=queryresults
[0m02:08:52.281260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76ddcfb7-f1dd-49dc-83ec-f5307acca8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1424b1d20>]}
[0m02:08:52.281735 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m02:08:52.282100 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m02:08:52.282336 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m02:08:52.282636 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m02:08:52.282881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m02:08:52.283082 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m02:08:52.285009 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m02:08:52.285449 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m02:08:52.287091 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m02:08:52.287448 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m02:08:52.287661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:08:52.815187 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:a6ead955-7de5-45ee-9095-4d13ca22566a&page=queryresults
[0m02:08:53.793113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76ddcfb7-f1dd-49dc-83ec-f5307acca8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1425ad300>]}
[0m02:08:53.794928 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.51s]
[0m02:08:53.796251 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m02:08:53.797467 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_daily_new_customer_orders
[0m02:08:53.798366 [info ] [Thread-1 (]: 3 of 6 START sql incremental model order_ad_data.fact_daily_new_customer_orders  [RUN]
[0m02:08:53.799071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_daily_new_customer_orders)
[0m02:08:53.799625 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_daily_new_customer_orders
[0m02:08:53.805845 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_daily_new_customer_orders"
[0m02:08:53.807212 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_daily_new_customer_orders
[0m02:08:53.843757 [debug] [Thread-1 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m02:08:53.860928 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_daily_new_customer_orders"
[0m02:08:53.861711 [debug] [Thread-1 (]: On model.intermate_dbt.fact_daily_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_daily_new_customer_orders"} */

  
    

    create or replace table `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders`
      
    
    

    OPTIONS()
    as (
      

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
),

first_orders AS (
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
)

SELECT
    s.order_date,
    COUNT(DISTINCT s.customer_id) AS new_customers_count,
    ROUND(SUM(s.total_price_eur), 2) AS total_revenue_eur  -- Round to 2 decimal places
FROM stg_shopify s
JOIN first_orders f
    ON s.customer_id = f.customer_id
    AND s.order_date = f.first_order_date
WHERE s.status NOT IN ('canceled')  -- Ensure valid orders

GROUP BY s.order_date
ORDER BY s.order_date
    );
  
[0m02:08:53.862049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:08:54.468834 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:6145a66a-eeb9-428b-9020-cd63e2be9bbc&page=queryresults
[0m02:08:57.567536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76ddcfb7-f1dd-49dc-83ec-f5307acca8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142a1e0b0>]}
[0m02:08:57.569846 [info ] [Thread-1 (]: 3 of 6 OK created sql incremental model order_ad_data.fact_daily_new_customer_orders  [[32mCREATE TABLE (51.0 rows, 17.5 KiB processed)[0m in 3.77s]
[0m02:08:57.571221 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_daily_new_customer_orders
[0m02:08:57.572600 [debug] [Thread-1 (]: Began running node model.intermate_dbt.dim_customers
[0m02:08:57.573616 [info ] [Thread-1 (]: 4 of 6 START sql table model order_ad_data.dim_customers ....................... [RUN]
[0m02:08:57.574426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_daily_new_customer_orders, now model.intermate_dbt.dim_customers)
[0m02:08:57.575023 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.dim_customers
[0m02:08:57.580265 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.dim_customers"
[0m02:08:57.581559 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.dim_customers
[0m02:08:57.595757 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.dim_customers"
[0m02:08:57.596802 [debug] [Thread-1 (]: On model.intermate_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.dim_customers"} */

  
    

    create or replace table `atomic-sled-453015-g3`.`order_ad_data`.`dim_customers`
      
    
    

    OPTIONS()
    as (
      

SELECT
    customer_id,
    COUNT(DISTINCT order_id) AS total_orders,
    MIN(order_date) AS first_order_date,
    MAX(order_date) AS last_order_date,
    SUM(total_amount_eur) AS lifetime_value
FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders`
GROUP BY customer_id
    );
  
[0m02:08:57.597292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:08:58.365695 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:9888c1d8-ba8e-4c51-bba9-a148c2a2d48d&page=queryresults
[0m02:08:58.673782 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:9888c1d8-ba8e-4c51-bba9-a148c2a2d48d&page=queryresults
[0m02:08:58.685051 [debug] [Thread-1 (]: Database Error in model dim_customers (models/facts_tables/dim_customers.sql)
  Unrecognized name: customer_id at [16:5]
  compiled code at target/run/intermate_dbt/models/facts_tables/dim_customers.sql
[0m02:08:58.686021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76ddcfb7-f1dd-49dc-83ec-f5307acca8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1472c8c40>]}
[0m02:08:58.687026 [error] [Thread-1 (]: 4 of 6 ERROR creating sql table model order_ad_data.dim_customers .............. [[31mERROR[0m in 1.11s]
[0m02:08:58.687876 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.dim_customers
[0m02:08:58.688460 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m02:08:58.689234 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models/facts_tables/dim_customers.sql)
  Unrecognized name: customer_id at [16:5]
  compiled code at target/run/intermate_dbt/models/facts_tables/dim_customers.sql.
[0m02:08:58.690060 [info ] [Thread-1 (]: 5 of 6 START sql table model order_ad_data.fact_combined_performance ........... [RUN]
[0m02:08:58.692090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.dim_customers, now model.intermate_dbt.fact_combined_performance)
[0m02:08:58.692575 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_combined_performance
[0m02:08:58.697034 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_combined_performance"
[0m02:08:58.698057 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_combined_performance
[0m02:08:58.703107 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_combined_performance"
[0m02:08:58.704024 [debug] [Thread-1 (]: On model.intermate_dbt.fact_combined_performance: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_combined_performance"} */

  
    

    create or replace table `atomic-sled-453015-g3`.`order_ad_data`.`fact_combined_performance`
      
    
    

    OPTIONS()
    as (
      

SELECT
    s.order_date,
    COUNT(DISTINCT s.order_id) AS total_orders,
    SUM(s.total_amount_eur) AS total_revenue,
    f.impressions,
    f.clicks,
    f.ad_spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders` s
LEFT JOIN `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads` f
ON s.order_date = f.ad_date
GROUP BY s.order_date, f.impressions, f.clicks, f.ad_spend_eur
ORDER BY s.order_date DESC
    );
  
[0m02:08:58.704616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:08:59.489408 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:979ed098-f6b6-4886-9079-6b34038c82d2&page=queryresults
[0m02:08:59.710034 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:979ed098-f6b6-4886-9079-6b34038c82d2&page=queryresults
[0m02:08:59.713394 [debug] [Thread-1 (]: Database Error in model fact_combined_performance (models/facts_tables/fact_combined_performance.sql)
  Name order_id not found inside s at [17:22]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_combined_performance.sql
[0m02:08:59.714217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76ddcfb7-f1dd-49dc-83ec-f5307acca8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147361030>]}
[0m02:08:59.715198 [error] [Thread-1 (]: 5 of 6 ERROR creating sql table model order_ad_data.fact_combined_performance .. [[31mERROR[0m in 1.02s]
[0m02:08:59.716038 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m02:08:59.716644 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_discount_performance
[0m02:08:59.717376 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_combined_performance' to be skipped because of status 'error'.  Reason: Database Error in model fact_combined_performance (models/facts_tables/fact_combined_performance.sql)
  Name order_id not found inside s at [17:22]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_combined_performance.sql.
[0m02:08:59.718158 [info ] [Thread-1 (]: 6 of 6 START sql table model order_ad_data.fact_discount_performance ........... [RUN]
[0m02:08:59.719222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_combined_performance, now model.intermate_dbt.fact_discount_performance)
[0m02:08:59.719830 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_discount_performance
[0m02:08:59.724972 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_discount_performance"
[0m02:08:59.726045 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_discount_performance
[0m02:08:59.729786 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_discount_performance"
[0m02:08:59.730730 [debug] [Thread-1 (]: On model.intermate_dbt.fact_discount_performance: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_discount_performance"} */

  
    

    create or replace table `atomic-sled-453015-g3`.`order_ad_data`.`fact_discount_performance`
      
    
    

    OPTIONS()
    as (
      

SELECT
    discount_code,
    COUNT(DISTINCT order_id) AS total_orders,
    SUM(total_amount_eur) AS total_revenue
FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders`
WHERE discount_code IS NOT NULL
GROUP BY discount_code
ORDER BY total_revenue DESC
    );
  
[0m02:08:59.731276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:00.323748 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:6f42ffb6-5765-419f-8f28-0f94666f5c94&page=queryresults
[0m02:09:00.554631 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:6f42ffb6-5765-419f-8f28-0f94666f5c94&page=queryresults
[0m02:09:00.557621 [debug] [Thread-1 (]: Database Error in model fact_discount_performance (models/facts_tables/fact_discount_performance.sql)
  Unrecognized name: discount_code at [20:7]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_discount_performance.sql
[0m02:09:00.558433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76ddcfb7-f1dd-49dc-83ec-f5307acca8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14718b4f0>]}
[0m02:09:00.559431 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model order_ad_data.fact_discount_performance .. [[31mERROR[0m in 0.84s]
[0m02:09:00.560521 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_discount_performance
[0m02:09:00.561505 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_discount_performance' to be skipped because of status 'error'.  Reason: Database Error in model fact_discount_performance (models/facts_tables/fact_discount_performance.sql)
  Unrecognized name: discount_code at [20:7]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_discount_performance.sql.
[0m02:09:00.563016 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:09:00.563878 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:09:00.564331 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_discount_performance' was properly closed.
[0m02:09:00.564931 [info ] [MainThread]: 
[0m02:09:00.565472 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 2 view models in 0 hours 0 minutes and 10.45 seconds (10.45s).
[0m02:09:00.567403 [debug] [MainThread]: Command end result
[0m02:09:00.651047 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m02:09:00.652340 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m02:09:00.656164 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m02:09:00.656394 [info ] [MainThread]: 
[0m02:09:00.656607 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m02:09:00.656786 [info ] [MainThread]: 
[0m02:09:00.656986 [error] [MainThread]:   Database Error in model dim_customers (models/facts_tables/dim_customers.sql)
  Unrecognized name: customer_id at [16:5]
  compiled code at target/run/intermate_dbt/models/facts_tables/dim_customers.sql
[0m02:09:00.657147 [info ] [MainThread]: 
[0m02:09:00.657341 [error] [MainThread]:   Database Error in model fact_combined_performance (models/facts_tables/fact_combined_performance.sql)
  Name order_id not found inside s at [17:22]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_combined_performance.sql
[0m02:09:00.657495 [info ] [MainThread]: 
[0m02:09:00.657680 [error] [MainThread]:   Database Error in model fact_discount_performance (models/facts_tables/fact_discount_performance.sql)
  Unrecognized name: discount_code at [20:7]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_discount_performance.sql
[0m02:09:00.657848 [info ] [MainThread]: 
[0m02:09:00.658011 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=0 TOTAL=6
[0m02:09:00.660001 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.794389, "process_in_blocks": "0", "process_kernel_time": 1.186341, "process_mem_max_rss": "214499328", "process_out_blocks": "0", "process_user_time": 2.750494}
[0m02:09:00.660265 [debug] [MainThread]: Command `dbt run` failed at 02:09:00.660218 after 11.79 seconds
[0m02:09:00.660480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104230910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e61990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042e4a00>]}
[0m02:09:00.660685 [debug] [MainThread]: Flushing usage events
[0m02:09:01.267448 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:18:08.399562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a84880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b91f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b91840>]}


============================== 02:18:08.411216 | 0212f210-f087-45d2-bacf-5e6d2ccc0ed9 ==============================
[0m02:18:08.411216 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:18:08.411603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:18:09.346045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0212f210-f087-45d2-bacf-5e6d2ccc0ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146e42b60>]}
[0m02:18:09.377537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0212f210-f087-45d2-bacf-5e6d2ccc0ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d5d120>]}
[0m02:18:09.378128 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m02:18:09.488362 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:18:09.564552 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m02:18:09.564915 [debug] [MainThread]: Partial parsing: added file: intermate_dbt://models/facts_tables/fact_performance_discount_code.sql
[0m02:18:09.565105 [debug] [MainThread]: Partial parsing: added file: intermate_dbt://models/facts_tables/customer_dimension_table.sql
[0m02:18:09.565258 [debug] [MainThread]: Partial parsing: deleted file: intermate_dbt://models/facts_tables/fact_discount_performance.sql
[0m02:18:09.565425 [debug] [MainThread]: Partial parsing: deleted file: intermate_dbt://models/facts_tables/dim_customers.sql
[0m02:18:09.690029 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.fact_tables
- models.intermatedbt.staging
- models.intermatedbt.marts
[0m02:18:09.697761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0212f210-f087-45d2-bacf-5e6d2ccc0ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1474dd150>]}
[0m02:18:09.745335 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m02:18:09.747902 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m02:18:09.760952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0212f210-f087-45d2-bacf-5e6d2ccc0ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1474d2b00>]}
[0m02:18:09.761294 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m02:18:09.761481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0212f210-f087-45d2-bacf-5e6d2ccc0ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1474d1630>]}
[0m02:18:09.762474 [info ] [MainThread]: 
[0m02:18:09.762685 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:18:09.762844 [info ] [MainThread]: 
[0m02:18:09.763126 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:18:09.765546 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m02:18:09.765847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:10.310990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m02:18:10.312281 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:18:10.755049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0212f210-f087-45d2-bacf-5e6d2ccc0ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b68640>]}
[0m02:18:10.756533 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:18:10.762437 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m02:18:10.763418 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m02:18:10.764234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m02:18:10.764817 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m02:18:10.777792 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m02:18:10.779084 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m02:18:10.807344 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m02:18:10.808430 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m02:18:10.808847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:11.384619 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:77e3178a-7411-4e72-8825-4490e1ce93d1&page=queryresults
[0m02:18:11.934059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0212f210-f087-45d2-bacf-5e6d2ccc0ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146e82920>]}
[0m02:18:11.934571 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.17s]
[0m02:18:11.934959 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m02:18:11.935207 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m02:18:11.935525 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m02:18:11.935794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m02:18:11.936013 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m02:18:11.938079 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m02:18:11.938730 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m02:18:11.940524 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m02:18:11.941067 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m02:18:11.941309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:12.492401 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:5ff0e55c-d124-4820-81d6-13e9f7c7d9fc&page=queryresults
[0m02:18:13.009472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0212f210-f087-45d2-bacf-5e6d2ccc0ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146eaab60>]}
[0m02:18:13.011172 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m02:18:13.012690 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m02:18:13.014141 [debug] [Thread-1 (]: Began running node model.intermate_dbt.customer_dimension_table
[0m02:18:13.015166 [info ] [Thread-1 (]: 3 of 6 START sql view model order_ad_data.customer_dimension_table ............. [RUN]
[0m02:18:13.015903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.customer_dimension_table)
[0m02:18:13.016469 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.customer_dimension_table
[0m02:18:13.021444 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.customer_dimension_table"
[0m02:18:13.022739 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.customer_dimension_table
[0m02:18:13.026375 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.customer_dimension_table"
[0m02:18:13.027504 [debug] [Thread-1 (]: On model.intermate_dbt.customer_dimension_table: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.customer_dimension_table"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`customer_dimension_table`
  OPTIONS()
  as WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`  -- Reference to the Shopify staging table
),

first_orders AS (
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
),

customer_data AS (
    SELECT
        s.customer_id,
        f.first_order_date,
        COUNT(DISTINCT s.order_id) AS total_orders,
        ROUND(SUM(s.total_price_eur), 2) AS total_spend_eur,
        COUNT(DISTINCT s.discount_code) AS distinct_discounts_used
    FROM stg_shopify s
    JOIN first_orders f
        ON s.customer_id = f.customer_id
    WHERE s.status NOT IN ('canceled')  -- Only include valid orders
    GROUP BY s.customer_id, f.first_order_date
)

SELECT
    customer_id,
    first_order_date,
    total_orders,
    total_spend_eur,
    distinct_discounts_used
FROM customer_data
ORDER BY customer_id;


[0m02:18:13.028141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:13.618465 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:e359094f-e0f0-42dc-a5f2-c8eaf783f398&page=queryresults
[0m02:18:14.021867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0212f210-f087-45d2-bacf-5e6d2ccc0ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147d03fa0>]}
[0m02:18:14.023774 [info ] [Thread-1 (]: 3 of 6 OK created sql view model order_ad_data.customer_dimension_table ........ [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m02:18:14.025375 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.customer_dimension_table
[0m02:18:14.026061 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_daily_new_customer_orders
[0m02:18:14.026989 [info ] [Thread-1 (]: 4 of 6 START sql incremental model order_ad_data.fact_daily_new_customer_orders  [RUN]
[0m02:18:14.027812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.customer_dimension_table, now model.intermate_dbt.fact_daily_new_customer_orders)
[0m02:18:14.028465 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_daily_new_customer_orders
[0m02:18:14.043201 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_daily_new_customer_orders"
[0m02:18:14.044398 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_daily_new_customer_orders
[0m02:18:14.075534 [debug] [Thread-1 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m02:18:14.076117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:14.479551 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_daily_new_customer_orders"
[0m02:18:14.481502 [debug] [Thread-1 (]: On model.intermate_dbt.fact_daily_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_daily_new_customer_orders"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders` as DBT_INTERNAL_DEST
        using (

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
),

first_orders AS (
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
)

SELECT
    s.order_date,
    COUNT(DISTINCT s.customer_id) AS new_customers_count,
    ROUND(SUM(s.total_price_eur), 2) AS total_revenue_eur  -- Round to 2 decimal places
FROM stg_shopify s
JOIN first_orders f
    ON s.customer_id = f.customer_id
    AND s.order_date = f.first_order_date
WHERE s.status NOT IN ('canceled')  -- Ensure valid orders

    AND s.order_date > (SELECT MAX(order_date) FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders`)  -- Incremental logic

GROUP BY s.order_date
ORDER BY s.order_date
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`order_date`, `new_customers_count`, `total_revenue_eur`)
    values
        (`order_date`, `new_customers_count`, `total_revenue_eur`)


    
[0m02:18:15.567668 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:03ecce0b-9b0b-461c-94d3-cd505cfd6d2c&page=queryresults
[0m02:18:17.355864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0212f210-f087-45d2-bacf-5e6d2ccc0ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147d03fa0>]}
[0m02:18:17.357668 [info ] [Thread-1 (]: 4 of 6 OK created sql incremental model order_ad_data.fact_daily_new_customer_orders  [[32mMERGE (0.0 rows, 17.9 KiB processed)[0m in 3.33s]
[0m02:18:17.358959 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_daily_new_customer_orders
[0m02:18:17.360322 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m02:18:17.361192 [info ] [Thread-1 (]: 5 of 6 START sql table model order_ad_data.fact_combined_performance ........... [RUN]
[0m02:18:17.361944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_daily_new_customer_orders, now model.intermate_dbt.fact_combined_performance)
[0m02:18:17.362511 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_combined_performance
[0m02:18:17.368097 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_combined_performance"
[0m02:18:17.370252 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_combined_performance
[0m02:18:17.400482 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_combined_performance"
[0m02:18:17.401454 [debug] [Thread-1 (]: On model.intermate_dbt.fact_combined_performance: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_combined_performance"} */

  
    

    create or replace table `atomic-sled-453015-g3`.`order_ad_data`.`fact_combined_performance`
      
    
    

    OPTIONS()
    as (
      

SELECT
    s.order_date,
    COUNT(DISTINCT s.order_id) AS total_orders,
    SUM(s.total_amount_eur) AS total_revenue,
    f.impressions,
    f.clicks,
    f.ad_spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders` s
LEFT JOIN `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads` f
ON s.order_date = f.ad_date
GROUP BY s.order_date, f.impressions, f.clicks, f.ad_spend_eur
ORDER BY s.order_date DESC
    );
  
[0m02:18:17.401885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:18.228176 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:c7ec4733-c12e-4c51-9e7a-d906e49ef71c&page=queryresults
[0m02:18:18.446777 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:c7ec4733-c12e-4c51-9e7a-d906e49ef71c&page=queryresults
[0m02:18:18.457987 [debug] [Thread-1 (]: Database Error in model fact_combined_performance (models/facts_tables/fact_combined_performance.sql)
  Name order_id not found inside s at [17:22]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_combined_performance.sql
[0m02:18:18.459085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0212f210-f087-45d2-bacf-5e6d2ccc0ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147de3100>]}
[0m02:18:18.460104 [error] [Thread-1 (]: 5 of 6 ERROR creating sql table model order_ad_data.fact_combined_performance .. [[31mERROR[0m in 1.10s]
[0m02:18:18.460998 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m02:18:18.461598 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_performance_discount_code
[0m02:18:18.462354 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_combined_performance' to be skipped because of status 'error'.  Reason: Database Error in model fact_combined_performance (models/facts_tables/fact_combined_performance.sql)
  Name order_id not found inside s at [17:22]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_combined_performance.sql.
[0m02:18:18.463196 [info ] [Thread-1 (]: 6 of 6 START sql view model order_ad_data.fact_performance_discount_code ....... [RUN]
[0m02:18:18.465005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_combined_performance, now model.intermate_dbt.fact_performance_discount_code)
[0m02:18:18.465498 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_performance_discount_code
[0m02:18:18.471925 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_performance_discount_code"
[0m02:18:18.472963 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_performance_discount_code
[0m02:18:18.476449 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_performance_discount_code"
[0m02:18:18.477337 [debug] [Thread-1 (]: On model.intermate_dbt.fact_performance_discount_code: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_performance_discount_code"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`fact_performance_discount_code`
  OPTIONS()
  as WITH daily_new_customers AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders`  -- Reference the fact table for daily new customer orders
),

stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
),

first_orders AS (
    SELECT
        s.customer_id,
        MIN(s.order_date) AS first_order_date
    FROM stg_shopify s
    WHERE s.status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY s.customer_id
),

discount_performance AS (
    SELECT
        s.order_date,
        s.discount_code,
        COUNT(DISTINCT s.customer_id) AS new_customers_using_discount,
        ROUND(SUM(s.total_price_eur), 2) AS total_revenue_from_discount
    FROM stg_shopify s
    JOIN first_orders f
        ON s.customer_id = f.customer_id
        AND s.order_date = f.first_order_date
    WHERE s.status NOT IN ('canceled')  -- Only include valid first orders
    GROUP BY s.order_date, s.discount_code
)

SELECT
    d.order_date,
    d.discount_code,
    d.new_customers_using_discount,
    d.total_revenue_from_discount
FROM discount_performance d
JOIN daily_new_customers dc
    ON d.order_date = dc.order_date  -- Ensuring alignment with daily new customer orders fact table
ORDER BY d.order_date;;


[0m02:18:18.477858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:18.824823 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:427ed8fc-a76c-466f-9247-648910cee1b6&page=queryresults
[0m02:18:18.826549 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:427ed8fc-a76c-466f-9247-648910cee1b6&page=queryresults
[0m02:18:18.829941 [debug] [Thread-1 (]: Database Error in model fact_performance_discount_code (models/facts_tables/fact_performance_discount_code.sql)
  Syntax error: Unexpected ";" at [47:23]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_performance_discount_code.sql
[0m02:18:18.831061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0212f210-f087-45d2-bacf-5e6d2ccc0ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147dd1a50>]}
[0m02:18:18.832144 [error] [Thread-1 (]: 6 of 6 ERROR creating sql view model order_ad_data.fact_performance_discount_code  [[31mERROR[0m in 0.37s]
[0m02:18:18.833009 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_performance_discount_code
[0m02:18:18.833721 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_performance_discount_code' to be skipped because of status 'error'.  Reason: Database Error in model fact_performance_discount_code (models/facts_tables/fact_performance_discount_code.sql)
  Syntax error: Unexpected ";" at [47:23]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_performance_discount_code.sql.
[0m02:18:18.835066 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:18:18.835905 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:18:18.836356 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_performance_discount_code' was properly closed.
[0m02:18:18.836933 [info ] [MainThread]: 
[0m02:18:18.837421 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 4 view models in 0 hours 0 minutes and 9.07 seconds (9.07s).
[0m02:18:18.839385 [debug] [MainThread]: Command end result
[0m02:18:18.868547 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m02:18:18.870446 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m02:18:18.876456 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m02:18:18.876753 [info ] [MainThread]: 
[0m02:18:18.877068 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m02:18:18.877327 [info ] [MainThread]: 
[0m02:18:18.877700 [error] [MainThread]:   Database Error in model fact_combined_performance (models/facts_tables/fact_combined_performance.sql)
  Name order_id not found inside s at [17:22]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_combined_performance.sql
[0m02:18:18.878037 [info ] [MainThread]: 
[0m02:18:18.878357 [error] [MainThread]:   Database Error in model fact_performance_discount_code (models/facts_tables/fact_performance_discount_code.sql)
  Syntax error: Unexpected ";" at [47:23]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_performance_discount_code.sql
[0m02:18:18.878613 [info ] [MainThread]: 
[0m02:18:18.878878 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m02:18:18.882055 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.524229, "process_in_blocks": "0", "process_kernel_time": 1.166992, "process_mem_max_rss": "208568320", "process_out_blocks": "0", "process_user_time": 2.827282}
[0m02:18:18.882437 [debug] [MainThread]: Command `dbt run` failed at 02:18:18.882373 after 10.52 seconds
[0m02:18:18.882734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a84880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146e42b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b17e80>]}
[0m02:18:18.883020 [debug] [MainThread]: Flushing usage events
[0m02:18:19.515954 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:20:57.052628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106180970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a9e200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a9e8c0>]}


============================== 02:20:57.064191 | fbf7f161-6a12-4345-9637-7d7bed05059c ==============================
[0m02:20:57.064191 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:20:57.064586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m02:20:57.994827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbf7f161-6a12-4345-9637-7d7bed05059c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14560a9b0>]}
[0m02:20:58.023005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbf7f161-6a12-4345-9637-7d7bed05059c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a6afb0>]}
[0m02:20:58.023385 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m02:20:58.133241 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:20:58.213018 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:20:58.213408 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_combined_performance.sql
[0m02:20:58.304538 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.intermate_dbt.fact_combined_performance' (models/facts_tables/fact_combined_performance.sql) depends on a node named 'stg_facebook_campaign_data' which was not found
[0m02:20:58.306541 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2945874, "process_in_blocks": "0", "process_kernel_time": 0.944601, "process_mem_max_rss": "207503360", "process_out_blocks": "0", "process_user_time": 2.368841}
[0m02:20:58.306810 [debug] [MainThread]: Command `dbt run` failed at 02:20:58.306757 after 1.29 seconds
[0m02:20:58.307027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106180970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145c89660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145d9a1a0>]}
[0m02:20:58.307236 [debug] [MainThread]: Flushing usage events
[0m02:21:03.502061 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:21:22.350080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a5c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ade40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ad780>]}


============================== 02:21:22.354010 | b91c1b3f-f701-437a-baad-b4fd7c363894 ==============================
[0m02:21:22.354010 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:21:22.354351 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:21:23.159296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b91c1b3f-f701-437a-baad-b4fd7c363894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133a09600>]}
[0m02:21:23.187372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b91c1b3f-f701-437a-baad-b4fd7c363894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10633b760>]}
[0m02:21:23.187760 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m02:21:23.297494 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:21:23.369706 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:21:23.370102 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_combined_performance.sql
[0m02:21:23.492349 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.fact_tables
- models.intermatedbt.staging
- models.intermatedbt.marts
[0m02:21:23.499597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b91c1b3f-f701-437a-baad-b4fd7c363894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1341dd1b0>]}
[0m02:21:23.542517 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m02:21:23.543848 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m02:21:23.554816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b91c1b3f-f701-437a-baad-b4fd7c363894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1341ce8f0>]}
[0m02:21:23.555140 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m02:21:23.555324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b91c1b3f-f701-437a-baad-b4fd7c363894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1341ceb30>]}
[0m02:21:23.556249 [info ] [MainThread]: 
[0m02:21:23.556442 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:21:23.556597 [info ] [MainThread]: 
[0m02:21:23.556871 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:21:23.559205 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m02:21:23.559435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:21:24.073910 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m02:21:24.075351 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:21:24.552112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b91c1b3f-f701-437a-baad-b4fd7c363894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106880670>]}
[0m02:21:24.552698 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:21:24.556563 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m02:21:24.557073 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m02:21:24.557700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m02:21:24.558110 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m02:21:24.566761 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m02:21:24.567506 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m02:21:24.589214 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m02:21:24.590072 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m02:21:24.590368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:21:25.111131 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:537223e9-bd73-42b0-9bc7-3611942c8ce4&page=queryresults
[0m02:21:25.905485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b91c1b3f-f701-437a-baad-b4fd7c363894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ae860>]}
[0m02:21:25.906000 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.35s]
[0m02:21:25.906396 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m02:21:25.906648 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m02:21:25.907007 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m02:21:25.907330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m02:21:25.907568 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m02:21:25.909684 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m02:21:25.910376 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m02:21:25.912070 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m02:21:25.912745 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m02:21:25.912989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:21:26.388811 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:b83e81dd-83f0-4047-afd3-f01dac89af52&page=queryresults
[0m02:21:27.059808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b91c1b3f-f701-437a-baad-b4fd7c363894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134459120>]}
[0m02:21:27.061485 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m02:21:27.062650 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m02:21:27.063772 [debug] [Thread-1 (]: Began running node model.intermate_dbt.customer_dimension_table
[0m02:21:27.064615 [info ] [Thread-1 (]: 3 of 6 START sql view model order_ad_data.customer_dimension_table ............. [RUN]
[0m02:21:27.065392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.customer_dimension_table)
[0m02:21:27.065982 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.customer_dimension_table
[0m02:21:27.071299 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.customer_dimension_table"
[0m02:21:27.072696 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.customer_dimension_table
[0m02:21:27.076512 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.customer_dimension_table"
[0m02:21:27.077664 [debug] [Thread-1 (]: On model.intermate_dbt.customer_dimension_table: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.customer_dimension_table"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`customer_dimension_table`
  OPTIONS()
  as WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`  -- Reference to the Shopify staging table
),

first_orders AS (
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
),

customer_data AS (
    SELECT
        s.customer_id,
        f.first_order_date,
        COUNT(DISTINCT s.order_id) AS total_orders,
        ROUND(SUM(s.total_price_eur), 2) AS total_spend_eur,
        COUNT(DISTINCT s.discount_code) AS distinct_discounts_used
    FROM stg_shopify s
    JOIN first_orders f
        ON s.customer_id = f.customer_id
    WHERE s.status NOT IN ('canceled')  -- Only include valid orders
    GROUP BY s.customer_id, f.first_order_date
)

SELECT
    customer_id,
    first_order_date,
    total_orders,
    total_spend_eur,
    distinct_discounts_used
FROM customer_data
ORDER BY customer_id;


[0m02:21:27.078279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:21:27.670841 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:edecf933-df2f-4c7c-87b3-8f89c53434fb&page=queryresults
[0m02:21:28.187050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b91c1b3f-f701-437a-baad-b4fd7c363894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134782470>]}
[0m02:21:28.188259 [info ] [Thread-1 (]: 3 of 6 OK created sql view model order_ad_data.customer_dimension_table ........ [[32mCREATE VIEW (0 processed)[0m in 1.12s]
[0m02:21:28.189162 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.customer_dimension_table
[0m02:21:28.189779 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m02:21:28.190630 [info ] [Thread-1 (]: 4 of 6 START sql view model order_ad_data.fact_combined_performance ............ [RUN]
[0m02:21:28.191407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.customer_dimension_table, now model.intermate_dbt.fact_combined_performance)
[0m02:21:28.191978 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_combined_performance
[0m02:21:28.199182 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_combined_performance"
[0m02:21:28.201328 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_combined_performance
[0m02:21:28.205171 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_combined_performance"
[0m02:21:28.206430 [debug] [Thread-1 (]: On model.intermate_dbt.fact_combined_performance: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_combined_performance"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`fact_combined_performance`
  OPTIONS()
  as WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`  -- Reference the Shopify staging table
),

stg_facebook AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`  -- Reference the Facebook staging table
),

-- Aggregate Shopify data: Total revenue and total orders per day
shopify_aggregated AS (
    SELECT
        order_date,
        SUM(total_price_eur) AS total_revenue_eur,
        COUNT(DISTINCT customer_id) AS new_customers_count
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY order_date
),

-- Aggregate Facebook data: Impressions, clicks, and spend per campaign per day
facebook_aggregated AS (
    SELECT
        ad_date,
        campaign_id,
        SUM(impressions) AS total_impressions,
        SUM(clicks) AS total_clicks,
        ROUND(SUM(spend_eur), 2) AS total_spend_eur
    FROM stg_facebook
    GROUP BY ad_date, campaign_id
)

-- Combine Shopify and Facebook data
SELECT
    fa.ad_date AS date,
    fa.campaign_id,
    fa.total_impressions,
    fa.total_clicks,
    fa.total_spend_eur,
    sa.total_revenue_eur,
    sa.new_customers_count
FROM facebook_aggregated fa
LEFT JOIN shopify_aggregated sa
    ON fa.ad_date = sa.order_date  -- Match on the corresponding date (ad_date and order_date)
ORDER BY fa.ad_date, fa.campaign_id;


[0m02:21:28.207066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:21:28.797544 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:e2062e4a-a28e-4b45-9c90-383a55571a5b&page=queryresults
[0m02:21:29.265971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b91c1b3f-f701-437a-baad-b4fd7c363894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ae860>]}
[0m02:21:29.267999 [info ] [Thread-1 (]: 4 of 6 OK created sql view model order_ad_data.fact_combined_performance ....... [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m02:21:29.269367 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m02:21:29.270019 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_daily_new_customer_orders
[0m02:21:29.270852 [info ] [Thread-1 (]: 5 of 6 START sql incremental model order_ad_data.fact_daily_new_customer_orders  [RUN]
[0m02:21:29.271670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_combined_performance, now model.intermate_dbt.fact_daily_new_customer_orders)
[0m02:21:29.272250 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_daily_new_customer_orders
[0m02:21:29.285364 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_daily_new_customer_orders"
[0m02:21:29.287546 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_daily_new_customer_orders
[0m02:21:29.318837 [debug] [Thread-1 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m02:21:29.319412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:21:29.689612 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_daily_new_customer_orders"
[0m02:21:29.690849 [debug] [Thread-1 (]: On model.intermate_dbt.fact_daily_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_daily_new_customer_orders"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders` as DBT_INTERNAL_DEST
        using (

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
),

first_orders AS (
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
)

SELECT
    s.order_date,
    COUNT(DISTINCT s.customer_id) AS new_customers_count,
    ROUND(SUM(s.total_price_eur), 2) AS total_revenue_eur  -- Round to 2 decimal places
FROM stg_shopify s
JOIN first_orders f
    ON s.customer_id = f.customer_id
    AND s.order_date = f.first_order_date
WHERE s.status NOT IN ('canceled')  -- Ensure valid orders

    AND s.order_date > (SELECT MAX(order_date) FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders`)  -- Incremental logic

GROUP BY s.order_date
ORDER BY s.order_date
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`order_date`, `new_customers_count`, `total_revenue_eur`)
    values
        (`order_date`, `new_customers_count`, `total_revenue_eur`)


    
[0m02:21:30.331057 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:abf77d0f-8421-4c6e-b661-42d234f3f1f9&page=queryresults
[0m02:21:32.423327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b91c1b3f-f701-437a-baad-b4fd7c363894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1347814b0>]}
[0m02:21:32.425362 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model order_ad_data.fact_daily_new_customer_orders  [[32mMERGE (0.0 rows, 17.9 KiB processed)[0m in 3.15s]
[0m02:21:32.426803 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_daily_new_customer_orders
[0m02:21:32.427939 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_performance_discount_code
[0m02:21:32.428813 [info ] [Thread-1 (]: 6 of 6 START sql view model order_ad_data.fact_performance_discount_code ....... [RUN]
[0m02:21:32.429569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_daily_new_customer_orders, now model.intermate_dbt.fact_performance_discount_code)
[0m02:21:32.430123 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_performance_discount_code
[0m02:21:32.437454 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_performance_discount_code"
[0m02:21:32.439467 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_performance_discount_code
[0m02:21:32.443325 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_performance_discount_code"
[0m02:21:32.444445 [debug] [Thread-1 (]: On model.intermate_dbt.fact_performance_discount_code: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_performance_discount_code"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`fact_performance_discount_code`
  OPTIONS()
  as WITH daily_new_customers AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders`  -- Reference the fact table for daily new customer orders
),

stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
),

first_orders AS (
    SELECT
        s.customer_id,
        MIN(s.order_date) AS first_order_date
    FROM stg_shopify s
    WHERE s.status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY s.customer_id
),

discount_performance AS (
    SELECT
        s.order_date,
        s.discount_code,
        COUNT(DISTINCT s.customer_id) AS new_customers_using_discount,
        ROUND(SUM(s.total_price_eur), 2) AS total_revenue_from_discount
    FROM stg_shopify s
    JOIN first_orders f
        ON s.customer_id = f.customer_id
        AND s.order_date = f.first_order_date
    WHERE s.status NOT IN ('canceled')  -- Only include valid first orders
    GROUP BY s.order_date, s.discount_code
)

SELECT
    d.order_date,
    d.discount_code,
    d.new_customers_using_discount,
    d.total_revenue_from_discount
FROM discount_performance d
JOIN daily_new_customers dc
    ON d.order_date = dc.order_date  -- Ensuring alignment with daily new customer orders fact table
ORDER BY d.order_date;;


[0m02:21:32.445053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:21:32.789176 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:5094f846-b1de-4cb3-b05e-92dfa9e21f1b&page=queryresults
[0m02:21:32.790405 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:5094f846-b1de-4cb3-b05e-92dfa9e21f1b&page=queryresults
[0m02:21:32.800845 [debug] [Thread-1 (]: Database Error in model fact_performance_discount_code (models/facts_tables/fact_performance_discount_code.sql)
  Syntax error: Unexpected ";" at [47:23]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_performance_discount_code.sql
[0m02:21:32.801890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b91c1b3f-f701-437a-baad-b4fd7c363894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1344583d0>]}
[0m02:21:32.802791 [error] [Thread-1 (]: 6 of 6 ERROR creating sql view model order_ad_data.fact_performance_discount_code  [[31mERROR[0m in 0.37s]
[0m02:21:32.803675 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_performance_discount_code
[0m02:21:32.804356 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_performance_discount_code' to be skipped because of status 'error'.  Reason: Database Error in model fact_performance_discount_code (models/facts_tables/fact_performance_discount_code.sql)
  Syntax error: Unexpected ";" at [47:23]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_performance_discount_code.sql.
[0m02:21:32.806351 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:21:32.807164 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:21:32.807553 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_performance_discount_code' was properly closed.
[0m02:21:32.808032 [info ] [MainThread]: 
[0m02:21:32.808435 [info ] [MainThread]: Finished running 1 incremental model, 5 view models in 0 hours 0 minutes and 9.25 seconds (9.25s).
[0m02:21:32.810340 [debug] [MainThread]: Command end result
[0m02:21:32.836630 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m02:21:32.838273 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m02:21:32.843961 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m02:21:32.844262 [info ] [MainThread]: 
[0m02:21:32.844548 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:21:32.844782 [info ] [MainThread]: 
[0m02:21:32.845065 [error] [MainThread]:   Database Error in model fact_performance_discount_code (models/facts_tables/fact_performance_discount_code.sql)
  Syntax error: Unexpected ";" at [47:23]
  compiled code at target/run/intermate_dbt/models/facts_tables/fact_performance_discount_code.sql
[0m02:21:32.845290 [info ] [MainThread]: 
[0m02:21:32.845519 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m02:21:32.848202 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.537877, "process_in_blocks": "0", "process_kernel_time": 1.234024, "process_mem_max_rss": "214007808", "process_out_blocks": "0", "process_user_time": 2.681932}
[0m02:21:32.848585 [debug] [MainThread]: Command `dbt run` failed at 02:21:32.848518 after 10.54 seconds
[0m02:21:32.848905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a5c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133a09600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133b078e0>]}
[0m02:21:32.849188 [debug] [MainThread]: Flushing usage events
[0m02:21:33.377962 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:22:07.364081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dd4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c25e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c25780>]}


============================== 02:22:07.376055 | 71fc16fd-7225-43f2-990e-7c79968759e3 ==============================
[0m02:22:07.376055 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:22:07.376446 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:22:08.296647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71fc16fd-7225-43f2-990e-7c79968759e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1376082b0>]}
[0m02:22:08.325259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71fc16fd-7225-43f2-990e-7c79968759e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086b2950>]}
[0m02:22:08.325652 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m02:22:08.433878 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:22:08.508017 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:22:08.508422 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_performance_discount_code.sql
[0m02:22:08.630065 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.staging
- models.intermatedbt.marts
- models.intermatedbt.fact_tables
[0m02:22:08.637618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71fc16fd-7225-43f2-990e-7c79968759e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137ee11e0>]}
[0m02:22:08.680094 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m02:22:08.681398 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m02:22:08.692586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71fc16fd-7225-43f2-990e-7c79968759e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137ed2ad0>]}
[0m02:22:08.692906 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m02:22:08.693130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71fc16fd-7225-43f2-990e-7c79968759e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137ed2d40>]}
[0m02:22:08.694250 [info ] [MainThread]: 
[0m02:22:08.694472 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:22:08.694641 [info ] [MainThread]: 
[0m02:22:08.694928 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:22:08.697382 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m02:22:08.697618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:22:09.169094 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m02:22:09.170624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:22:09.557497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71fc16fd-7225-43f2-990e-7c79968759e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107878be0>]}
[0m02:22:09.558687 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:22:09.563907 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m02:22:09.564910 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m02:22:09.565686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m02:22:09.566269 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m02:22:09.579413 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m02:22:09.580650 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m02:22:09.602285 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m02:22:09.602959 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m02:22:09.603247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:22:10.206424 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:9c6983fa-bc1c-44f4-9d00-f23efa27aed1&page=queryresults
[0m02:22:10.749241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71fc16fd-7225-43f2-990e-7c79968759e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1375a9900>]}
[0m02:22:10.749758 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m02:22:10.750371 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m02:22:10.750672 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m02:22:10.751012 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m02:22:10.751291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m02:22:10.751516 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m02:22:10.753561 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m02:22:10.754056 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m02:22:10.755768 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m02:22:10.756411 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m02:22:10.756687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:22:11.188550 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:f6c6d862-6953-4c8f-ab55-20dfbb243281&page=queryresults
[0m02:22:11.811746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71fc16fd-7225-43f2-990e-7c79968759e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e6b820>]}
[0m02:22:11.813647 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m02:22:11.814884 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m02:22:11.816060 [debug] [Thread-1 (]: Began running node model.intermate_dbt.customer_dimension_table
[0m02:22:11.816999 [info ] [Thread-1 (]: 3 of 6 START sql view model order_ad_data.customer_dimension_table ............. [RUN]
[0m02:22:11.817851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.customer_dimension_table)
[0m02:22:11.818448 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.customer_dimension_table
[0m02:22:11.823713 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.customer_dimension_table"
[0m02:22:11.824958 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.customer_dimension_table
[0m02:22:11.828652 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.customer_dimension_table"
[0m02:22:11.829628 [debug] [Thread-1 (]: On model.intermate_dbt.customer_dimension_table: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.customer_dimension_table"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`customer_dimension_table`
  OPTIONS()
  as WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`  -- Reference to the Shopify staging table
),

first_orders AS (
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
),

customer_data AS (
    SELECT
        s.customer_id,
        f.first_order_date,
        COUNT(DISTINCT s.order_id) AS total_orders,
        ROUND(SUM(s.total_price_eur), 2) AS total_spend_eur,
        COUNT(DISTINCT s.discount_code) AS distinct_discounts_used
    FROM stg_shopify s
    JOIN first_orders f
        ON s.customer_id = f.customer_id
    WHERE s.status NOT IN ('canceled')  -- Only include valid orders
    GROUP BY s.customer_id, f.first_order_date
)

SELECT
    customer_id,
    first_order_date,
    total_orders,
    total_spend_eur,
    distinct_discounts_used
FROM customer_data
ORDER BY customer_id;


[0m02:22:11.830258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:22:12.316817 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:27690722-7847-4701-93c7-83fce278f881&page=queryresults
[0m02:22:12.781897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71fc16fd-7225-43f2-990e-7c79968759e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158482680>]}
[0m02:22:12.783722 [info ] [Thread-1 (]: 3 of 6 OK created sql view model order_ad_data.customer_dimension_table ........ [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m02:22:12.784650 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.customer_dimension_table
[0m02:22:12.785275 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m02:22:12.786133 [info ] [Thread-1 (]: 4 of 6 START sql view model order_ad_data.fact_combined_performance ............ [RUN]
[0m02:22:12.786972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.customer_dimension_table, now model.intermate_dbt.fact_combined_performance)
[0m02:22:12.787556 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_combined_performance
[0m02:22:12.795478 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_combined_performance"
[0m02:22:12.797107 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_combined_performance
[0m02:22:12.801015 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_combined_performance"
[0m02:22:12.802121 [debug] [Thread-1 (]: On model.intermate_dbt.fact_combined_performance: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_combined_performance"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`fact_combined_performance`
  OPTIONS()
  as WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`  -- Reference the Shopify staging table
),

stg_facebook AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`  -- Reference the Facebook staging table
),

-- Aggregate Shopify data: Total revenue and total orders per day
shopify_aggregated AS (
    SELECT
        order_date,
        SUM(total_price_eur) AS total_revenue_eur,
        COUNT(DISTINCT customer_id) AS new_customers_count
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY order_date
),

-- Aggregate Facebook data: Impressions, clicks, and spend per campaign per day
facebook_aggregated AS (
    SELECT
        ad_date,
        campaign_id,
        SUM(impressions) AS total_impressions,
        SUM(clicks) AS total_clicks,
        ROUND(SUM(spend_eur), 2) AS total_spend_eur
    FROM stg_facebook
    GROUP BY ad_date, campaign_id
)

-- Combine Shopify and Facebook data
SELECT
    fa.ad_date AS date,
    fa.campaign_id,
    fa.total_impressions,
    fa.total_clicks,
    fa.total_spend_eur,
    sa.total_revenue_eur,
    sa.new_customers_count
FROM facebook_aggregated fa
LEFT JOIN shopify_aggregated sa
    ON fa.ad_date = sa.order_date  -- Match on the corresponding date (ad_date and order_date)
ORDER BY fa.ad_date, fa.campaign_id;


[0m02:22:12.802724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:22:13.548282 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:d8bdf863-1ea0-4f8e-9495-fdf3c509a7d9&page=queryresults
[0m02:22:13.991700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71fc16fd-7225-43f2-990e-7c79968759e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107878d00>]}
[0m02:22:13.992940 [info ] [Thread-1 (]: 4 of 6 OK created sql view model order_ad_data.fact_combined_performance ....... [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m02:22:13.993862 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m02:22:13.994503 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_daily_new_customer_orders
[0m02:22:13.995440 [info ] [Thread-1 (]: 5 of 6 START sql incremental model order_ad_data.fact_daily_new_customer_orders  [RUN]
[0m02:22:13.996219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_combined_performance, now model.intermate_dbt.fact_daily_new_customer_orders)
[0m02:22:13.996802 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_daily_new_customer_orders
[0m02:22:14.009918 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_daily_new_customer_orders"
[0m02:22:14.011605 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_daily_new_customer_orders
[0m02:22:14.043317 [debug] [Thread-1 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m02:22:14.043842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:22:14.432680 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_daily_new_customer_orders"
[0m02:22:14.433852 [debug] [Thread-1 (]: On model.intermate_dbt.fact_daily_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_daily_new_customer_orders"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders` as DBT_INTERNAL_DEST
        using (

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
),

first_orders AS (
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
)

SELECT
    s.order_date,
    COUNT(DISTINCT s.customer_id) AS new_customers_count,
    ROUND(SUM(s.total_price_eur), 2) AS total_revenue_eur  -- Round to 2 decimal places
FROM stg_shopify s
JOIN first_orders f
    ON s.customer_id = f.customer_id
    AND s.order_date = f.first_order_date
WHERE s.status NOT IN ('canceled')  -- Ensure valid orders

    AND s.order_date > (SELECT MAX(order_date) FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders`)  -- Incremental logic

GROUP BY s.order_date
ORDER BY s.order_date
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`order_date`, `new_customers_count`, `total_revenue_eur`)
    values
        (`order_date`, `new_customers_count`, `total_revenue_eur`)


    
[0m02:22:15.080955 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:6714b710-4d25-4be0-ba9c-44f840f720b7&page=queryresults
[0m02:22:17.144927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71fc16fd-7225-43f2-990e-7c79968759e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107878d00>]}
[0m02:22:17.146652 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model order_ad_data.fact_daily_new_customer_orders  [[32mMERGE (0.0 rows, 17.9 KiB processed)[0m in 3.15s]
[0m02:22:17.147831 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_daily_new_customer_orders
[0m02:22:17.148936 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_performance_discount_code
[0m02:22:17.149829 [info ] [Thread-1 (]: 6 of 6 START sql view model order_ad_data.fact_performance_discount_code ....... [RUN]
[0m02:22:17.150540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_daily_new_customer_orders, now model.intermate_dbt.fact_performance_discount_code)
[0m02:22:17.151097 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_performance_discount_code
[0m02:22:17.158413 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_performance_discount_code"
[0m02:22:17.160808 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_performance_discount_code
[0m02:22:17.164513 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_performance_discount_code"
[0m02:22:17.165861 [debug] [Thread-1 (]: On model.intermate_dbt.fact_performance_discount_code: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_performance_discount_code"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`fact_performance_discount_code`
  OPTIONS()
  as WITH daily_new_customers AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders`  -- Reference the fact table for daily new customer orders
),

stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
),

first_orders AS (
    SELECT
        s.customer_id,
        MIN(s.order_date) AS first_order_date
    FROM stg_shopify s
    WHERE s.status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY s.customer_id
),

discount_performance AS (
    SELECT
        s.order_date,
        s.discount_code,
        COUNT(DISTINCT s.customer_id) AS new_customers_using_discount,
        ROUND(SUM(s.total_price_eur), 2) AS total_revenue_from_discount
    FROM stg_shopify s
    JOIN first_orders f
        ON s.customer_id = f.customer_id
        AND s.order_date = f.first_order_date
    WHERE s.status NOT IN ('canceled')  -- Only include valid first orders
    GROUP BY s.order_date, s.discount_code
)

SELECT
    d.order_date,
    d.discount_code,
    d.new_customers_using_discount,
    d.total_revenue_from_discount
FROM discount_performance d
JOIN daily_new_customers dc
    ON d.order_date = dc.order_date  -- Ensuring alignment with daily new customer orders fact table
ORDER BY d.order_date;


[0m02:22:17.166486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:22:17.743446 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:71a6bdba-af7c-45d3-83cd-139b568de7dc&page=queryresults
[0m02:22:18.260784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71fc16fd-7225-43f2-990e-7c79968759e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15815ef80>]}
[0m02:22:18.262368 [info ] [Thread-1 (]: 6 of 6 OK created sql view model order_ad_data.fact_performance_discount_code .. [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m02:22:18.263299 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_performance_discount_code
[0m02:22:18.264800 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:22:18.265704 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:22:18.266169 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_performance_discount_code' was properly closed.
[0m02:22:18.266869 [info ] [MainThread]: 
[0m02:22:18.267553 [info ] [MainThread]: Finished running 1 incremental model, 5 view models in 0 hours 0 minutes and 9.57 seconds (9.57s).
[0m02:22:18.269607 [debug] [MainThread]: Command end result
[0m02:22:18.300162 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m02:22:18.302087 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m02:22:18.308412 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m02:22:18.308751 [info ] [MainThread]: 
[0m02:22:18.309092 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:22:18.309345 [info ] [MainThread]: 
[0m02:22:18.309612 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m02:22:18.312183 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.992812, "process_in_blocks": "0", "process_kernel_time": 1.167586, "process_mem_max_rss": "211779584", "process_out_blocks": "0", "process_user_time": 2.82231}
[0m02:22:18.312668 [debug] [MainThread]: Command `dbt run` succeeded at 02:22:18.312563 after 10.99 seconds
[0m02:22:18.313019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dd4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137ea8970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e4b940>]}
[0m02:22:18.313506 [debug] [MainThread]: Flushing usage events
[0m02:22:18.890806 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:25:59.533881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106028940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e79e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e79750>]}


============================== 02:25:59.544746 | 40166655-97e7-4ce1-a01a-cc85870bb459 ==============================
[0m02:25:59.544746 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:25:59.545147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'profiles_dir': '/Users/victoruwaje/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:26:00.447485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40166655-97e7-4ce1-a01a-cc85870bb459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c80a1a0>]}
[0m02:26:00.479636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40166655-97e7-4ce1-a01a-cc85870bb459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106caefb0>]}
[0m02:26:00.480115 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m02:26:00.592209 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:26:00.673267 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m02:26:00.673650 [debug] [MainThread]: Partial parsing: added file: intermate_dbt://models/facts_tables/fact_customer_dimension.sql
[0m02:26:00.673825 [debug] [MainThread]: Partial parsing: deleted file: intermate_dbt://models/facts_tables/customer_dimension_table.sql
[0m02:26:00.796547 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.staging
- models.intermatedbt.fact_tables
- models.intermatedbt.marts
[0m02:26:00.804205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40166655-97e7-4ce1-a01a-cc85870bb459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cee5150>]}
[0m02:26:00.849894 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m02:26:00.851089 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m02:26:00.862471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40166655-97e7-4ce1-a01a-cc85870bb459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ced6ce0>]}
[0m02:26:00.862782 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m02:26:00.862983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40166655-97e7-4ce1-a01a-cc85870bb459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ced6f80>]}
[0m02:26:00.864183 [info ] [MainThread]: 
[0m02:26:00.864387 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:26:00.864548 [info ] [MainThread]: 
[0m02:26:00.864821 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:26:00.867249 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m02:26:00.867490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:26:01.427028 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m02:26:01.428673 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:26:02.822571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40166655-97e7-4ce1-a01a-cc85870bb459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e4c6a0>]}
[0m02:26:02.824125 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:26:02.829045 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m02:26:02.830015 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m02:26:02.830777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m02:26:02.831357 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m02:26:02.845180 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m02:26:02.846504 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m02:26:02.875443 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m02:26:02.876404 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m02:26:02.876790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:26:03.349029 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:a4316965-f6b3-48eb-950d-f8de77645ce8&page=queryresults
[0m02:26:03.914687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40166655-97e7-4ce1-a01a-cc85870bb459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c7a9960>]}
[0m02:26:03.915188 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.08s]
[0m02:26:03.915573 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m02:26:03.915830 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m02:26:03.916151 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m02:26:03.916426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m02:26:03.916647 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m02:26:03.919243 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m02:26:03.919961 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m02:26:03.922137 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m02:26:03.922970 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m02:26:03.923215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:26:04.432362 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:23a564f1-4143-4608-9f6b-5371c4bb5037&page=queryresults
[0m02:26:04.922097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40166655-97e7-4ce1-a01a-cc85870bb459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cd66230>]}
[0m02:26:04.924420 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m02:26:04.925887 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m02:26:04.927408 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m02:26:04.928321 [info ] [Thread-1 (]: 3 of 6 START sql view model order_ad_data.fact_combined_performance ............ [RUN]
[0m02:26:04.929097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_combined_performance)
[0m02:26:04.929691 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_combined_performance
[0m02:26:04.935282 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_combined_performance"
[0m02:26:04.936819 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_combined_performance
[0m02:26:04.940403 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_combined_performance"
[0m02:26:04.941366 [debug] [Thread-1 (]: On model.intermate_dbt.fact_combined_performance: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_combined_performance"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`fact_combined_performance`
  OPTIONS()
  as WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`  -- Reference the Shopify staging table
),

stg_facebook AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`  -- Reference the Facebook staging table
),

-- Aggregate Shopify data: Total revenue and total orders per day
shopify_aggregated AS (
    SELECT
        order_date,
        SUM(total_price_eur) AS total_revenue_eur,
        COUNT(DISTINCT customer_id) AS new_customers_count
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY order_date
),

-- Aggregate Facebook data: Impressions, clicks, and spend per campaign per day
facebook_aggregated AS (
    SELECT
        ad_date,
        campaign_id,
        SUM(impressions) AS total_impressions,
        SUM(clicks) AS total_clicks,
        ROUND(SUM(spend_eur), 2) AS total_spend_eur
    FROM stg_facebook
    GROUP BY ad_date, campaign_id
)

-- Combine Shopify and Facebook data
SELECT
    fa.ad_date AS date,
    fa.campaign_id,
    fa.total_impressions,
    fa.total_clicks,
    fa.total_spend_eur,
    sa.total_revenue_eur,
    sa.new_customers_count
FROM facebook_aggregated fa
LEFT JOIN shopify_aggregated sa
    ON fa.ad_date = sa.order_date  -- Match on the corresponding date (ad_date and order_date)
ORDER BY fa.ad_date, fa.campaign_id;


[0m02:26:04.941975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:26:05.559735 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:a2e2130c-a3a9-43ef-9b54-3ce719c296a5&page=queryresults
[0m02:26:06.014679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40166655-97e7-4ce1-a01a-cc85870bb459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d5826b0>]}
[0m02:26:06.016610 [info ] [Thread-1 (]: 3 of 6 OK created sql view model order_ad_data.fact_combined_performance ....... [[32mCREATE VIEW (0 processed)[0m in 1.09s]
[0m02:26:06.018087 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m02:26:06.018771 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_customer_dimension
[0m02:26:06.019679 [info ] [Thread-1 (]: 4 of 6 START sql view model order_ad_data.fact_customer_dimension .............. [RUN]
[0m02:26:06.020538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_combined_performance, now model.intermate_dbt.fact_customer_dimension)
[0m02:26:06.021145 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_customer_dimension
[0m02:26:06.028302 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_customer_dimension"
[0m02:26:06.029647 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_customer_dimension
[0m02:26:06.033451 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_customer_dimension"
[0m02:26:06.034502 [debug] [Thread-1 (]: On model.intermate_dbt.fact_customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_customer_dimension"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`fact_customer_dimension`
  OPTIONS()
  as WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`  -- Reference to the Shopify staging table
),

first_orders AS (
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
),

customer_data AS (
    SELECT
        s.customer_id,
        f.first_order_date,
        COUNT(DISTINCT s.order_id) AS total_orders,
        ROUND(SUM(s.total_price_eur), 2) AS total_spend_eur,
        COUNT(DISTINCT s.discount_code) AS distinct_discounts_used
    FROM stg_shopify s
    JOIN first_orders f
        ON s.customer_id = f.customer_id
    WHERE s.status NOT IN ('canceled')  -- Only include valid orders
    GROUP BY s.customer_id, f.first_order_date
)

SELECT
    customer_id,
    first_order_date,
    total_orders,
    total_spend_eur,
    distinct_discounts_used
FROM customer_data
ORDER BY customer_id;


[0m02:26:06.035143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:26:06.674956 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:c4fee281-21ee-4284-b1a8-02c8e4fe75cb&page=queryresults
[0m02:26:07.225022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40166655-97e7-4ce1-a01a-cc85870bb459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e6b040>]}
[0m02:26:07.226623 [info ] [Thread-1 (]: 4 of 6 OK created sql view model order_ad_data.fact_customer_dimension ......... [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m02:26:07.227739 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_customer_dimension
[0m02:26:07.228722 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_daily_new_customer_orders
[0m02:26:07.229985 [info ] [Thread-1 (]: 5 of 6 START sql incremental model order_ad_data.fact_daily_new_customer_orders  [RUN]
[0m02:26:07.230853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_customer_dimension, now model.intermate_dbt.fact_daily_new_customer_orders)
[0m02:26:07.231406 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_daily_new_customer_orders
[0m02:26:07.243828 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_daily_new_customer_orders"
[0m02:26:07.245370 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_daily_new_customer_orders
[0m02:26:07.278215 [debug] [Thread-1 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m02:26:07.278799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:26:07.705551 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_daily_new_customer_orders"
[0m02:26:07.707719 [debug] [Thread-1 (]: On model.intermate_dbt.fact_daily_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_daily_new_customer_orders"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders` as DBT_INTERNAL_DEST
        using (

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
),

first_orders AS (
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
)

SELECT
    s.order_date,
    COUNT(DISTINCT s.customer_id) AS new_customers_count,
    ROUND(SUM(s.total_price_eur), 2) AS total_revenue_eur  -- Round to 2 decimal places
FROM stg_shopify s
JOIN first_orders f
    ON s.customer_id = f.customer_id
    AND s.order_date = f.first_order_date
WHERE s.status NOT IN ('canceled')  -- Ensure valid orders

    AND s.order_date > (SELECT MAX(order_date) FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders`)  -- Incremental logic

GROUP BY s.order_date
ORDER BY s.order_date
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`order_date`, `new_customers_count`, `total_revenue_eur`)
    values
        (`order_date`, `new_customers_count`, `total_revenue_eur`)


    
[0m02:26:08.357174 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:47fc4056-d535-41c9-954a-8d92647ba252&page=queryresults
[0m02:26:10.620875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40166655-97e7-4ce1-a01a-cc85870bb459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cd66230>]}
[0m02:26:10.621959 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model order_ad_data.fact_daily_new_customer_orders  [[32mMERGE (0.0 rows, 17.9 KiB processed)[0m in 3.39s]
[0m02:26:10.623020 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_daily_new_customer_orders
[0m02:26:10.624320 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_performance_discount_code
[0m02:26:10.625174 [info ] [Thread-1 (]: 6 of 6 START sql view model order_ad_data.fact_performance_discount_code ....... [RUN]
[0m02:26:10.626262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_daily_new_customer_orders, now model.intermate_dbt.fact_performance_discount_code)
[0m02:26:10.626914 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_performance_discount_code
[0m02:26:10.633901 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_performance_discount_code"
[0m02:26:10.635031 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_performance_discount_code
[0m02:26:10.638683 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_performance_discount_code"
[0m02:26:10.639677 [debug] [Thread-1 (]: On model.intermate_dbt.fact_performance_discount_code: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_performance_discount_code"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`fact_performance_discount_code`
  OPTIONS()
  as WITH daily_new_customers AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders`  -- Reference the fact table for daily new customer orders
),

stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
),

first_orders AS (
    SELECT
        s.customer_id,
        MIN(s.order_date) AS first_order_date
    FROM stg_shopify s
    WHERE s.status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY s.customer_id
),

discount_performance AS (
    SELECT
        s.order_date,
        s.discount_code,
        COUNT(DISTINCT s.customer_id) AS new_customers_using_discount,
        ROUND(SUM(s.total_price_eur), 2) AS total_revenue_from_discount
    FROM stg_shopify s
    JOIN first_orders f
        ON s.customer_id = f.customer_id
        AND s.order_date = f.first_order_date
    WHERE s.status NOT IN ('canceled')  -- Only include valid first orders
    GROUP BY s.order_date, s.discount_code
)

SELECT
    d.order_date,
    d.discount_code,
    d.new_customers_using_discount,
    d.total_revenue_from_discount
FROM discount_performance d
JOIN daily_new_customers dc
    ON d.order_date = dc.order_date  -- Ensuring alignment with daily new customer orders fact table
ORDER BY d.order_date;


[0m02:26:10.640311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:26:11.286947 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:bfa2486d-d9d2-4765-9d3d-4753144c391d&page=queryresults
[0m02:26:11.825754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40166655-97e7-4ce1-a01a-cc85870bb459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e6b040>]}
[0m02:26:11.826960 [info ] [Thread-1 (]: 6 of 6 OK created sql view model order_ad_data.fact_performance_discount_code .. [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m02:26:11.827861 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_performance_discount_code
[0m02:26:11.829247 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:26:11.830130 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:26:11.830605 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_performance_discount_code' was properly closed.
[0m02:26:11.831190 [info ] [MainThread]: 
[0m02:26:11.831709 [info ] [MainThread]: Finished running 1 incremental model, 5 view models in 0 hours 0 minutes and 10.97 seconds (10.97s).
[0m02:26:11.833371 [debug] [MainThread]: Command end result
[0m02:26:11.862414 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m02:26:11.864332 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m02:26:11.870572 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m02:26:11.870929 [info ] [MainThread]: 
[0m02:26:11.871284 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:26:11.871556 [info ] [MainThread]: 
[0m02:26:11.871832 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m02:26:11.874291 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.383055, "process_in_blocks": "0", "process_kernel_time": 0.880919, "process_mem_max_rss": "219152384", "process_out_blocks": "0", "process_user_time": 2.989305}
[0m02:26:11.874628 [debug] [MainThread]: Command `dbt run` succeeded at 02:26:11.874567 after 12.38 seconds
[0m02:26:11.874920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106028940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cea8280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c80a1a0>]}
[0m02:26:11.875202 [debug] [MainThread]: Flushing usage events
[0m02:26:12.456110 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:29:52.222844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d48e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f25ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f257e0>]}


============================== 02:29:52.234335 | fc7bfd3d-daf6-4409-9bfd-fd7c6cfb4aa4 ==============================
[0m02:29:52.234335 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:29:52.234686 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'profiles_dir': '/Users/victoruwaje/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:29:53.151177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc7bfd3d-daf6-4409-9bfd-fd7c6cfb4aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147b422f0>]}
[0m02:29:53.179774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc7bfd3d-daf6-4409-9bfd-fd7c6cfb4aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081758a0>]}
[0m02:29:53.180168 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m02:29:53.292187 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:29:53.368422 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m02:29:53.368804 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_performance_discount_code.sql
[0m02:29:53.369025 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_daily_new_customer_orders.sql
[0m02:29:53.498048 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.fact_tables
- models.intermatedbt.staging
- models.intermatedbt.marts
[0m02:29:53.506280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc7bfd3d-daf6-4409-9bfd-fd7c6cfb4aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b4fd150>]}
[0m02:29:53.549865 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m02:29:53.551076 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m02:29:53.561663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc7bfd3d-daf6-4409-9bfd-fd7c6cfb4aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b5e3190>]}
[0m02:29:53.561969 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m02:29:53.562154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc7bfd3d-daf6-4409-9bfd-fd7c6cfb4aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b5ed030>]}
[0m02:29:53.563085 [info ] [MainThread]: 
[0m02:29:53.563290 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:29:53.563446 [info ] [MainThread]: 
[0m02:29:53.563719 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:29:53.566113 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m02:29:53.566340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:29:54.075215 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m02:29:54.076496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:29:54.378064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc7bfd3d-daf6-4409-9bfd-fd7c6cfb4aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ef8670>]}
[0m02:29:54.379718 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:29:54.384445 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m02:29:54.385372 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m02:29:54.386109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m02:29:54.386697 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m02:29:54.400100 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m02:29:54.402632 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m02:29:54.432278 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m02:29:54.433889 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m02:29:54.434286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:54.960128 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:2a549514-1ca5-4845-b058-42ecd56449ab&page=queryresults
[0m02:29:55.756437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc7bfd3d-daf6-4409-9bfd-fd7c6cfb4aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147aa9f30>]}
[0m02:29:55.756980 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.37s]
[0m02:29:55.757362 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m02:29:55.757621 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m02:29:55.757964 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m02:29:55.758286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m02:29:55.758528 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m02:29:55.760654 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m02:29:55.761251 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m02:29:55.763043 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m02:29:55.763681 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m02:29:55.763949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:56.244397 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:d2f6a1b3-3cbf-49c4-a5eb-42b2c1e4ac21&page=queryresults
[0m02:29:56.725520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc7bfd3d-daf6-4409-9bfd-fd7c6cfb4aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b4b7400>]}
[0m02:29:56.727394 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 0.97s]
[0m02:29:56.728752 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m02:29:56.730070 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m02:29:56.730937 [info ] [Thread-1 (]: 3 of 6 START sql view model order_ad_data.fact_combined_performance ............ [RUN]
[0m02:29:56.731730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_combined_performance)
[0m02:29:56.732342 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_combined_performance
[0m02:29:56.738230 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_combined_performance"
[0m02:29:56.739628 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_combined_performance
[0m02:29:56.744840 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_combined_performance"
[0m02:29:56.746123 [debug] [Thread-1 (]: On model.intermate_dbt.fact_combined_performance: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_combined_performance"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`fact_combined_performance`
  OPTIONS()
  as WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`  -- Reference the Shopify staging table
),

stg_facebook AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`  -- Reference the Facebook staging table
),

-- Aggregate Shopify data: Total revenue and total orders per day
shopify_aggregated AS (
    SELECT
        order_date,
        SUM(total_price_eur) AS total_revenue_eur,
        COUNT(DISTINCT customer_id) AS new_customers_count
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY order_date
),

-- Aggregate Facebook data: Impressions, clicks, and spend per campaign per day
facebook_aggregated AS (
    SELECT
        ad_date,
        campaign_id,
        SUM(impressions) AS total_impressions,
        SUM(clicks) AS total_clicks,
        ROUND(SUM(spend_eur), 2) AS total_spend_eur
    FROM stg_facebook
    GROUP BY ad_date, campaign_id
)

-- Combine Shopify and Facebook data
SELECT
    fa.ad_date AS date,
    fa.campaign_id,
    fa.total_impressions,
    fa.total_clicks,
    fa.total_spend_eur,
    sa.total_revenue_eur,
    sa.new_customers_count
FROM facebook_aggregated fa
LEFT JOIN shopify_aggregated sa
    ON fa.ad_date = sa.order_date  -- Match on the corresponding date (ad_date and order_date)
ORDER BY fa.ad_date, fa.campaign_id;


[0m02:29:56.746753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:57.431869 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:63a2f609-c046-45b1-a839-f07c8fcd715a&page=queryresults
[0m02:29:58.035145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc7bfd3d-daf6-4409-9bfd-fd7c6cfb4aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15badac80>]}
[0m02:29:58.036821 [info ] [Thread-1 (]: 3 of 6 OK created sql view model order_ad_data.fact_combined_performance ....... [[32mCREATE VIEW (0 processed)[0m in 1.30s]
[0m02:29:58.038508 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m02:29:58.039273 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_customer_dimension
[0m02:29:58.040213 [info ] [Thread-1 (]: 4 of 6 START sql view model order_ad_data.fact_customer_dimension .............. [RUN]
[0m02:29:58.041006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_combined_performance, now model.intermate_dbt.fact_customer_dimension)
[0m02:29:58.041603 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_customer_dimension
[0m02:29:58.046889 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_customer_dimension"
[0m02:29:58.048079 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_customer_dimension
[0m02:29:58.051867 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_customer_dimension"
[0m02:29:58.052825 [debug] [Thread-1 (]: On model.intermate_dbt.fact_customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_customer_dimension"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`fact_customer_dimension`
  OPTIONS()
  as WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`  -- Reference to the Shopify staging table
),

first_orders AS (
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
),

customer_data AS (
    SELECT
        s.customer_id,
        f.first_order_date,
        COUNT(DISTINCT s.order_id) AS total_orders,
        ROUND(SUM(s.total_price_eur), 2) AS total_spend_eur,
        COUNT(DISTINCT s.discount_code) AS distinct_discounts_used
    FROM stg_shopify s
    JOIN first_orders f
        ON s.customer_id = f.customer_id
    WHERE s.status NOT IN ('canceled')  -- Only include valid orders
    GROUP BY s.customer_id, f.first_order_date
)

SELECT
    customer_id,
    first_order_date,
    total_orders,
    total_spend_eur,
    distinct_discounts_used
FROM customer_data
ORDER BY customer_id;


[0m02:29:58.053411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:58.661803 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:ec8f9925-4cb3-46f9-bcdf-c9769aa97323&page=queryresults
[0m02:29:59.189735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc7bfd3d-daf6-4409-9bfd-fd7c6cfb4aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15bada5c0>]}
[0m02:29:59.191830 [info ] [Thread-1 (]: 4 of 6 OK created sql view model order_ad_data.fact_customer_dimension ......... [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m02:29:59.193168 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_customer_dimension
[0m02:29:59.193832 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_daily_new_customer_orders
[0m02:29:59.194744 [info ] [Thread-1 (]: 5 of 6 START sql view model order_ad_data.fact_daily_new_customer_orders ....... [RUN]
[0m02:29:59.195586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_customer_dimension, now model.intermate_dbt.fact_daily_new_customer_orders)
[0m02:29:59.196195 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_daily_new_customer_orders
[0m02:29:59.202168 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_daily_new_customer_orders"
[0m02:29:59.203684 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_daily_new_customer_orders
[0m02:29:59.212867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:59.217715 [debug] [Thread-1 (]: Compilation Error in model fact_daily_new_customer_orders (models/facts_tables/fact_daily_new_customer_orders.sql)
  Trying to create view `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders`, but it currently exists as a table. Either drop `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/relations/view/replace.sql)
  > called by macro bigquery__create_or_replace_view (macros/relations/view/replace.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model fact_daily_new_customer_orders (models/facts_tables/fact_daily_new_customer_orders.sql)
[0m02:29:59.218364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc7bfd3d-daf6-4409-9bfd-fd7c6cfb4aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e8a830>]}
[0m02:29:59.219066 [error] [Thread-1 (]: 5 of 6 ERROR creating sql view model order_ad_data.fact_daily_new_customer_orders  [[31mERROR[0m in 0.02s]
[0m02:29:59.219740 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_daily_new_customer_orders
[0m02:29:59.220169 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_performance_discount_code
[0m02:29:59.220737 [debug] [Thread-4 (]: Marking all children of 'model.intermate_dbt.fact_daily_new_customer_orders' to be skipped because of status 'error'.  Reason: Compilation Error in model fact_daily_new_customer_orders (models/facts_tables/fact_daily_new_customer_orders.sql)
  Trying to create view `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders`, but it currently exists as a table. Either drop `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/relations/view/replace.sql)
  > called by macro bigquery__create_or_replace_view (macros/relations/view/replace.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model fact_daily_new_customer_orders (models/facts_tables/fact_daily_new_customer_orders.sql).
[0m02:29:59.221294 [info ] [Thread-1 (]: 6 of 6 START sql view model order_ad_data.fact_performance_discount_code ....... [RUN]
[0m02:29:59.222476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_daily_new_customer_orders, now model.intermate_dbt.fact_performance_discount_code)
[0m02:29:59.222865 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_performance_discount_code
[0m02:29:59.226334 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_performance_discount_code"
[0m02:29:59.227386 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_performance_discount_code
[0m02:29:59.231648 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_performance_discount_code"
[0m02:29:59.232442 [debug] [Thread-1 (]: On model.intermate_dbt.fact_performance_discount_code: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_performance_discount_code"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`fact_performance_discount_code`
  OPTIONS()
  as WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`  -- Reference to the Shopify staging table
),

first_orders AS (
    -- Identify the first order for each customer
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
),

discount_performance AS (
    -- Calculate performance metrics for each discount code
    SELECT
        s.order_date,
        s.discount_code,
        COUNT(DISTINCT s.customer_id) AS new_customers_using_discount,
        ROUND(SUM(s.total_price_eur), 2) AS total_revenue_from_discount
    FROM stg_shopify s
    JOIN first_orders f
        ON s.customer_id = f.customer_id
        AND s.order_date = f.first_order_date  -- Only consider the first order
    WHERE s.status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY s.order_date, s.discount_code
)

SELECT
    d.order_date,
    d.discount_code,
    d.new_customers_using_discount,
    d.total_revenue_from_discount
FROM discount_performance d
ORDER BY d.order_date, d.discount_code;


[0m02:29:59.232906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:59.733286 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:bdd308b2-0614-43f8-aa09-2586892c4a10&page=queryresults
[0m02:30:00.412948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc7bfd3d-daf6-4409-9bfd-fd7c6cfb4aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e8a830>]}
[0m02:30:00.414561 [info ] [Thread-1 (]: 6 of 6 OK created sql view model order_ad_data.fact_performance_discount_code .. [[32mCREATE VIEW (0 processed)[0m in 1.19s]
[0m02:30:00.415714 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_performance_discount_code
[0m02:30:00.417431 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:30:00.418457 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:30:00.418984 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_performance_discount_code' was properly closed.
[0m02:30:00.419622 [info ] [MainThread]: 
[0m02:30:00.420143 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 6.86 seconds (6.86s).
[0m02:30:00.422176 [debug] [MainThread]: Command end result
[0m02:30:00.452720 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m02:30:00.454657 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m02:30:00.460918 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m02:30:00.461225 [info ] [MainThread]: 
[0m02:30:00.461535 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:30:00.461806 [info ] [MainThread]: 
[0m02:30:00.462153 [error] [MainThread]:   Compilation Error in model fact_daily_new_customer_orders (models/facts_tables/fact_daily_new_customer_orders.sql)
  Trying to create view `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders`, but it currently exists as a table. Either drop `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/relations/view/replace.sql)
  > called by macro bigquery__create_or_replace_view (macros/relations/view/replace.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model fact_daily_new_customer_orders (models/facts_tables/fact_daily_new_customer_orders.sql)
[0m02:30:00.462446 [info ] [MainThread]: 
[0m02:30:00.462717 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m02:30:00.465115 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.286159, "process_in_blocks": "0", "process_kernel_time": 1.024961, "process_mem_max_rss": "220299264", "process_out_blocks": "0", "process_user_time": 2.845841}
[0m02:30:00.465494 [debug] [MainThread]: Command `dbt run` failed at 02:30:00.465428 after 8.29 seconds
[0m02:30:00.465822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d48e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081758a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b42c850>]}
[0m02:30:00.466131 [debug] [MainThread]: Flushing usage events
[0m02:30:01.033848 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:31:11.355555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10561c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10646de10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10646d750>]}


============================== 02:31:11.373028 | b5d5bfca-0669-46d5-848a-f2649640f1e0 ==============================
[0m02:31:11.373028 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:31:11.373381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'profiles_dir': '/Users/victoruwaje/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m02:31:12.275525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5d5bfca-0669-46d5-848a-f2649640f1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ad0a1a0>]}
[0m02:31:12.304894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5d5bfca-0669-46d5-848a-f2649640f1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062a2fb0>]}
[0m02:31:12.305415 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m02:31:12.416527 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:31:12.493375 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:31:12.494055 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_daily_new_customer_orders.sql
[0m02:31:12.621456 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.fact_tables
- models.intermatedbt.staging
- models.intermatedbt.marts
[0m02:31:12.629373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5d5bfca-0669-46d5-848a-f2649640f1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bad54b0>]}
[0m02:31:12.672753 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m02:31:12.674138 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m02:31:12.684901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5d5bfca-0669-46d5-848a-f2649640f1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bbeead0>]}
[0m02:31:12.685215 [info ] [MainThread]: Found 6 models, 2 sources, 491 macros
[0m02:31:12.685397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5d5bfca-0669-46d5-848a-f2649640f1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bbeed40>]}
[0m02:31:12.686298 [info ] [MainThread]: 
[0m02:31:12.686505 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:31:12.686662 [info ] [MainThread]: 
[0m02:31:12.686944 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:31:12.690646 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m02:31:12.690925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:31:13.317370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m02:31:13.318778 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:31:13.689650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5d5bfca-0669-46d5-848a-f2649640f1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064406a0>]}
[0m02:31:13.690789 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:31:13.694913 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m02:31:13.695845 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m02:31:13.696585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m02:31:13.697151 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m02:31:13.710301 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m02:31:13.711872 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m02:31:13.741358 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m02:31:13.742244 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m02:31:13.742606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:14.228470 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:418dd60d-46e4-4377-8949-01c6c52c7a99&page=queryresults
[0m02:31:14.808660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5d5bfca-0669-46d5-848a-f2649640f1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13aba9960>]}
[0m02:31:14.809176 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m02:31:14.809602 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m02:31:14.809861 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m02:31:14.810205 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m02:31:14.810476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m02:31:14.810698 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m02:31:14.812776 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m02:31:14.813395 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m02:31:14.815295 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m02:31:14.815803 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m02:31:14.816065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:15.348851 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:5c375ce2-fc72-4a37-8ff0-391c69a00184&page=queryresults
[0m02:31:15.860313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5d5bfca-0669-46d5-848a-f2649640f1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ba66b00>]}
[0m02:31:15.861901 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m02:31:15.863138 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m02:31:15.864559 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m02:31:15.865356 [info ] [Thread-1 (]: 3 of 6 START sql view model order_ad_data.fact_combined_performance ............ [RUN]
[0m02:31:15.866044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_combined_performance)
[0m02:31:15.866611 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_combined_performance
[0m02:31:15.872370 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_combined_performance"
[0m02:31:15.873920 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_combined_performance
[0m02:31:15.879299 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_combined_performance"
[0m02:31:15.880544 [debug] [Thread-1 (]: On model.intermate_dbt.fact_combined_performance: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_combined_performance"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`fact_combined_performance`
  OPTIONS()
  as WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`  -- Reference the Shopify staging table
),

stg_facebook AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`  -- Reference the Facebook staging table
),

-- Aggregate Shopify data: Total revenue and total orders per day
shopify_aggregated AS (
    SELECT
        order_date,
        SUM(total_price_eur) AS total_revenue_eur,
        COUNT(DISTINCT customer_id) AS new_customers_count
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY order_date
),

-- Aggregate Facebook data: Impressions, clicks, and spend per campaign per day
facebook_aggregated AS (
    SELECT
        ad_date,
        campaign_id,
        SUM(impressions) AS total_impressions,
        SUM(clicks) AS total_clicks,
        ROUND(SUM(spend_eur), 2) AS total_spend_eur
    FROM stg_facebook
    GROUP BY ad_date, campaign_id
)

-- Combine Shopify and Facebook data
SELECT
    fa.ad_date AS date,
    fa.campaign_id,
    fa.total_impressions,
    fa.total_clicks,
    fa.total_spend_eur,
    sa.total_revenue_eur,
    sa.new_customers_count
FROM facebook_aggregated fa
LEFT JOIN shopify_aggregated sa
    ON fa.ad_date = sa.order_date  -- Match on the corresponding date (ad_date and order_date)
ORDER BY fa.ad_date, fa.campaign_id;


[0m02:31:15.881256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:16.475962 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:ed7e5722-eb13-4b6d-979e-db23add7c37c&page=queryresults
[0m02:31:16.965929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5d5bfca-0669-46d5-848a-f2649640f1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c2e3f70>]}
[0m02:31:16.968147 [info ] [Thread-1 (]: 3 of 6 OK created sql view model order_ad_data.fact_combined_performance ....... [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m02:31:16.969457 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m02:31:16.970102 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_customer_dimension
[0m02:31:16.970869 [info ] [Thread-1 (]: 4 of 6 START sql view model order_ad_data.fact_customer_dimension .............. [RUN]
[0m02:31:16.971554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_combined_performance, now model.intermate_dbt.fact_customer_dimension)
[0m02:31:16.972098 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_customer_dimension
[0m02:31:16.977370 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_customer_dimension"
[0m02:31:16.978646 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_customer_dimension
[0m02:31:16.982364 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_customer_dimension"
[0m02:31:16.983365 [debug] [Thread-1 (]: On model.intermate_dbt.fact_customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_customer_dimension"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`fact_customer_dimension`
  OPTIONS()
  as WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`  -- Reference to the Shopify staging table
),

first_orders AS (
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
),

customer_data AS (
    SELECT
        s.customer_id,
        f.first_order_date,
        COUNT(DISTINCT s.order_id) AS total_orders,
        ROUND(SUM(s.total_price_eur), 2) AS total_spend_eur,
        COUNT(DISTINCT s.discount_code) AS distinct_discounts_used
    FROM stg_shopify s
    JOIN first_orders f
        ON s.customer_id = f.customer_id
    WHERE s.status NOT IN ('canceled')  -- Only include valid orders
    GROUP BY s.customer_id, f.first_order_date
)

SELECT
    customer_id,
    first_order_date,
    total_orders,
    total_spend_eur,
    distinct_discounts_used
FROM customer_data
ORDER BY customer_id;


[0m02:31:16.984052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:17.603047 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:0f65b33f-4b0c-493d-98da-9fdaa76ff801&page=queryresults
[0m02:31:18.041434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5d5bfca-0669-46d5-848a-f2649640f1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c2e2350>]}
[0m02:31:18.042990 [info ] [Thread-1 (]: 4 of 6 OK created sql view model order_ad_data.fact_customer_dimension ......... [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m02:31:18.044329 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_customer_dimension
[0m02:31:18.045207 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_daily_new_customer_orders
[0m02:31:18.046145 [info ] [Thread-1 (]: 5 of 6 START sql incremental model order_ad_data.fact_daily_new_customer_orders  [RUN]
[0m02:31:18.046957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_customer_dimension, now model.intermate_dbt.fact_daily_new_customer_orders)
[0m02:31:18.047563 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_daily_new_customer_orders
[0m02:31:18.056478 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_daily_new_customer_orders"
[0m02:31:18.057895 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_daily_new_customer_orders
[0m02:31:18.091981 [debug] [Thread-1 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m02:31:18.092581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:18.564307 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_daily_new_customer_orders"
[0m02:31:18.565705 [debug] [Thread-1 (]: On model.intermate_dbt.fact_daily_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_daily_new_customer_orders"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders` as DBT_INTERNAL_DEST
        using (

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
),

first_orders AS (
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
)

SELECT
    s.order_date,
    COUNT(DISTINCT s.customer_id) AS new_customers_count,
    ROUND(SUM(s.total_price_eur), 2) AS total_revenue_eur  -- Round to 2 decimal places
FROM stg_shopify s
JOIN first_orders f
    ON s.customer_id = f.customer_id
    AND s.order_date = f.first_order_date
WHERE s.status NOT IN ('canceled')  -- Ensure valid orders

    AND s.order_date > (SELECT MAX(order_date) FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders`)  -- Incremental logic

GROUP BY s.order_date
ORDER BY s.order_date
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`order_date`, `new_customers_count`, `total_revenue_eur`)
    values
        (`order_date`, `new_customers_count`, `total_revenue_eur`)


    
[0m02:31:19.337761 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:79b1bf3d-9137-4cb1-a3d8-c8e370bcc411&page=queryresults
[0m02:31:21.407117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5d5bfca-0669-46d5-848a-f2649640f1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ba8a5f0>]}
[0m02:31:21.408724 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model order_ad_data.fact_daily_new_customer_orders  [[32mMERGE (0.0 rows, 17.9 KiB processed)[0m in 3.36s]
[0m02:31:21.409870 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_daily_new_customer_orders
[0m02:31:21.410506 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_performance_discount_code
[0m02:31:21.411458 [info ] [Thread-1 (]: 6 of 6 START sql view model order_ad_data.fact_performance_discount_code ....... [RUN]
[0m02:31:21.412151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_daily_new_customer_orders, now model.intermate_dbt.fact_performance_discount_code)
[0m02:31:21.412707 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_performance_discount_code
[0m02:31:21.418278 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_performance_discount_code"
[0m02:31:21.419770 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_performance_discount_code
[0m02:31:21.423742 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_performance_discount_code"
[0m02:31:21.424868 [debug] [Thread-1 (]: On model.intermate_dbt.fact_performance_discount_code: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_performance_discount_code"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`fact_performance_discount_code`
  OPTIONS()
  as WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`  -- Reference to the Shopify staging table
),

first_orders AS (
    -- Identify the first order for each customer
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
),

discount_performance AS (
    -- Calculate performance metrics for each discount code
    SELECT
        s.order_date,
        s.discount_code,
        COUNT(DISTINCT s.customer_id) AS new_customers_using_discount,
        ROUND(SUM(s.total_price_eur), 2) AS total_revenue_from_discount
    FROM stg_shopify s
    JOIN first_orders f
        ON s.customer_id = f.customer_id
        AND s.order_date = f.first_order_date  -- Only consider the first order
    WHERE s.status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY s.order_date, s.discount_code
)

SELECT
    d.order_date,
    d.discount_code,
    d.new_customers_using_discount,
    d.total_revenue_from_discount
FROM discount_performance d
ORDER BY d.order_date, d.discount_code;


[0m02:31:21.425507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:22.244941 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:a0a78e91-d192-4301-aeb6-55454f3f120d&page=queryresults
[0m02:31:23.193984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5d5bfca-0669-46d5-848a-f2649640f1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b9dac50>]}
[0m02:31:23.195628 [info ] [Thread-1 (]: 6 of 6 OK created sql view model order_ad_data.fact_performance_discount_code .. [[32mCREATE VIEW (0 processed)[0m in 1.78s]
[0m02:31:23.197283 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_performance_discount_code
[0m02:31:23.198995 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:31:23.200033 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:31:23.200558 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_performance_discount_code' was properly closed.
[0m02:31:23.201402 [info ] [MainThread]: 
[0m02:31:23.202094 [info ] [MainThread]: Finished running 1 incremental model, 5 view models in 0 hours 0 minutes and 10.51 seconds (10.51s).
[0m02:31:23.204180 [debug] [MainThread]: Command end result
[0m02:31:23.290452 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m02:31:23.291697 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m02:31:23.295438 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m02:31:23.295642 [info ] [MainThread]: 
[0m02:31:23.295857 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:31:23.296033 [info ] [MainThread]: 
[0m02:31:23.296210 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m02:31:23.297992 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.985219, "process_in_blocks": "0", "process_kernel_time": 1.215616, "process_mem_max_rss": "213581824", "process_out_blocks": "0", "process_user_time": 2.849247}
[0m02:31:23.298240 [debug] [MainThread]: Command `dbt run` succeeded at 02:31:23.298194 after 11.99 seconds
[0m02:31:23.298449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10561c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bbd1ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106397bb0>]}
[0m02:31:23.298655 [debug] [MainThread]: Flushing usage events
[0m02:31:23.933696 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:04:00.990930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c8970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108219e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108219750>]}


============================== 05:04:01.006803 | 02f8889a-22f2-428e-8e54-7aaae1a16e11 ==============================
[0m05:04:01.006803 [info ] [MainThread]: Running with dbt=1.9.3
[0m05:04:01.007273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:04:02.339950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02f8889a-22f2-428e-8e54-7aaae1a16e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13410a680>]}
[0m05:04:02.370830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02f8889a-22f2-428e-8e54-7aaae1a16e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081eefb0>]}
[0m05:04:02.371328 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m05:04:02.489623 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m05:04:02.570699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m05:04:02.571083 [debug] [MainThread]: Partial parsing: added file: intermate_dbt://tests/test_shopify_orders.sql
[0m05:04:02.571315 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_combined_performance.sql
[0m05:04:02.727775 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.intermate_dbt.fact_combined_performance' (models/facts_tables/fact_combined_performance.sql) depends on a node named 'stg_facebook_campaign_data' which was not found
[0m05:04:02.770047 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8280194, "process_in_blocks": "0", "process_kernel_time": 0.630555, "process_mem_max_rss": "209518592", "process_out_blocks": "0", "process_user_time": 2.72258}
[0m05:04:02.770469 [debug] [MainThread]: Command `dbt run` failed at 05:04:02.770409 after 1.83 seconds
[0m05:04:02.770736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c8970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1348ce710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13489e3e0>]}
[0m05:04:02.770972 [debug] [MainThread]: Flushing usage events
[0m05:04:03.274312 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:04:35.428303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103580970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e95e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e95750>]}


============================== 05:04:35.444576 | 7f530be0-cc61-4067-8f89-6ced656ee8c6 ==============================
[0m05:04:35.444576 [info ] [MainThread]: Running with dbt=1.9.3
[0m05:04:35.444954 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:04:36.472929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f530be0-cc61-4067-8f89-6ced656ee8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15240b190>]}
[0m05:04:36.509469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f530be0-cc61-4067-8f89-6ced656ee8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e66fb0>]}
[0m05:04:36.509963 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m05:04:36.632163 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m05:04:36.723612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m05:04:36.724017 [debug] [MainThread]: Partial parsing: added file: intermate_dbt://tests/test_shopify_orders.sql
[0m05:04:36.724255 [debug] [MainThread]: Partial parsing: updated file: intermate_dbt://models/facts_tables/fact_combined_performance.sql
[0m05:04:36.909316 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.staging
- models.intermatedbt.marts
- models.intermatedbt.fact_tables
[0m05:04:36.917751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f530be0-cc61-4067-8f89-6ced656ee8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1532d8a90>]}
[0m05:04:36.973188 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m05:04:36.974791 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m05:04:36.986919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f530be0-cc61-4067-8f89-6ced656ee8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1530db100>]}
[0m05:04:36.987271 [info ] [MainThread]: Found 6 models, 1 test, 2 sources, 491 macros
[0m05:04:36.987465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f530be0-cc61-4067-8f89-6ced656ee8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1530db1c0>]}
[0m05:04:36.988431 [info ] [MainThread]: 
[0m05:04:36.988641 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:04:36.988820 [info ] [MainThread]: 
[0m05:04:36.989125 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m05:04:36.992084 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m05:04:36.992473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:04:37.566402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m05:04:37.567547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:04:37.890818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f530be0-cc61-4067-8f89-6ced656ee8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023d0a00>]}
[0m05:04:37.892256 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:04:37.894776 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m05:04:37.895150 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m05:04:37.895438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m05:04:37.895652 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m05:04:37.901065 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m05:04:37.901642 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m05:04:37.918703 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m05:04:37.919424 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m05:04:37.919704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:04:38.456171 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:a1ca93af-28cc-46c5-8ea6-9953a208fa79&page=queryresults
[0m05:04:39.047890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f530be0-cc61-4067-8f89-6ced656ee8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1523a9570>]}
[0m05:04:39.048344 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m05:04:39.048736 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m05:04:39.048998 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m05:04:39.049300 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m05:04:39.049558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m05:04:39.049763 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m05:04:39.051638 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m05:04:39.052144 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m05:04:39.053753 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m05:04:39.054351 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m05:04:39.054682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:04:39.650287 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:548e3e49-95af-49b7-8a2a-41df8595a28e&page=queryresults
[0m05:04:40.180931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f530be0-cc61-4067-8f89-6ced656ee8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1523a9570>]}
[0m05:04:40.182401 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m05:04:40.182940 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m05:04:40.183476 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m05:04:40.183792 [info ] [Thread-1 (]: 3 of 6 START sql view model order_ad_data.fact_combined_performance ............ [RUN]
[0m05:04:40.184070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_combined_performance)
[0m05:04:40.184278 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_combined_performance
[0m05:04:40.186407 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_combined_performance"
[0m05:04:40.187166 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_combined_performance
[0m05:04:40.189548 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_combined_performance"
[0m05:04:40.190016 [debug] [Thread-1 (]: On model.intermate_dbt.fact_combined_performance: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_combined_performance"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`fact_combined_performance`
  OPTIONS()
  as WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`  -- Shopify staging table
),

stg_facebook AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`  -- Facebook Ads staging table
),

-- Aggregate Shopify data: Total revenue and total orders per day
shopify_aggregated AS (
    SELECT
        order_date,
        COUNT(DISTINCT order_id) AS total_orders,
        ROUND(SUM(total_price_eur), 2) AS total_revenue_eur,
        COUNT(DISTINCT customer_id) AS new_customers_count
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY order_date
),

-- Aggregate Facebook Ads data: Impressions, clicks, and spend per campaign per day
facebook_aggregated AS (
    SELECT
        ad_date,
        campaign_id,
        SUM(impressions) AS total_impressions,
        SUM(clicks) AS total_clicks,
        ROUND(SUM(spend_eur), 2) AS total_spend_eur
    FROM stg_facebook
    GROUP BY ad_date, campaign_id
)

-- Combine Shopify and Facebook data for daily performance monitoring
SELECT
    fa.ad_date AS date,
    fa.campaign_id,
    fa.total_impressions,
    fa.total_clicks,
    fa.total_spend_eur,
    COALESCE(sa.total_orders, 0) AS total_orders,
    COALESCE(sa.total_revenue_eur, 0.00) AS total_revenue_eur,
    COALESCE(sa.new_customers_count, 0) AS new_customers_count
FROM facebook_aggregated fa
LEFT JOIN shopify_aggregated sa
    ON fa.ad_date = sa.order_date  -- Match Facebook ad date with Shopify order date
ORDER BY fa.ad_date, fa.campaign_id;


[0m05:04:40.190295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:04:40.880947 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:128b8862-999b-4cf5-bf5e-729e5686f083&page=queryresults
[0m05:04:41.341955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f530be0-cc61-4067-8f89-6ced656ee8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1539797b0>]}
[0m05:04:41.343462 [info ] [Thread-1 (]: 3 of 6 OK created sql view model order_ad_data.fact_combined_performance ....... [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m05:04:41.344176 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m05:04:41.344434 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_customer_dimension
[0m05:04:41.344749 [info ] [Thread-1 (]: 4 of 6 START sql view model order_ad_data.fact_customer_dimension .............. [RUN]
[0m05:04:41.345022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_combined_performance, now model.intermate_dbt.fact_customer_dimension)
[0m05:04:41.345215 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_customer_dimension
[0m05:04:41.401059 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_customer_dimension"
[0m05:04:41.401713 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_customer_dimension
[0m05:04:41.403324 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_customer_dimension"
[0m05:04:41.403725 [debug] [Thread-1 (]: On model.intermate_dbt.fact_customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_customer_dimension"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`fact_customer_dimension`
  OPTIONS()
  as WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`  -- Reference to the Shopify staging table
),

first_orders AS (
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
),

customer_data AS (
    SELECT
        s.customer_id,
        f.first_order_date,
        COUNT(DISTINCT s.order_id) AS total_orders,
        ROUND(SUM(s.total_price_eur), 2) AS total_spend_eur,
        COUNT(DISTINCT s.discount_code) AS distinct_discounts_used
    FROM stg_shopify s
    JOIN first_orders f
        ON s.customer_id = f.customer_id
    WHERE s.status NOT IN ('canceled')  -- Only include valid orders
    GROUP BY s.customer_id, f.first_order_date
)

SELECT
    customer_id,
    first_order_date,
    total_orders,
    total_spend_eur,
    distinct_discounts_used
FROM customer_data
ORDER BY customer_id;


[0m05:04:41.403987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:04:42.029381 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:56aa1cef-f826-49e4-9ff2-71937230444d&page=queryresults
[0m05:04:42.478526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f530be0-cc61-4067-8f89-6ced656ee8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033c3040>]}
[0m05:04:42.479818 [info ] [Thread-1 (]: 4 of 6 OK created sql view model order_ad_data.fact_customer_dimension ......... [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m05:04:42.480890 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_customer_dimension
[0m05:04:42.481694 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_daily_new_customer_orders
[0m05:04:42.482513 [info ] [Thread-1 (]: 5 of 6 START sql incremental model order_ad_data.fact_daily_new_customer_orders  [RUN]
[0m05:04:42.482946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_customer_dimension, now model.intermate_dbt.fact_daily_new_customer_orders)
[0m05:04:42.483171 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_daily_new_customer_orders
[0m05:04:42.488255 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_daily_new_customer_orders"
[0m05:04:42.488742 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_daily_new_customer_orders
[0m05:04:42.506318 [debug] [Thread-1 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m05:04:42.506723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:04:42.861852 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_daily_new_customer_orders"
[0m05:04:42.864621 [debug] [Thread-1 (]: On model.intermate_dbt.fact_daily_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_daily_new_customer_orders"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders` as DBT_INTERNAL_DEST
        using (

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
),

first_orders AS (
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
)

SELECT
    s.order_date,
    COUNT(DISTINCT s.customer_id) AS new_customers_count,
    ROUND(SUM(s.total_price_eur), 2) AS total_revenue_eur  -- Round to 2 decimal places
FROM stg_shopify s
JOIN first_orders f
    ON s.customer_id = f.customer_id
    AND s.order_date = f.first_order_date
WHERE s.status NOT IN ('canceled')  -- Ensure valid orders

    AND s.order_date > (SELECT MAX(order_date) FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders`)  -- Incremental logic

GROUP BY s.order_date
ORDER BY s.order_date
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`order_date`, `new_customers_count`, `total_revenue_eur`)
    values
        (`order_date`, `new_customers_count`, `total_revenue_eur`)


    
[0m05:04:43.651074 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:f4b93b08-3741-4c93-baaf-3709e55d26b1&page=queryresults
[0m05:04:46.055687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f530be0-cc61-4067-8f89-6ced656ee8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15399d360>]}
[0m05:04:46.057179 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model order_ad_data.fact_daily_new_customer_orders  [[32mMERGE (0.0 rows, 17.9 KiB processed)[0m in 3.57s]
[0m05:04:46.060073 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_daily_new_customer_orders
[0m05:04:46.060888 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_performance_discount_code
[0m05:04:46.061771 [info ] [Thread-1 (]: 6 of 6 START sql view model order_ad_data.fact_performance_discount_code ....... [RUN]
[0m05:04:46.062565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_daily_new_customer_orders, now model.intermate_dbt.fact_performance_discount_code)
[0m05:04:46.063293 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_performance_discount_code
[0m05:04:46.067057 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_performance_discount_code"
[0m05:04:46.068161 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_performance_discount_code
[0m05:04:46.069861 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_performance_discount_code"
[0m05:04:46.070390 [debug] [Thread-1 (]: On model.intermate_dbt.fact_performance_discount_code: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_performance_discount_code"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`fact_performance_discount_code`
  OPTIONS()
  as WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`  -- Reference to the Shopify staging table
),

first_orders AS (
    -- Identify the first order for each customer
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
),

discount_performance AS (
    -- Calculate performance metrics for each discount code
    SELECT
        s.order_date,
        s.discount_code,
        COUNT(DISTINCT s.customer_id) AS new_customers_using_discount,
        ROUND(SUM(s.total_price_eur), 2) AS total_revenue_from_discount
    FROM stg_shopify s
    JOIN first_orders f
        ON s.customer_id = f.customer_id
        AND s.order_date = f.first_order_date  -- Only consider the first order
    WHERE s.status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY s.order_date, s.discount_code
)

SELECT
    d.order_date,
    d.discount_code,
    d.new_customers_using_discount,
    d.total_revenue_from_discount
FROM discount_performance d
ORDER BY d.order_date, d.discount_code;


[0m05:04:46.070679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:04:46.526752 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:f25bcb5c-f6d7-4b48-a4cc-0a8ac591ee4a&page=queryresults
[0m05:04:46.977032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f530be0-cc61-4067-8f89-6ced656ee8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15399d360>]}
[0m05:04:46.989217 [info ] [Thread-1 (]: 6 of 6 OK created sql view model order_ad_data.fact_performance_discount_code .. [[32mCREATE VIEW (0 processed)[0m in 0.91s]
[0m05:04:46.991456 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_performance_discount_code
[0m05:04:47.001605 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:04:47.003238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:04:47.005714 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_performance_discount_code' was properly closed.
[0m05:04:47.008786 [info ] [MainThread]: 
[0m05:04:47.009221 [info ] [MainThread]: Finished running 1 incremental model, 5 view models in 0 hours 0 minutes and 10.02 seconds (10.02s).
[0m05:04:47.010183 [debug] [MainThread]: Command end result
[0m05:04:47.063750 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m05:04:47.066089 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m05:04:47.070438 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m05:04:47.070686 [info ] [MainThread]: 
[0m05:04:47.070935 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:04:47.071120 [info ] [MainThread]: 
[0m05:04:47.071312 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m05:04:47.073342 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.68867, "process_in_blocks": "0", "process_kernel_time": 0.852765, "process_mem_max_rss": "214269952", "process_out_blocks": "0", "process_user_time": 3.179909}
[0m05:04:47.073643 [debug] [MainThread]: Command `dbt run` succeeded at 05:04:47.073588 after 11.69 seconds
[0m05:04:47.073901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103580970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037143a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1535369e0>]}
[0m05:04:47.074185 [debug] [MainThread]: Flushing usage events
[0m05:04:47.593186 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:12:05.461303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ddc880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105691f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105691840>]}


============================== 14:12:05.473429 | e617431c-ed4c-4b75-97e6-d3657dbff432 ==============================
[0m14:12:05.473429 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:12:05.473808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:12:06.204964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e617431c-ed4c-4b75-97e6-d3657dbff432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ef46b60>]}
[0m14:12:06.232990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e617431c-ed4c-4b75-97e6-d3657dbff432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10515d120>]}
[0m14:12:06.233375 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m14:12:06.373402 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:12:06.457679 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:12:06.457936 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:12:06.461281 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.fact_tables
- models.intermatedbt.staging
- models.intermatedbt.marts
[0m14:12:06.483867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e617431c-ed4c-4b75-97e6-d3657dbff432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fc80130>]}
[0m14:12:06.536193 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m14:12:06.537569 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m14:12:06.549464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e617431c-ed4c-4b75-97e6-d3657dbff432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fc83d90>]}
[0m14:12:06.549781 [info ] [MainThread]: Found 6 models, 1 test, 2 sources, 491 macros
[0m14:12:06.549960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e617431c-ed4c-4b75-97e6-d3657dbff432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fc83e20>]}
[0m14:12:06.550894 [info ] [MainThread]: 
[0m14:12:06.551110 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:12:06.551262 [info ] [MainThread]: 
[0m14:12:06.551545 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:12:06.553991 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m14:12:06.554231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:07.097094 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m14:12:07.098462 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:12:07.508105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e617431c-ed4c-4b75-97e6-d3657dbff432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105668640>]}
[0m14:12:07.509843 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:12:07.515493 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m14:12:07.516387 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m14:12:07.517099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m14:12:07.517682 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m14:12:07.533637 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m14:12:07.534804 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m14:12:07.562977 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m14:12:07.563924 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m14:12:07.564284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:08.117867 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:bdc5e670-e38c-42bb-a44b-242dc899bbbb&page=queryresults
[0m14:12:08.709959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e617431c-ed4c-4b75-97e6-d3657dbff432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fbddfc0>]}
[0m14:12:08.710465 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.19s]
[0m14:12:08.710854 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m14:12:08.711114 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m14:12:08.711440 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m14:12:08.711717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m14:12:08.711936 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m14:12:08.714023 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m14:12:08.714544 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m14:12:08.716285 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m14:12:08.716965 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m14:12:08.717250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:09.245418 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:b8395af2-8bd6-48ff-92fa-834b1f15f3fd&page=queryresults
[0m14:12:09.761929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e617431c-ed4c-4b75-97e6-d3657dbff432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b8c0d0>]}
[0m14:12:09.763578 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m14:12:09.764759 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m14:12:09.766010 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m14:12:09.766935 [info ] [Thread-1 (]: 3 of 6 START sql view model order_ad_data.fact_combined_performance ............ [RUN]
[0m14:12:09.767704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_combined_performance)
[0m14:12:09.768294 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_combined_performance
[0m14:12:09.774169 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_combined_performance"
[0m14:12:09.776321 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_combined_performance
[0m14:12:09.781533 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_combined_performance"
[0m14:12:09.782593 [debug] [Thread-1 (]: On model.intermate_dbt.fact_combined_performance: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_combined_performance"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`fact_combined_performance`
  OPTIONS()
  as WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`  -- Shopify staging table
),

stg_facebook AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`  -- Facebook Ads staging table
),

-- Aggregate Shopify data: Total revenue and total orders per day
shopify_aggregated AS (
    SELECT
        order_date,
        COUNT(DISTINCT order_id) AS total_orders,
        ROUND(SUM(total_price_eur), 2) AS total_revenue_eur,
        COUNT(DISTINCT customer_id) AS new_customers_count
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY order_date
),

-- Aggregate Facebook Ads data: Impressions, clicks, and spend per campaign per day
facebook_aggregated AS (
    SELECT
        ad_date,
        campaign_id,
        SUM(impressions) AS total_impressions,
        SUM(clicks) AS total_clicks,
        ROUND(SUM(spend_eur), 2) AS total_spend_eur
    FROM stg_facebook
    GROUP BY ad_date, campaign_id
)

-- Combine Shopify and Facebook data for daily performance monitoring
SELECT
    fa.ad_date AS date,
    fa.campaign_id,
    fa.total_impressions,
    fa.total_clicks,
    fa.total_spend_eur,
    COALESCE(sa.total_orders, 0) AS total_orders,
    COALESCE(sa.total_revenue_eur, 0.00) AS total_revenue_eur,
    COALESCE(sa.new_customers_count, 0) AS new_customers_count
FROM facebook_aggregated fa
LEFT JOIN shopify_aggregated sa
    ON fa.ad_date = sa.order_date  -- Match Facebook ad date with Shopify order date
ORDER BY fa.ad_date, fa.campaign_id;


[0m14:12:09.783233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:10.391159 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:b1ee8a0e-ba9b-444b-af68-a2266b38e914&page=queryresults
[0m14:12:11.191605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e617431c-ed4c-4b75-97e6-d3657dbff432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144319960>]}
[0m14:12:11.193473 [info ] [Thread-1 (]: 3 of 6 OK created sql view model order_ad_data.fact_combined_performance ....... [[32mCREATE VIEW (0 processed)[0m in 1.42s]
[0m14:12:11.194644 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m14:12:11.195302 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_customer_dimension
[0m14:12:11.196212 [info ] [Thread-1 (]: 4 of 6 START sql view model order_ad_data.fact_customer_dimension .............. [RUN]
[0m14:12:11.197073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_combined_performance, now model.intermate_dbt.fact_customer_dimension)
[0m14:12:11.197676 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_customer_dimension
[0m14:12:11.203101 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_customer_dimension"
[0m14:12:11.205268 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_customer_dimension
[0m14:12:11.209069 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_customer_dimension"
[0m14:12:11.210038 [debug] [Thread-1 (]: On model.intermate_dbt.fact_customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_customer_dimension"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`fact_customer_dimension`
  OPTIONS()
  as WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`  -- Reference to the Shopify staging table
),

first_orders AS (
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
),

customer_data AS (
    SELECT
        s.customer_id,
        f.first_order_date,
        COUNT(DISTINCT s.order_id) AS total_orders,
        ROUND(SUM(s.total_price_eur), 2) AS total_spend_eur,
        COUNT(DISTINCT s.discount_code) AS distinct_discounts_used
    FROM stg_shopify s
    JOIN first_orders f
        ON s.customer_id = f.customer_id
    WHERE s.status NOT IN ('canceled')  -- Only include valid orders
    GROUP BY s.customer_id, f.first_order_date
)

SELECT
    customer_id,
    first_order_date,
    total_orders,
    total_spend_eur,
    distinct_discounts_used
FROM customer_data
ORDER BY customer_id;


[0m14:12:11.210644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:11.805156 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:ea2c824f-b888-4f29-956d-5db9b2e40845&page=queryresults
[0m14:12:12.489717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e617431c-ed4c-4b75-97e6-d3657dbff432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144319870>]}
[0m14:12:12.491838 [info ] [Thread-1 (]: 4 of 6 OK created sql view model order_ad_data.fact_customer_dimension ......... [[32mCREATE VIEW (0 processed)[0m in 1.29s]
[0m14:12:12.493154 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_customer_dimension
[0m14:12:12.493826 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_daily_new_customer_orders
[0m14:12:12.494677 [info ] [Thread-1 (]: 5 of 6 START sql incremental model order_ad_data.fact_daily_new_customer_orders  [RUN]
[0m14:12:12.495584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_customer_dimension, now model.intermate_dbt.fact_daily_new_customer_orders)
[0m14:12:12.496202 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_daily_new_customer_orders
[0m14:12:12.509115 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_daily_new_customer_orders"
[0m14:12:12.511413 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_daily_new_customer_orders
[0m14:12:12.542331 [debug] [Thread-1 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m14:12:12.543067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:13.068664 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_daily_new_customer_orders"
[0m14:12:13.069994 [debug] [Thread-1 (]: On model.intermate_dbt.fact_daily_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_daily_new_customer_orders"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders` as DBT_INTERNAL_DEST
        using (

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
),

first_orders AS (
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
)

SELECT
    s.order_date,
    COUNT(DISTINCT s.customer_id) AS new_customers_count,
    ROUND(SUM(s.total_price_eur), 2) AS total_revenue_eur  -- Round to 2 decimal places
FROM stg_shopify s
JOIN first_orders f
    ON s.customer_id = f.customer_id
    AND s.order_date = f.first_order_date
WHERE s.status NOT IN ('canceled')  -- Ensure valid orders

    AND s.order_date > (SELECT MAX(order_date) FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders`)  -- Incremental logic

GROUP BY s.order_date
ORDER BY s.order_date
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`order_date`, `new_customers_count`, `total_revenue_eur`)
    values
        (`order_date`, `new_customers_count`, `total_revenue_eur`)


    
[0m14:12:13.727531 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:1f1e511f-9cb1-4ffc-8ec1-d68832725368&page=queryresults
[0m14:12:16.110646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e617431c-ed4c-4b75-97e6-d3657dbff432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fc69960>]}
[0m14:12:16.112658 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model order_ad_data.fact_daily_new_customer_orders  [[32mMERGE (0.0 rows, 28.4 KiB processed)[0m in 3.61s]
[0m14:12:16.113778 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_daily_new_customer_orders
[0m14:12:16.114404 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_performance_discount_code
[0m14:12:16.115273 [info ] [Thread-1 (]: 6 of 6 START sql view model order_ad_data.fact_performance_discount_code ....... [RUN]
[0m14:12:16.116105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_daily_new_customer_orders, now model.intermate_dbt.fact_performance_discount_code)
[0m14:12:16.116716 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_performance_discount_code
[0m14:12:16.122246 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_performance_discount_code"
[0m14:12:16.124556 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_performance_discount_code
[0m14:12:16.128263 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_performance_discount_code"
[0m14:12:16.129731 [debug] [Thread-1 (]: On model.intermate_dbt.fact_performance_discount_code: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_performance_discount_code"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`fact_performance_discount_code`
  OPTIONS()
  as WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`  -- Reference to the Shopify staging table
),

first_orders AS (
    -- Identify the first order for each customer
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
),

discount_performance AS (
    -- Calculate performance metrics for each discount code
    SELECT
        s.order_date,
        s.discount_code,
        COUNT(DISTINCT s.customer_id) AS new_customers_using_discount,
        ROUND(SUM(s.total_price_eur), 2) AS total_revenue_from_discount
    FROM stg_shopify s
    JOIN first_orders f
        ON s.customer_id = f.customer_id
        AND s.order_date = f.first_order_date  -- Only consider the first order
    WHERE s.status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY s.order_date, s.discount_code
)

SELECT
    d.order_date,
    d.discount_code,
    d.new_customers_using_discount,
    d.total_revenue_from_discount
FROM discount_performance d
ORDER BY d.order_date, d.discount_code;


[0m14:12:16.130450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:16.646566 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:e3769443-b936-4be5-a658-9baeafcd3fd6&page=queryresults
[0m14:12:17.340018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e617431c-ed4c-4b75-97e6-d3657dbff432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fc69960>]}
[0m14:12:17.341734 [info ] [Thread-1 (]: 6 of 6 OK created sql view model order_ad_data.fact_performance_discount_code .. [[32mCREATE VIEW (0 processed)[0m in 1.22s]
[0m14:12:17.342654 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_performance_discount_code
[0m14:12:17.344188 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:12:17.345108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:17.345563 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_performance_discount_code' was properly closed.
[0m14:12:17.346183 [info ] [MainThread]: 
[0m14:12:17.346675 [info ] [MainThread]: Finished running 1 incremental model, 5 view models in 0 hours 0 minutes and 10.79 seconds (10.79s).
[0m14:12:17.348637 [debug] [MainThread]: Command end result
[0m14:12:17.380021 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m14:12:17.381869 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m14:12:17.387988 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m14:12:17.388342 [info ] [MainThread]: 
[0m14:12:17.388700 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:12:17.388961 [info ] [MainThread]: 
[0m14:12:17.389234 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m14:12:17.391165 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.979496, "process_in_blocks": "0", "process_kernel_time": 1.304462, "process_mem_max_rss": "216449024", "process_out_blocks": "0", "process_user_time": 2.62592}
[0m14:12:17.391546 [debug] [MainThread]: Command `dbt run` succeeded at 14:12:17.391478 after 11.98 seconds
[0m14:12:17.391861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ddc880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10515d120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051217e0>]}
[0m14:12:17.392176 [debug] [MainThread]: Flushing usage events
[0m14:12:17.985457 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:17:38.201684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10610d240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f71510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f70e50>]}


============================== 16:17:38.214480 | eae7f35d-8d5b-4ff5-81d1-0c8931def097 ==============================
[0m16:17:38.214480 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:17:38.214860 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:17:38.855878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eae7f35d-8d5b-4ff5-81d1-0c8931def097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a973dc0>]}
[0m16:17:38.885382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eae7f35d-8d5b-4ff5-81d1-0c8931def097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b35e0>]}
[0m16:17:38.885830 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m16:17:38.996026 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:17:39.082579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:17:39.082853 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:17:39.086344 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.fact_tables
- models.intermatedbt.marts
- models.intermatedbt.staging
[0m16:17:39.109466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eae7f35d-8d5b-4ff5-81d1-0c8931def097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b088130>]}
[0m16:17:39.160869 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m16:17:39.162098 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m16:17:39.173215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eae7f35d-8d5b-4ff5-81d1-0c8931def097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b0939a0>]}
[0m16:17:39.173547 [info ] [MainThread]: Found 6 models, 1 test, 2 sources, 491 macros
[0m16:17:39.173738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eae7f35d-8d5b-4ff5-81d1-0c8931def097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12aff32e0>]}
[0m16:17:39.174611 [info ] [MainThread]: 
[0m16:17:39.174814 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:17:39.174971 [info ] [MainThread]: 
[0m16:17:39.175254 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:17:39.177682 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m16:17:39.177930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:39.633093 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m16:17:39.634187 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:17:39.979813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eae7f35d-8d5b-4ff5-81d1-0c8931def097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f3d900>]}
[0m16:17:39.981445 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:17:39.986896 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m16:17:39.988005 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m16:17:39.988778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m16:17:39.989369 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m16:17:40.004952 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m16:17:40.006483 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m16:17:40.035326 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m16:17:40.036291 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m16:17:40.036664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:17:40.691541 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:7f4f4269-7e12-4a45-ac30-bb88b9d449f1&page=queryresults
[0m16:17:41.234980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eae7f35d-8d5b-4ff5-81d1-0c8931def097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a8e5b10>]}
[0m16:17:41.235861 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.25s]
[0m16:17:41.236339 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m16:17:41.236659 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m16:17:41.237089 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m16:17:41.237452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m16:17:41.237731 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m16:17:41.240006 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m16:17:41.240545 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m16:17:41.242505 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m16:17:41.243094 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m16:17:41.243389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:17:41.775670 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:ca6b2066-795a-4ac0-aa23-f6bf4f1d89c3&page=queryresults
[0m16:17:42.373864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eae7f35d-8d5b-4ff5-81d1-0c8931def097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b0d5240>]}
[0m16:17:42.375491 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.14s]
[0m16:17:42.376684 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m16:17:42.378046 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m16:17:42.378940 [info ] [Thread-1 (]: 3 of 6 START sql view model order_ad_data.fact_combined_performance ............ [RUN]
[0m16:17:42.379781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_combined_performance)
[0m16:17:42.380425 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_combined_performance
[0m16:17:42.386192 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_combined_performance"
[0m16:17:42.387634 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_combined_performance
[0m16:17:42.392598 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_combined_performance"
[0m16:17:42.393687 [debug] [Thread-1 (]: On model.intermate_dbt.fact_combined_performance: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_combined_performance"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`fact_combined_performance`
  OPTIONS()
  as WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`  -- Shopify staging table
),

stg_facebook AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`  -- Facebook Ads staging table
),

-- Aggregate Shopify data: Total revenue and total orders per day
shopify_aggregated AS (
    SELECT
        order_date,
        COUNT(DISTINCT order_id) AS total_orders,
        ROUND(SUM(total_price_eur), 2) AS total_revenue_eur,
        COUNT(DISTINCT customer_id) AS new_customers_count
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY order_date
),

-- Aggregate Facebook Ads data: Impressions, clicks, and spend per campaign per day
facebook_aggregated AS (
    SELECT
        ad_date,
        campaign_id,
        SUM(impressions) AS total_impressions,
        SUM(clicks) AS total_clicks,
        ROUND(SUM(spend_eur), 2) AS total_spend_eur
    FROM stg_facebook
    GROUP BY ad_date, campaign_id
)

-- Combine Shopify and Facebook data for daily performance monitoring
SELECT
    fa.ad_date AS date,
    fa.campaign_id,
    fa.total_impressions,
    fa.total_clicks,
    fa.total_spend_eur,
    COALESCE(sa.total_orders, 0) AS total_orders,
    COALESCE(sa.total_revenue_eur, 0.00) AS total_revenue_eur,
    COALESCE(sa.new_customers_count, 0) AS new_customers_count
FROM facebook_aggregated fa
LEFT JOIN shopify_aggregated sa
    ON fa.ad_date = sa.order_date  -- Match Facebook ad date with Shopify order date
ORDER BY fa.ad_date, fa.campaign_id;


[0m16:17:42.394346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:17:43.136240 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:4bcdec96-868c-45a7-8c40-be16ed449b9c&page=queryresults
[0m16:17:43.629586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eae7f35d-8d5b-4ff5-81d1-0c8931def097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b63e9e0>]}
[0m16:17:43.631021 [info ] [Thread-1 (]: 3 of 6 OK created sql view model order_ad_data.fact_combined_performance ....... [[32mCREATE VIEW (0 processed)[0m in 1.25s]
[0m16:17:43.632221 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m16:17:43.632954 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_customer_dimension
[0m16:17:43.633835 [info ] [Thread-1 (]: 4 of 6 START sql view model order_ad_data.fact_customer_dimension .............. [RUN]
[0m16:17:43.634630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_combined_performance, now model.intermate_dbt.fact_customer_dimension)
[0m16:17:43.635278 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_customer_dimension
[0m16:17:43.640628 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_customer_dimension"
[0m16:17:43.642202 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_customer_dimension
[0m16:17:43.645936 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_customer_dimension"
[0m16:17:43.646903 [debug] [Thread-1 (]: On model.intermate_dbt.fact_customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_customer_dimension"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`fact_customer_dimension`
  OPTIONS()
  as WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`  -- Reference to the Shopify staging table
),

first_orders AS (
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
),

customer_data AS (
    SELECT
        s.customer_id,
        f.first_order_date,
        COUNT(DISTINCT s.order_id) AS total_orders,
        ROUND(SUM(s.total_price_eur), 2) AS total_spend_eur,
        COUNT(DISTINCT s.discount_code) AS distinct_discounts_used
    FROM stg_shopify s
    JOIN first_orders f
        ON s.customer_id = f.customer_id
    WHERE s.status NOT IN ('canceled')  -- Only include valid orders
    GROUP BY s.customer_id, f.first_order_date
)

SELECT
    customer_id,
    first_order_date,
    total_orders,
    total_spend_eur,
    distinct_discounts_used
FROM customer_data
ORDER BY customer_id;


[0m16:17:43.647494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:17:44.246990 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:98d64cec-d09e-453b-a653-1f98ad60f5c7&page=queryresults
[0m16:17:44.705829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eae7f35d-8d5b-4ff5-81d1-0c8931def097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a8e5b10>]}
[0m16:17:44.707032 [info ] [Thread-1 (]: 4 of 6 OK created sql view model order_ad_data.fact_customer_dimension ......... [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m16:17:44.709660 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_customer_dimension
[0m16:17:44.711412 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_daily_new_customer_orders
[0m16:17:44.713494 [info ] [Thread-1 (]: 5 of 6 START sql incremental model order_ad_data.fact_daily_new_customer_orders  [RUN]
[0m16:17:44.714609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_customer_dimension, now model.intermate_dbt.fact_daily_new_customer_orders)
[0m16:17:44.715605 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_daily_new_customer_orders
[0m16:17:44.731431 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_daily_new_customer_orders"
[0m16:17:44.733102 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_daily_new_customer_orders
[0m16:17:44.765079 [debug] [Thread-1 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m16:17:44.765619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:17:45.210448 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_daily_new_customer_orders"
[0m16:17:45.211648 [debug] [Thread-1 (]: On model.intermate_dbt.fact_daily_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_daily_new_customer_orders"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders` as DBT_INTERNAL_DEST
        using (

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
),

first_orders AS (
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
)

SELECT
    s.order_date,
    COUNT(DISTINCT s.customer_id) AS new_customers_count,
    ROUND(SUM(s.total_price_eur), 2) AS total_revenue_eur  -- Round to 2 decimal places
FROM stg_shopify s
JOIN first_orders f
    ON s.customer_id = f.customer_id
    AND s.order_date = f.first_order_date
WHERE s.status NOT IN ('canceled')  -- Ensure valid orders

    AND s.order_date > (SELECT MAX(order_date) FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders`)  -- Incremental logic

GROUP BY s.order_date
ORDER BY s.order_date
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`order_date`, `new_customers_count`, `total_revenue_eur`)
    values
        (`order_date`, `new_customers_count`, `total_revenue_eur`)


    
[0m16:17:46.052792 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:d22345e6-4370-4a98-82c6-3ff7b810e528&page=queryresults
[0m16:17:49.308775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eae7f35d-8d5b-4ff5-81d1-0c8931def097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a8e5b10>]}
[0m16:17:49.309949 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model order_ad_data.fact_daily_new_customer_orders  [[32mMERGE (0.0 rows, 31.9 KiB processed)[0m in 4.59s]
[0m16:17:49.310740 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_daily_new_customer_orders
[0m16:17:49.311289 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_performance_discount_code
[0m16:17:49.312071 [info ] [Thread-1 (]: 6 of 6 START sql view model order_ad_data.fact_performance_discount_code ....... [RUN]
[0m16:17:49.312792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_daily_new_customer_orders, now model.intermate_dbt.fact_performance_discount_code)
[0m16:17:49.313336 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_performance_discount_code
[0m16:17:49.317676 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_performance_discount_code"
[0m16:17:49.318867 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_performance_discount_code
[0m16:17:49.322344 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_performance_discount_code"
[0m16:17:49.323397 [debug] [Thread-1 (]: On model.intermate_dbt.fact_performance_discount_code: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_performance_discount_code"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`fact_performance_discount_code`
  OPTIONS()
  as WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`  -- Reference to the Shopify staging table
),

first_orders AS (
    -- Identify the first order for each customer
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
),

discount_performance AS (
    -- Calculate performance metrics for each discount code
    SELECT
        s.order_date,
        s.discount_code,
        COUNT(DISTINCT s.customer_id) AS new_customers_using_discount,
        ROUND(SUM(s.total_price_eur), 2) AS total_revenue_from_discount
    FROM stg_shopify s
    JOIN first_orders f
        ON s.customer_id = f.customer_id
        AND s.order_date = f.first_order_date  -- Only consider the first order
    WHERE s.status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY s.order_date, s.discount_code
)

SELECT
    d.order_date,
    d.discount_code,
    d.new_customers_using_discount,
    d.total_revenue_from_discount
FROM discount_performance d
ORDER BY d.order_date, d.discount_code;


[0m16:17:49.323980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:17:49.879872 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:e1cbc33f-b936-4a41-a4e9-48e94477c1c2&page=queryresults
[0m16:17:50.515042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eae7f35d-8d5b-4ff5-81d1-0c8931def097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b08fe80>]}
[0m16:17:50.516509 [info ] [Thread-1 (]: 6 of 6 OK created sql view model order_ad_data.fact_performance_discount_code .. [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m16:17:50.517468 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_performance_discount_code
[0m16:17:50.518833 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:17:50.519644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:17:50.520096 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_performance_discount_code' was properly closed.
[0m16:17:50.520639 [info ] [MainThread]: 
[0m16:17:50.521100 [info ] [MainThread]: Finished running 1 incremental model, 5 view models in 0 hours 0 minutes and 11.35 seconds (11.35s).
[0m16:17:50.523066 [debug] [MainThread]: Command end result
[0m16:17:50.554921 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m16:17:50.557139 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m16:17:50.563272 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m16:17:50.563644 [info ] [MainThread]: 
[0m16:17:50.564067 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:17:50.564391 [info ] [MainThread]: 
[0m16:17:50.564699 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:17:50.566879 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.410817, "process_in_blocks": "0", "process_kernel_time": 1.752568, "process_mem_max_rss": "216612864", "process_out_blocks": "0", "process_user_time": 2.177585}
[0m16:17:50.567324 [debug] [MainThread]: Command `dbt run` succeeded at 16:17:50.567247 after 12.41 seconds
[0m16:17:50.567682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10610d240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bad210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a20af0>]}
[0m16:17:50.568040 [debug] [MainThread]: Flushing usage events
[0m16:17:51.136684 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:18:30.349706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075fd240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108461510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108460e50>]}


============================== 16:18:30.372055 | 02fee209-b450-4049-97c3-2e48188fb5fd ==============================
[0m16:18:30.372055 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:18:30.372453 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:18:31.004548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02fee209-b450-4049-97c3-2e48188fb5fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12aac9600>]}
[0m16:18:31.034388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02fee209-b450-4049-97c3-2e48188fb5fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a9a6560>]}
[0m16:18:31.034904 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m16:18:31.146224 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:18:31.230468 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:18:31.230751 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:18:31.234201 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.fact_tables
- models.intermatedbt.staging
- models.intermatedbt.marts
[0m16:18:31.257280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02fee209-b450-4049-97c3-2e48188fb5fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b988130>]}
[0m16:18:31.308638 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m16:18:31.309908 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m16:18:31.320556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02fee209-b450-4049-97c3-2e48188fb5fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b9aba00>]}
[0m16:18:31.320886 [info ] [MainThread]: Found 6 models, 1 test, 2 sources, 491 macros
[0m16:18:31.321082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02fee209-b450-4049-97c3-2e48188fb5fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b9aba90>]}
[0m16:18:31.321990 [info ] [MainThread]: 
[0m16:18:31.322200 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:18:31.322360 [info ] [MainThread]: 
[0m16:18:31.322629 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:18:31.325067 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m16:18:31.325300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:31.782162 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m16:18:31.783831 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:18:32.110841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02fee209-b450-4049-97c3-2e48188fb5fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10842d900>]}
[0m16:18:32.112300 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:18:32.116799 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m16:18:32.117702 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m16:18:32.118444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m16:18:32.119043 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m16:18:32.134247 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m16:18:32.135533 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m16:18:32.164169 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m16:18:32.164977 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m16:18:32.165329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:18:32.687496 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:d811ce80-7c90-4244-9af7-0f93219a580e&page=queryresults
[0m16:18:33.246264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02fee209-b450-4049-97c3-2e48188fb5fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b9a88e0>]}
[0m16:18:33.246758 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m16:18:33.247370 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m16:18:33.247592 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m16:18:33.247879 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m16:18:33.248124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m16:18:33.248326 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m16:18:33.250100 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m16:18:33.250525 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m16:18:33.252160 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m16:18:33.252859 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m16:18:33.253117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:18:33.861754 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:b0a0867f-0684-4853-8097-3c1cf2c498a1&page=queryresults
[0m16:18:34.295774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02fee209-b450-4049-97c3-2e48188fb5fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107099c90>]}
[0m16:18:34.296530 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m16:18:34.297089 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m16:18:34.297815 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m16:18:34.298374 [info ] [Thread-1 (]: 3 of 6 START sql view model order_ad_data.fact_combined_performance ............ [RUN]
[0m16:18:34.298866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_combined_performance)
[0m16:18:34.299269 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_combined_performance
[0m16:18:34.302798 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_combined_performance"
[0m16:18:34.303557 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_combined_performance
[0m16:18:34.307608 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_combined_performance"
[0m16:18:34.308441 [debug] [Thread-1 (]: On model.intermate_dbt.fact_combined_performance: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_combined_performance"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`fact_combined_performance`
  OPTIONS()
  as WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`  -- Shopify staging table
),

stg_facebook AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`  -- Facebook Ads staging table
),

-- Aggregate Shopify data: Total revenue and total orders per day
shopify_aggregated AS (
    SELECT
        order_date,
        COUNT(DISTINCT order_id) AS total_orders,
        ROUND(SUM(total_price_eur), 2) AS total_revenue_eur,
        COUNT(DISTINCT customer_id) AS new_customers_count
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY order_date
),

-- Aggregate Facebook Ads data: Impressions, clicks, and spend per campaign per day
facebook_aggregated AS (
    SELECT
        ad_date,
        campaign_id,
        SUM(impressions) AS total_impressions,
        SUM(clicks) AS total_clicks,
        ROUND(SUM(spend_eur), 2) AS total_spend_eur
    FROM stg_facebook
    GROUP BY ad_date, campaign_id
)

-- Combine Shopify and Facebook data for daily performance monitoring
SELECT
    fa.ad_date AS date,
    fa.campaign_id,
    fa.total_impressions,
    fa.total_clicks,
    fa.total_spend_eur,
    COALESCE(sa.total_orders, 0) AS total_orders,
    COALESCE(sa.total_revenue_eur, 0.00) AS total_revenue_eur,
    COALESCE(sa.new_customers_count, 0) AS new_customers_count
FROM facebook_aggregated fa
LEFT JOIN shopify_aggregated sa
    ON fa.ad_date = sa.order_date  -- Match Facebook ad date with Shopify order date
ORDER BY fa.ad_date, fa.campaign_id;


[0m16:18:34.308880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:18:35.116495 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:754186e6-288d-4d1e-98de-859907113151&page=queryresults
[0m16:18:35.556906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02fee209-b450-4049-97c3-2e48188fb5fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c13ea70>]}
[0m16:18:35.557509 [info ] [Thread-1 (]: 3 of 6 OK created sql view model order_ad_data.fact_combined_performance ....... [[32mCREATE VIEW (0 processed)[0m in 1.26s]
[0m16:18:35.557956 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m16:18:35.558262 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_customer_dimension
[0m16:18:35.558715 [info ] [Thread-1 (]: 4 of 6 START sql view model order_ad_data.fact_customer_dimension .............. [RUN]
[0m16:18:35.559111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_combined_performance, now model.intermate_dbt.fact_customer_dimension)
[0m16:18:35.559389 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_customer_dimension
[0m16:18:35.561704 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_customer_dimension"
[0m16:18:35.562444 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_customer_dimension
[0m16:18:35.564452 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_customer_dimension"
[0m16:18:35.565041 [debug] [Thread-1 (]: On model.intermate_dbt.fact_customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_customer_dimension"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`fact_customer_dimension`
  OPTIONS()
  as WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`  -- Reference to the Shopify staging table
),

first_orders AS (
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
),

customer_data AS (
    SELECT
        s.customer_id,
        f.first_order_date,
        COUNT(DISTINCT s.order_id) AS total_orders,
        ROUND(SUM(s.total_price_eur), 2) AS total_spend_eur,
        COUNT(DISTINCT s.discount_code) AS distinct_discounts_used
    FROM stg_shopify s
    JOIN first_orders f
        ON s.customer_id = f.customer_id
    WHERE s.status NOT IN ('canceled')  -- Only include valid orders
    GROUP BY s.customer_id, f.first_order_date
)

SELECT
    customer_id,
    first_order_date,
    total_orders,
    total_spend_eur,
    distinct_discounts_used
FROM customer_data
ORDER BY customer_id;


[0m16:18:35.565375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:18:36.270483 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:b5da4b47-83d3-4efd-833e-903537e42553&page=queryresults
[0m16:18:36.903650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02fee209-b450-4049-97c3-2e48188fb5fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107443280>]}
[0m16:18:36.905617 [info ] [Thread-1 (]: 4 of 6 OK created sql view model order_ad_data.fact_customer_dimension ......... [[32mCREATE VIEW (0 processed)[0m in 1.34s]
[0m16:18:36.907024 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_customer_dimension
[0m16:18:36.907713 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_daily_new_customer_orders
[0m16:18:36.908667 [info ] [Thread-1 (]: 5 of 6 START sql incremental model order_ad_data.fact_daily_new_customer_orders  [RUN]
[0m16:18:36.909533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_customer_dimension, now model.intermate_dbt.fact_daily_new_customer_orders)
[0m16:18:36.910198 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_daily_new_customer_orders
[0m16:18:36.923072 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_daily_new_customer_orders"
[0m16:18:36.924408 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_daily_new_customer_orders
[0m16:18:36.955321 [debug] [Thread-1 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m16:18:36.955865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:18:37.652147 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_daily_new_customer_orders"
[0m16:18:37.653581 [debug] [Thread-1 (]: On model.intermate_dbt.fact_daily_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_daily_new_customer_orders"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders` as DBT_INTERNAL_DEST
        using (

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
),

first_orders AS (
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
)

SELECT
    s.order_date,
    COUNT(DISTINCT s.customer_id) AS new_customers_count,
    ROUND(SUM(s.total_price_eur), 2) AS total_revenue_eur  -- Round to 2 decimal places
FROM stg_shopify s
JOIN first_orders f
    ON s.customer_id = f.customer_id
    AND s.order_date = f.first_order_date
WHERE s.status NOT IN ('canceled')  -- Ensure valid orders

    AND s.order_date > (SELECT MAX(order_date) FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders`)  -- Incremental logic

GROUP BY s.order_date
ORDER BY s.order_date
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`order_date`, `new_customers_count`, `total_revenue_eur`)
    values
        (`order_date`, `new_customers_count`, `total_revenue_eur`)


    
[0m16:18:38.544609 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:f3a048a1-6eee-4bfe-84ee-56cef7288e88&page=queryresults
[0m16:18:41.115738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02fee209-b450-4049-97c3-2e48188fb5fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107099c90>]}
[0m16:18:41.117568 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model order_ad_data.fact_daily_new_customer_orders  [[32mMERGE (0.0 rows, 35.4 KiB processed)[0m in 4.21s]
[0m16:18:41.118609 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_daily_new_customer_orders
[0m16:18:41.119298 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_performance_discount_code
[0m16:18:41.120274 [info ] [Thread-1 (]: 6 of 6 START sql view model order_ad_data.fact_performance_discount_code ....... [RUN]
[0m16:18:41.121097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_daily_new_customer_orders, now model.intermate_dbt.fact_performance_discount_code)
[0m16:18:41.121742 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_performance_discount_code
[0m16:18:41.127041 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_performance_discount_code"
[0m16:18:41.128540 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_performance_discount_code
[0m16:18:41.132242 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_performance_discount_code"
[0m16:18:41.133269 [debug] [Thread-1 (]: On model.intermate_dbt.fact_performance_discount_code: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_performance_discount_code"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`fact_performance_discount_code`
  OPTIONS()
  as WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`  -- Reference to the Shopify staging table
),

first_orders AS (
    -- Identify the first order for each customer
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
),

discount_performance AS (
    -- Calculate performance metrics for each discount code
    SELECT
        s.order_date,
        s.discount_code,
        COUNT(DISTINCT s.customer_id) AS new_customers_using_discount,
        ROUND(SUM(s.total_price_eur), 2) AS total_revenue_from_discount
    FROM stg_shopify s
    JOIN first_orders f
        ON s.customer_id = f.customer_id
        AND s.order_date = f.first_order_date  -- Only consider the first order
    WHERE s.status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY s.order_date, s.discount_code
)

SELECT
    d.order_date,
    d.discount_code,
    d.new_customers_using_discount,
    d.total_revenue_from_discount
FROM discount_performance d
ORDER BY d.order_date, d.discount_code;


[0m16:18:41.133898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:18:41.723505 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:3e2c31da-e455-4475-bd47-858ff3032c20&page=queryresults
[0m16:18:42.531909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02fee209-b450-4049-97c3-2e48188fb5fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107099c90>]}
[0m16:18:42.533158 [info ] [Thread-1 (]: 6 of 6 OK created sql view model order_ad_data.fact_performance_discount_code .. [[32mCREATE VIEW (0 processed)[0m in 1.41s]
[0m16:18:42.534132 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_performance_discount_code
[0m16:18:42.535662 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:18:42.536568 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:18:42.537053 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_performance_discount_code' was properly closed.
[0m16:18:42.537680 [info ] [MainThread]: 
[0m16:18:42.538210 [info ] [MainThread]: Finished running 1 incremental model, 5 view models in 0 hours 0 minutes and 11.21 seconds (11.21s).
[0m16:18:42.540183 [debug] [MainThread]: Command end result
[0m16:18:42.569730 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m16:18:42.571992 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m16:18:42.577832 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m16:18:42.578252 [info ] [MainThread]: 
[0m16:18:42.578616 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:18:42.578904 [info ] [MainThread]: 
[0m16:18:42.579202 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:18:42.581410 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.271914, "process_in_blocks": "0", "process_kernel_time": 1.668833, "process_mem_max_rss": "217268224", "process_out_blocks": "0", "process_user_time": 2.172466}
[0m16:18:42.581801 [debug] [MainThread]: Command `dbt run` succeeded at 16:18:42.581735 after 12.27 seconds
[0m16:18:42.582118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075fd240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b92cb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12aacab90>]}
[0m16:18:42.582423 [debug] [MainThread]: Flushing usage events
[0m16:18:43.104484 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:06:54.725676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105669240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064cc370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064ccca0>]}


============================== 18:06:54.740804 | 935eced9-02af-42b7-b978-db6e6ea334cb ==============================
[0m18:06:54.740804 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:06:54.741164 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/victoruwaje/.dbt', 'log_path': '/Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:06:55.578753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '935eced9-02af-42b7-b978-db6e6ea334cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f1cee60>]}
[0m18:06:55.643972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '935eced9-02af-42b7-b978-db6e6ea334cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106008280>]}
[0m18:06:55.644725 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m18:06:55.795404 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:06:55.927427 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:06:55.927741 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:06:55.931247 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.intermatedbt.fact_tables
- models.intermatedbt.staging
- models.intermatedbt.marts
[0m18:06:55.954383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '935eced9-02af-42b7-b978-db6e6ea334cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120088130>]}
[0m18:06:56.006363 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m18:06:56.007687 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m18:06:56.020023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '935eced9-02af-42b7-b978-db6e6ea334cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120066a10>]}
[0m18:06:56.020389 [info ] [MainThread]: Found 6 models, 1 test, 2 sources, 491 macros
[0m18:06:56.020590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '935eced9-02af-42b7-b978-db6e6ea334cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f7f3880>]}
[0m18:06:56.021496 [info ] [MainThread]: 
[0m18:06:56.021939 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:06:56.022102 [info ] [MainThread]: 
[0m18:06:56.022372 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:06:56.024802 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_atomic-sled-453015-g3'
[0m18:06:56.025044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:56.642207 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3, now list_atomic-sled-453015-g3_order_ad_data)
[0m18:06:56.643437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:56.987007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '935eced9-02af-42b7-b978-db6e6ea334cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106499900>]}
[0m18:06:56.988677 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:06:56.993942 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_facebook_ads
[0m18:06:56.994974 [info ] [Thread-1 (]: 1 of 6 START sql view model order_ad_data.stg_facebook_ads ..................... [RUN]
[0m18:06:56.995774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_atomic-sled-453015-g3_order_ad_data, now model.intermate_dbt.stg_facebook_ads)
[0m18:06:56.996394 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_facebook_ads
[0m18:06:57.012124 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_facebook_ads"
[0m18:06:57.013642 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_facebook_ads
[0m18:06:57.042475 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_facebook_ads"
[0m18:06:57.043455 [debug] [Thread-1 (]: On model.intermate_dbt.stg_facebook_ads: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_facebook_ads"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`
  OPTIONS()
  as 

SELECT
    campaign_id,
    CAST(date_start AS DATE) AS ad_date,
    impressions,
    clicks,
    spend_eur
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_facebook_ads`  -- ✅ Matches `sources.yml`
WHERE spend_eur IS NOT NULL;


[0m18:06:57.043808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:57.662775 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:818dd151-f5f9-420f-866c-143023a53412&page=queryresults
[0m18:06:58.350673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '935eced9-02af-42b7-b978-db6e6ea334cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f0e5b10>]}
[0m18:06:58.351244 [info ] [Thread-1 (]: 1 of 6 OK created sql view model order_ad_data.stg_facebook_ads ................ [[32mCREATE VIEW (0 processed)[0m in 1.35s]
[0m18:06:58.351687 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_facebook_ads
[0m18:06:58.351979 [debug] [Thread-1 (]: Began running node model.intermate_dbt.stg_shopify_orders
[0m18:06:58.352364 [info ] [Thread-1 (]: 2 of 6 START sql view model order_ad_data.stg_shopify_orders ................... [RUN]
[0m18:06:58.352675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_facebook_ads, now model.intermate_dbt.stg_shopify_orders)
[0m18:06:58.352925 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.stg_shopify_orders
[0m18:06:58.355115 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.stg_shopify_orders"
[0m18:06:58.355764 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.stg_shopify_orders
[0m18:06:58.357588 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.stg_shopify_orders"
[0m18:06:58.358197 [debug] [Thread-1 (]: On model.intermate_dbt.stg_shopify_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.stg_shopify_orders"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
  OPTIONS()
  as 

SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) AS order_date,
    total_price_eur,
    discount_code,
    status
FROM `atomic-sled-453015-g3`.`order_ad_data`.`clean_shopify_orders`  -- ✅ Matches `sources.yml`
WHERE total_price_eur > 0;


[0m18:06:58.358472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:58.892323 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:49717a21-0c7d-4bd7-b182-c6aef5766887&page=queryresults
[0m18:06:59.352865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '935eced9-02af-42b7-b978-db6e6ea334cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1200bb760>]}
[0m18:06:59.354539 [info ] [Thread-1 (]: 2 of 6 OK created sql view model order_ad_data.stg_shopify_orders .............. [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m18:06:59.355496 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.stg_shopify_orders
[0m18:06:59.356841 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_combined_performance
[0m18:06:59.357969 [info ] [Thread-1 (]: 3 of 6 START sql view model order_ad_data.fact_combined_performance ............ [RUN]
[0m18:06:59.358834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.stg_shopify_orders, now model.intermate_dbt.fact_combined_performance)
[0m18:06:59.359459 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_combined_performance
[0m18:06:59.365253 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_combined_performance"
[0m18:06:59.366883 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_combined_performance
[0m18:06:59.371996 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_combined_performance"
[0m18:06:59.373329 [debug] [Thread-1 (]: On model.intermate_dbt.fact_combined_performance: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_combined_performance"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`fact_combined_performance`
  OPTIONS()
  as WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`  -- Shopify staging table
),

stg_facebook AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_facebook_ads`  -- Facebook Ads staging table
),

-- Aggregate Shopify data: Total revenue and total orders per day
shopify_aggregated AS (
    SELECT
        order_date,
        COUNT(DISTINCT order_id) AS total_orders,
        ROUND(SUM(total_price_eur), 2) AS total_revenue_eur,
        COUNT(DISTINCT customer_id) AS new_customers_count
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY order_date
),

-- Aggregate Facebook Ads data: Impressions, clicks, and spend per campaign per day
facebook_aggregated AS (
    SELECT
        ad_date,
        campaign_id,
        SUM(impressions) AS total_impressions,
        SUM(clicks) AS total_clicks,
        ROUND(SUM(spend_eur), 2) AS total_spend_eur
    FROM stg_facebook
    GROUP BY ad_date, campaign_id
)

-- Combine Shopify and Facebook data for daily performance monitoring
SELECT
    fa.ad_date AS date,
    fa.campaign_id,
    fa.total_impressions,
    fa.total_clicks,
    fa.total_spend_eur,
    COALESCE(sa.total_orders, 0) AS total_orders,
    COALESCE(sa.total_revenue_eur, 0.00) AS total_revenue_eur,
    COALESCE(sa.new_customers_count, 0) AS new_customers_count
FROM facebook_aggregated fa
LEFT JOIN shopify_aggregated sa
    ON fa.ad_date = sa.order_date  -- Match Facebook ad date with Shopify order date
ORDER BY fa.ad_date, fa.campaign_id;


[0m18:06:59.374066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:59.958553 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:a3d93661-4e46-490c-98eb-2f541b16e62a&page=queryresults
[0m18:07:00.465226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '935eced9-02af-42b7-b978-db6e6ea334cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12053e9e0>]}
[0m18:07:00.467033 [info ] [Thread-1 (]: 3 of 6 OK created sql view model order_ad_data.fact_combined_performance ....... [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m18:07:00.468318 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_combined_performance
[0m18:07:00.469056 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_customer_dimension
[0m18:07:00.470007 [info ] [Thread-1 (]: 4 of 6 START sql view model order_ad_data.fact_customer_dimension .............. [RUN]
[0m18:07:00.470910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_combined_performance, now model.intermate_dbt.fact_customer_dimension)
[0m18:07:00.471570 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_customer_dimension
[0m18:07:00.477303 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_customer_dimension"
[0m18:07:00.478705 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_customer_dimension
[0m18:07:00.482646 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_customer_dimension"
[0m18:07:00.483860 [debug] [Thread-1 (]: On model.intermate_dbt.fact_customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_customer_dimension"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`fact_customer_dimension`
  OPTIONS()
  as WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`  -- Reference to the Shopify staging table
),

first_orders AS (
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
),

customer_data AS (
    SELECT
        s.customer_id,
        f.first_order_date,
        COUNT(DISTINCT s.order_id) AS total_orders,
        ROUND(SUM(s.total_price_eur), 2) AS total_spend_eur,
        COUNT(DISTINCT s.discount_code) AS distinct_discounts_used
    FROM stg_shopify s
    JOIN first_orders f
        ON s.customer_id = f.customer_id
    WHERE s.status NOT IN ('canceled')  -- Only include valid orders
    GROUP BY s.customer_id, f.first_order_date
)

SELECT
    customer_id,
    first_order_date,
    total_orders,
    total_spend_eur,
    distinct_discounts_used
FROM customer_data
ORDER BY customer_id;


[0m18:07:00.484492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:07:02.371510 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:5c88361b-fbcb-45e1-8e0b-04e94641c468&page=queryresults
[0m18:07:02.836438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '935eced9-02af-42b7-b978-db6e6ea334cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f0e5b10>]}
[0m18:07:02.837689 [info ] [Thread-1 (]: 4 of 6 OK created sql view model order_ad_data.fact_customer_dimension ......... [[32mCREATE VIEW (0 processed)[0m in 2.37s]
[0m18:07:02.838630 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_customer_dimension
[0m18:07:02.839374 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_daily_new_customer_orders
[0m18:07:02.840307 [info ] [Thread-1 (]: 5 of 6 START sql incremental model order_ad_data.fact_daily_new_customer_orders  [RUN]
[0m18:07:02.841163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_customer_dimension, now model.intermate_dbt.fact_daily_new_customer_orders)
[0m18:07:02.841957 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_daily_new_customer_orders
[0m18:07:02.854785 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_daily_new_customer_orders"
[0m18:07:02.856183 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_daily_new_customer_orders
[0m18:07:02.891553 [debug] [Thread-1 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m18:07:02.892539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:07:03.418114 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_daily_new_customer_orders"
[0m18:07:03.418931 [debug] [Thread-1 (]: On model.intermate_dbt.fact_daily_new_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_daily_new_customer_orders"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders` as DBT_INTERNAL_DEST
        using (

WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`
),

first_orders AS (
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
)

SELECT
    s.order_date,
    COUNT(DISTINCT s.customer_id) AS new_customers_count,
    ROUND(SUM(s.total_price_eur), 2) AS total_revenue_eur  -- Round to 2 decimal places
FROM stg_shopify s
JOIN first_orders f
    ON s.customer_id = f.customer_id
    AND s.order_date = f.first_order_date
WHERE s.status NOT IN ('canceled')  -- Ensure valid orders

    AND s.order_date > (SELECT MAX(order_date) FROM `atomic-sled-453015-g3`.`order_ad_data`.`fact_daily_new_customer_orders`)  -- Incremental logic

GROUP BY s.order_date
ORDER BY s.order_date
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`order_date`, `new_customers_count`, `total_revenue_eur`)
    values
        (`order_date`, `new_customers_count`, `total_revenue_eur`)


    
[0m18:07:04.056286 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:b2574844-d74d-478a-93ca-c482a01f1282&page=queryresults
[0m18:07:06.578124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '935eced9-02af-42b7-b978-db6e6ea334cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f0e5b10>]}
[0m18:07:06.580196 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model order_ad_data.fact_daily_new_customer_orders  [[32mMERGE (0.0 rows, 74.0 KiB processed)[0m in 3.74s]
[0m18:07:06.581634 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_daily_new_customer_orders
[0m18:07:06.582289 [debug] [Thread-1 (]: Began running node model.intermate_dbt.fact_performance_discount_code
[0m18:07:06.583081 [info ] [Thread-1 (]: 6 of 6 START sql view model order_ad_data.fact_performance_discount_code ....... [RUN]
[0m18:07:06.583932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.intermate_dbt.fact_daily_new_customer_orders, now model.intermate_dbt.fact_performance_discount_code)
[0m18:07:06.584493 [debug] [Thread-1 (]: Began compiling node model.intermate_dbt.fact_performance_discount_code
[0m18:07:06.589723 [debug] [Thread-1 (]: Writing injected SQL for node "model.intermate_dbt.fact_performance_discount_code"
[0m18:07:06.591177 [debug] [Thread-1 (]: Began executing node model.intermate_dbt.fact_performance_discount_code
[0m18:07:06.595003 [debug] [Thread-1 (]: Writing runtime sql for node "model.intermate_dbt.fact_performance_discount_code"
[0m18:07:06.596217 [debug] [Thread-1 (]: On model.intermate_dbt.fact_performance_discount_code: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "intermate_bigquery", "target_name": "dev", "node_id": "model.intermate_dbt.fact_performance_discount_code"} */


  create or replace view `atomic-sled-453015-g3`.`order_ad_data`.`fact_performance_discount_code`
  OPTIONS()
  as WITH stg_shopify AS (
    SELECT *
    FROM `atomic-sled-453015-g3`.`order_ad_data`.`stg_shopify_orders`  -- Reference to the Shopify staging table
),

first_orders AS (
    -- Identify the first order for each customer
    SELECT
        customer_id,
        MIN(order_date) AS first_order_date
    FROM stg_shopify
    WHERE status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY customer_id
),

discount_performance AS (
    -- Calculate performance metrics for each discount code
    SELECT
        s.order_date,
        s.discount_code,
        COUNT(DISTINCT s.customer_id) AS new_customers_using_discount,
        ROUND(SUM(s.total_price_eur), 2) AS total_revenue_from_discount
    FROM stg_shopify s
    JOIN first_orders f
        ON s.customer_id = f.customer_id
        AND s.order_date = f.first_order_date  -- Only consider the first order
    WHERE s.status NOT IN ('canceled')  -- Exclude canceled orders
    GROUP BY s.order_date, s.discount_code
)

SELECT
    d.order_date,
    d.discount_code,
    d.new_customers_using_discount,
    d.total_revenue_from_discount
FROM discount_performance d
ORDER BY d.order_date, d.discount_code;


[0m18:07:06.596863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:07:07.391495 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=atomic-sled-453015-g3&j=bq:US:dc181563-23ce-4940-8fbf-8da68e8a9123&page=queryresults
[0m18:07:07.905581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '935eced9-02af-42b7-b978-db6e6ea334cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12747c0d0>]}
[0m18:07:07.906979 [info ] [Thread-1 (]: 6 of 6 OK created sql view model order_ad_data.fact_performance_discount_code .. [[32mCREATE VIEW (0 processed)[0m in 1.32s]
[0m18:07:07.908213 [debug] [Thread-1 (]: Finished running node model.intermate_dbt.fact_performance_discount_code
[0m18:07:07.909743 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:07:07.910757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:07:07.911304 [debug] [MainThread]: Connection 'model.intermate_dbt.fact_performance_discount_code' was properly closed.
[0m18:07:07.911961 [info ] [MainThread]: 
[0m18:07:07.912503 [info ] [MainThread]: Finished running 1 incremental model, 5 view models in 0 hours 0 minutes and 11.89 seconds (11.89s).
[0m18:07:07.914547 [debug] [MainThread]: Command end result
[0m18:07:07.945153 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/manifest.json
[0m18:07:07.947519 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/semantic_manifest.json
[0m18:07:07.953898 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/victoruwaje/Desktop/Personal_projects/automated_etl_pipeline/dbt_project/target/run_results.json
[0m18:07:07.954282 [info ] [MainThread]: 
[0m18:07:07.954644 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:07:07.954937 [info ] [MainThread]: 
[0m18:07:07.955230 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:07:07.958257 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.2813425, "process_in_blocks": "0", "process_kernel_time": 1.833718, "process_mem_max_rss": "204734464", "process_out_blocks": "0", "process_user_time": 2.289218}
[0m18:07:07.958610 [debug] [MainThread]: Command `dbt run` succeeded at 18:07:07.958549 after 13.28 seconds
[0m18:07:07.958936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105669240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105161210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054af280>]}
[0m18:07:07.959237 [debug] [MainThread]: Flushing usage events
[0m18:07:08.552176 [debug] [MainThread]: An error was encountered while trying to flush usage events
